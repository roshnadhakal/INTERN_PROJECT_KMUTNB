2025-07-18 09:54:30,024 - __main__ - INFO - Loading datasets from configured files...
2025-07-18 09:54:30,030 - __main__ - INFO - Loaded xss with shape (167, 33)
2025-07-18 09:54:30,445 - __main__ - INFO - Loaded sql_injection with shape (11740, 41)
2025-07-18 09:54:31,390 - __main__ - INFO - Loaded path_traversal with shape (42340, 38)
2025-07-18 09:54:31,390 - __main__ - INFO - Starting cleaning for xss
2025-07-18 09:54:31,391 - __main__ - INFO - Null counts before cleaning in xss:
post_data     113
event_type     57
dtype: int64
2025-07-18 09:54:31,392 - __main__ - INFO - Removed 167 rows with null values in xss
2025-07-18 09:54:31,392 - __main__ - INFO - Found 0 duplicates in xss
2025-07-18 09:54:31,392 - __main__ - INFO - Removed 0 duplicates from xss
2025-07-18 09:54:31,392 - __main__ - INFO - Normalizing payloads in xss...
2025-07-18 09:54:31,393 - __main__ - INFO - Payload normalization completed for xss
2025-07-18 09:54:31,394 - __main__ - INFO - Class distribution before balancing in xss:
Series([], Name: count, dtype: int64)
2025-07-18 09:54:31,394 - __main__ - WARNING - Only one class found in xss, skipping balancing
2025-07-18 09:54:31,394 - __main__ - INFO - Saved cleaning stats for xss to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaning_stats.json
2025-07-18 09:54:31,396 - __main__ - INFO - Saved cleaned sample for xss to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csv
2025-07-18 09:54:31,397 - __main__ - INFO - Completed cleaning for xss. Final shape: (0, 33)
2025-07-18 09:54:31,397 - __main__ - INFO - Starting cleaning for sql_injection
2025-07-18 09:54:31,398 - __main__ - INFO - Null counts before cleaning in sql_injection:
payload    9490
alert      9490
dtype: int64
2025-07-18 09:54:31,400 - __main__ - INFO - Removed 9490 rows with null values in sql_injection
2025-07-18 09:54:31,405 - __main__ - INFO - Found 0 duplicates in sql_injection
2025-07-18 09:54:31,405 - __main__ - INFO - Removed 0 duplicates from sql_injection
2025-07-18 09:54:31,406 - __main__ - INFO - Normalizing payloads in sql_injection...
2025-07-18 09:54:31,459 - __main__ - INFO - Payload normalization completed for sql_injection
2025-07-18 09:54:31,460 - __main__ - INFO - Class distribution before balancing in sql_injection:
alert
{'action': 'allowed', 'gid': 1, 'signature_id': 2053468, 'rev': 1, 'signature': 'ET WEB_SERVER Possible SQL Injection UNION SELECT in HTTP Request Body', 'category': 'Attempted Administrator Privilege Gain', 'metadata': {'performance_impact': ['Moderate'], 'tag': ['SQL_Injection'], 'updated_at': ['2024_06_11'], 'mitre_tactic_id': ['TA0001'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'deployment': ['SSLDecrypt', 'Perimeter'], 'mitre_technique_id': ['T1190'], 'attack_target': ['Web_Server'], 'affected_product': ['Web_Server_Applications'], 'signature_severity': ['Major'], 'created_at': ['2024_06_11'], 'confidence': ['Medium'], 'mitre_tactic_name': ['Initial_Access']}, 'severity': 1}    2245
{'action': 'allowed', 'gid': 1, 'signature_id': 2210061, 'rev': 1, 'signature': 'SURICATA STREAM spurious retransmission', 'category': 'Generic Protocol Command Decode', 'severity': 3}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     5
Name: count, dtype: int64
2025-07-18 09:54:31,460 - __main__ - INFO - Imbalance ratio in sql_injection: 449.0:1
2025-07-18 09:54:31,460 - __main__ - INFO - Applying SMOTE to sql_injection...
2025-07-18 09:54:31,460 - __main__ - ERROR - SMOTE failed for sql_injection: name 'payload_col' is not defined
2025-07-18 09:54:31,460 - __main__ - INFO - Falling back to random oversampling...
2025-07-18 09:54:31,465 - __main__ - INFO - Random oversampling completed. New shape: (4490, 41)
2025-07-18 09:54:31,466 - __main__ - INFO - Saved cleaning stats for sql_injection to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase1/cleaning/sql_injection_cleaning_stats.json
2025-07-18 09:54:31,472 - __main__ - INFO - Saved cleaned sample for sql_injection to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase1/cleaning/sql_injection_cleaned_sample.csv
2025-07-18 09:54:31,472 - __main__ - INFO - Completed cleaning for sql_injection. Final shape: (4490, 41)
2025-07-18 09:54:31,472 - __main__ - INFO - Starting cleaning for path_traversal
2025-07-18 09:54:31,475 - __main__ - INFO - Null counts before cleaning in path_traversal:
payload    37238
alert      37132
dtype: int64
2025-07-18 09:54:31,479 - __main__ - INFO - Removed 37238 rows with null values in path_traversal
2025-07-18 09:54:31,482 - __main__ - INFO - Found 541 duplicates in path_traversal
2025-07-18 09:54:31,484 - __main__ - INFO - Removed 541 duplicates from path_traversal
2025-07-18 09:54:31,484 - __main__ - INFO - Normalizing payloads in path_traversal...
2025-07-18 09:54:31,512 - __main__ - INFO - Payload normalization completed for path_traversal
2025-07-18 09:54:31,513 - __main__ - INFO - Class distribution before balancing in path_traversal:
alert
{'metadata': {'updated_at': ['2019_08_22'], 'created_at': ['2010_07_30']}, 'action': 'allowed', 'cve_id': 'CVE-2006-3602 CVE-2006-4458 CVE-2006-4542', 'signature_id': 2003099, 'rev': 8, 'category': 'access to a potentially vulnerable web application', 'signature': 'ET WEB_SERVER Poison Null Byte', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                     3665
{'metadata': {'reviewed_at': ['2024_03_20'], 'attack_target': ['Web_Server'], 'updated_at': ['2022_12_01'], 'created_at': ['2014_09_04'], 'signature_severity': ['Major']}, 'action': 'allowed', 'signature_id': 2019110, 'rev': 5, 'category': 'Web Application Attack', 'signature': 'ET WEB_SERVER Likely Malicious Request for /proc/self/fd/', 'severity': 1, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                             544
{'metadata': {'updated_at': ['2020_08_20'], 'created_at': ['2010_07_30']}, 'action': 'allowed', 'signature_id': 2009362, 'rev': 7, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER /system32/ in Uri - Possible Protected Directory Access Attempt', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                      137
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_29'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049400, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER /etc/passwd Detected in URI', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                50
{'metadata': {'attack_target': ['Web_Server'], 'updated_at': ['2022_12_01'], 'created_at': ['2011_01_25'], 'deployment': ['Perimeter']}, 'action': 'allowed', 'signature_id': 2012230, 'rev': 7, 'category': 'Web Application Attack', 'signature': 'ET WEB_SERVER Likely Malicious Request for /proc/self/environ', 'severity': 1, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                             35
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_29'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049401, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER /etc/hosts Detected in URI', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                 33
{'metadata': {'updated_at': ['2020_04_21'], 'created_at': ['2010_07_30']}, 'action': 'allowed', 'signature_id': 2009485, 'rev': 7, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER /etc/shadow Detected in URI', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           24
{'metadata': {'updated_at': ['2019_07_26'], 'created_at': ['2010_09_23']}, 'action': 'allowed', 'signature_id': 2101122, 'rev': 8, 'category': 'Attempted Information Leak', 'signature': 'GPL WEB_SERVER /etc/passwd', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          14
{'metadata': {'updated_at': ['2020_04_21'], 'created_at': ['2010_09_23']}, 'action': 'allowed', 'signature_id': 2101129, 'rev': 9, 'category': 'Attempted Information Leak', 'signature': 'GPL WEB_SERVER .htaccess access', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     11
{'action': 'allowed', 'signature_id': 2210061, 'rev': 1, 'category': 'Generic Protocol Command Decode', 'signature': 'SURICATA STREAM spurious retransmission', 'severity': 3, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   6
{'metadata': {'updated_at': ['2019_07_26'], 'created_at': ['2010_09_23']}, 'action': 'allowed', 'signature_id': 2101371, 'rev': 7, 'category': 'access to a potentially vulnerable web application', 'signature': 'GPL WEB_SERVER /etc/motd access', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                              4
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'updated_at': ['2022_07_28'], 'affected_product': ['Web_Server_Applications'], 'deployment': ['SSLDecrypt', 'Perimeter'], 'created_at': ['2022_07_28'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2037838, 'rev': 1, 'category': 'access to a potentially vulnerable web application', 'signature': 'ET SCAN Web Scanner - Fuzz Faster U Fool (Inbound)', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                      3
{'metadata': {'updated_at': ['2019_07_26'], 'created_at': ['2010_09_23']}, 'action': 'allowed', 'cve_id': 'CVE-2001-0835', 'signature_id': 2101847, 'rev': 12, 'category': 'access to a potentially vulnerable web application', 'signature': 'GPL WEB_SERVER webalizer access', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                  3
{'metadata': {'updated_at': ['2019_07_26'], 'created_at': ['2010_09_23']}, 'action': 'allowed', 'signature_id': 2101370, 'rev': 8, 'category': 'access to a potentially vulnerable web application', 'signature': 'GPL WEB_SERVER /etc/inetd.conf access', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                        2
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_30'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049402, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER .bash_history Detected in URI', 'severity': 2, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 54616}, 'target': {'ip': '172.31.28.38', 'port': 80}}                                                                                                                                                                              1
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_30'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049402, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER .bash_history Detected in URI', 'severity': 2, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 54619}, 'target': {'ip': '172.31.28.38', 'port': 80}}                                                                                                                                                                              1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49711}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49727}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49731}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49717}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49766}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49768}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49764}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49776}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49762}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49782}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49723}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49729}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49721}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'updated_at': ['2019_07_26'], 'created_at': ['2010_09_23']}, 'action': 'allowed', 'signature_id': 2101071, 'rev': 8, 'category': 'Web Application Attack', 'signature': 'GPL WEB_SERVER .htpasswd access', 'severity': 1, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49733}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49719}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49741}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_30'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049402, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER .bash_history Detected in URI', 'severity': 2, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 55412}, 'target': {'ip': '172.31.28.38', 'port': 80}}                                                                                                                                                                              1
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_30'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049402, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER .bash_history Detected in URI', 'severity': 2, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 55414}, 'target': {'ip': '172.31.28.38', 'port': 80}}                                                                                                                                                                              1
{'metadata': {'attack_target': ['Server'], 'mitre_technique_id': ['T1190'], 'mitre_technique_name': ['Exploit_Public_Facing_Application'], 'tag': ['LFI', 'RFI', 'Exploit'], 'mitre_tactic_id': ['TA0001'], 'signature_severity': ['Major'], 'mitre_tactic_name': ['Initial_Access'], 'confidence': ['High'], 'updated_at': ['2022_05_31'], 'deployment': ['SSLDecrypt', 'Perimeter', 'Internal'], 'created_at': ['2022_05_31']}, 'action': 'allowed', 'signature_id': 2036730, 'rev': 1, 'category': 'Web Application Attack', 'signature': 'ET EXPLOIT Local File Inclusion with Shell Execution via proc/self/environ', 'severity': 1, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 49715}, 'target': {'ip': '172.31.28.38', 'port': 80}}       1
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_30'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049402, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER .bash_history Detected in URI', 'severity': 2, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 55424}, 'target': {'ip': '172.31.28.38', 'port': 80}}                                                                                                                                                                              1
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_30'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049402, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER .bash_history Detected in URI', 'severity': 2, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 55426}, 'target': {'ip': '172.31.28.38', 'port': 80}}                                                                                                                                                                              1
{'metadata': {'cve': ['CVE_2000_0778'], 'updated_at': ['2020_04_22'], 'created_at': ['2010_09_23']}, 'action': 'allowed', 'cve_id': 'CVE-2000-0778', 'signature_id': 2101016, 'rev': 16, 'category': 'access to a potentially vulnerable web application', 'signature': 'GPL WEB_SERVER global.asa access', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                       1
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_30'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049402, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER .bash_history Detected in URI', 'severity': 2, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 51973}, 'target': {'ip': '172.31.28.38', 'port': 80}}                                                                                                                                                                              1
{'metadata': {'performance_impact': ['Low'], 'attack_target': ['Web_Server'], 'confidence': ['High'], 'affected_product': ['Linux'], 'deployment': ['Perimeter', 'SSLDecrypt'], 'updated_at': ['2023_11_30'], 'created_at': ['2023_11_29'], 'signature_severity': ['Informational']}, 'action': 'allowed', 'signature_id': 2049402, 'rev': 1, 'category': 'Attempted Information Leak', 'signature': 'ET WEB_SERVER .bash_history Detected in URI', 'severity': 2, 'gid': 1, 'source': {'ip': '183.89.248.147', 'port': 52675}, 'target': {'ip': '172.31.28.38', 'port': 80}}                                                                                                                                                                              1
{'metadata': {'updated_at': ['2019_07_26'], 'created_at': ['2010_09_23']}, 'action': 'allowed', 'signature_id': 2101852, 'rev': 5, 'category': 'access to a potentially vulnerable web application', 'signature': 'GPL WEB_SERVER robots.txt access', 'severity': 2, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                             1
{'metadata': {'updated_at': ['2019_07_26'], 'created_at': ['2010_07_30']}, 'action': 'allowed', 'signature_id': 2000560, 'rev': 10, 'category': 'Misc activity', 'signature': 'ET POLICY HTTP CONNECT Tunnel Attempt Inbound', 'severity': 3, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1
{'metadata': {'updated_at': ['2019_07_26'], 'created_at': ['2010_09_23']}, 'action': 'allowed', 'cve_id': 'CVE-2002-0614', 'signature_id': 2101738, 'rev': 8, 'category': 'Web Application Attack', 'signature': 'GPL WEB_SERVER global.inc access', 'severity': 1, 'gid': 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1
Name: count, dtype: int64
2025-07-18 09:54:31,514 - __main__ - INFO - Imbalance ratio in path_traversal: 3665.0:1
2025-07-18 09:54:31,514 - __main__ - INFO - Applying SMOTE to path_traversal...
2025-07-18 09:54:31,514 - __main__ - ERROR - SMOTE failed for path_traversal: name 'payload_col' is not defined
2025-07-18 09:54:31,514 - __main__ - INFO - Falling back to random oversampling...
2025-07-18 09:54:31,521 - __main__ - INFO - Random oversampling completed. New shape: (7330, 38)
2025-07-18 09:54:31,522 - __main__ - INFO - Saved cleaning stats for path_traversal to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase1/cleaning/path_traversal_cleaning_stats.json
2025-07-18 09:54:31,535 - __main__ - INFO - Saved cleaned sample for path_traversal to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase1/cleaning/path_traversal_cleaned_sample.csv
2025-07-18 09:54:31,535 - __main__ - INFO - Completed cleaning for path_traversal. Final shape: (7330, 38)
2025-07-18 10:22:11,883 - __main__ - ERROR - Encoding failed: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 14, in main
    "xss": pd.read_csv("src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs"),
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1661, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/common.py", line 859, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
2025-07-18 10:26:47,776 - __main__ - ERROR - Encoding failed: [Errno 2] No such file or directory: 'hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 14, in main
    "xss": pd.read_csv("hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs"),
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1661, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/common.py", line 859, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
2025-07-18 10:27:13,452 - __main__ - ERROR - Encoding failed: [Errno 2] No such file or directory: 'hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 14, in main
    "xss": pd.read_csv("hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs"),
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1661, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/common.py", line 859, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
2025-07-18 10:27:23,199 - __main__ - ERROR - Encoding failed: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 14, in main
    "xss": pd.read_csv("src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs"),
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1661, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/common.py", line 859, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
2025-07-18 10:31:52,774 - __main__ - ERROR - Encoding failed: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 14, in main
    "xss": pd.read_csv("src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs"),
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1661, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/io/common.py", line 859, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase1/cleaning/xss_cleaned_sample.csvs'
2025-07-18 10:45:25,850 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-18 10:45:25,851 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-18 10:45:25,852 - src.hybrid_threat_detection.features.encoding - INFO - Encoded labels for xss. Distribution:
label
0    100
Name: count, dtype: int64
2025-07-18 10:45:25,853 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-18 10:45:25,853 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-18 10:45:25,854 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-18 10:45:25,857 - src.hybrid_threat_detection.features.encoding - INFO - Encoded labels for sql_injection. Distribution:
label
0    82
1    18
Name: count, dtype: int64
2025-07-18 10:45:25,859 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-18 10:45:25,859 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-18 10:45:25,859 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-18 10:45:25,860 - src.hybrid_threat_detection.features.encoding - INFO - Encoded labels for path_traversal. Distribution:
label
0    55
1    45
Name: count, dtype: int64
2025-07-18 10:45:25,861 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-18 10:45:25,861 - src.hybrid_threat_detection.features.encoding - INFO - Saved encoding metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/encoding/encoding_metadata.json
2025-07-18 10:45:25,864 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-18 10:45:25,870 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-18 10:45:25,883 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-18 10:45:25,883 - __main__ - INFO - Encoding completed successfully!
2025-07-18 10:45:25,883 - __main__ - INFO - 
Encoding Summary:
2025-07-18 10:45:25,883 - __main__ - INFO - 
Dataset: xss
2025-07-18 10:45:25,883 - __main__ - INFO - Attack type: XSS
2025-07-18 10:45:25,883 - __main__ - INFO - Label distribution: {0: 100}
2025-07-18 10:45:25,883 - __main__ - INFO - Original label column: event_type
2025-07-18 10:45:25,883 - __main__ - INFO - 
Dataset: sql_injection
2025-07-18 10:45:25,883 - __main__ - INFO - Attack type: SQLI
2025-07-18 10:45:25,883 - __main__ - INFO - Label distribution: {0: 82, 1: 18}
2025-07-18 10:45:25,883 - __main__ - INFO - Original label column: alert
2025-07-18 10:45:25,883 - __main__ - INFO - 
Dataset: path_traversal
2025-07-18 10:45:25,883 - __main__ - INFO - Attack type: PathTraversal
2025-07-18 10:45:25,883 - __main__ - INFO - Label distribution: {0: 55, 1: 45}
2025-07-18 10:45:25,883 - __main__ - INFO - Original label column: alert
2025-07-18 10:49:41,221 - __main__ - ERROR - Splitting failed: [Errno 2] No such file or directory: 'src\\hybrid_threat_detection\\config\\splitting_config.json'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_splitting.py", line 20, in main
    config = load_json("src\hybrid_threat_detection\config\splitting_config.json")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/utils/helpers.py", line 33, in load_json
    with open(file_path, 'r') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'src\\hybrid_threat_detection\\config\\splitting_config.json'
2025-07-18 10:54:47,373 - __main__ - ERROR - Vectorization failed: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/config/vectorization_config.json'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_vectorization.py", line 19, in main
    config = load_json("src/hybrid_threat_detection/config/vectorization_config.json")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/utils/helpers.py", line 33, in load_json
    with open(file_path, 'r') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/config/vectorization_config.json'
2025-07-18 10:55:45,122 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: xss
2025-07-18 10:55:45,123 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to xss
2025-07-18 10:55:45,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for xss. Shape: (100, 138)
2025-07-18 10:55:45,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to xss
2025-07-18 10:55:45,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for xss
2025-07-18 10:55:45,126 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for xss: 70
2025-07-18 10:55:45,126 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-18 10:55:45,126 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-18 10:55:45,126 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-18 10:55:45,126 - gensim.downloader - INFO - Creating /home/jupyter5/gensim-data
2025-07-18 10:55:52,607 - gensim.downloader - INFO - glove-wiki-gigaword-100 downloaded
2025-07-18 10:55:52,608 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-18 10:56:06,261 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-18T10:56:06.261397', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-18 10:56:06,349 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-18 10:56:06,356 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (70, 100)
2025-07-18 10:56:06,375 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: sql_injection
2025-07-18 10:56:06,376 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to sql_injection
2025-07-18 10:56:06,377 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for sql_injection. Shape: (100, 19)
2025-07-18 10:56:06,377 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to sql_injection
2025-07-18 10:56:06,377 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for sql_injection
2025-07-18 10:56:06,378 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for sql_injection: 21
2025-07-18 10:56:06,378 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-18 10:56:06,378 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-18 10:56:06,378 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-18 10:56:06,410 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-18 10:56:20,013 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-18T10:56:20.013068', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-18 10:56:20,097 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-18 10:56:20,104 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (21, 100)
2025-07-18 10:56:20,123 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: path_traversal
2025-07-18 10:56:20,123 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to path_traversal
2025-07-18 10:56:20,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for path_traversal. Shape: (100, 60)
2025-07-18 10:56:20,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to path_traversal
2025-07-18 10:56:20,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for path_traversal
2025-07-18 10:56:20,126 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for path_traversal: 33
2025-07-18 10:56:20,126 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-18 10:56:20,126 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-18 10:56:20,126 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-18 10:56:20,161 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-18 10:56:33,730 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-18T10:56:33.730329', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-18 10:56:33,814 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-18 10:56:33,821 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (33, 100)
2025-07-18 10:56:33,839 - __main__ - INFO - Vectorization completed successfully!
2025-07-18 10:56:33,840 - __main__ - INFO - XSS TF-IDF shape: (100, 138)
2025-07-18 10:56:33,840 - __main__ - INFO - XSS Padded Sequences shape: (100, 100)
2025-07-18 10:57:54,793 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-18 10:57:54,796 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-18 10:57:54,796 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-18 10:57:54,796 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-18 10:57:54,797 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-18 10:57:54,797 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-18 10:57:54,797 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-18 10:57:54,799 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-18 10:57:54,799 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-18 10:57:54,799 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-18 10:57:54,821 - __main__ - INFO - Splitting completed successfully!
2025-07-18 10:57:54,821 - __main__ - INFO - 
Splitting Summary:
2025-07-18 10:57:54,821 - __main__ - INFO - 
Dataset: xss
2025-07-18 10:57:54,821 - __main__ - INFO - Split type: train_test
2025-07-18 10:57:54,821 - __main__ - INFO - Train samples: 80
2025-07-18 10:57:54,821 - __main__ - INFO - Test samples: 20
2025-07-18 10:57:54,821 - __main__ - INFO - Train label distribution: {0: 80}
2025-07-18 10:57:54,821 - __main__ - INFO - 
Dataset: sql_injection
2025-07-18 10:57:54,821 - __main__ - INFO - Split type: train_test
2025-07-18 10:57:54,821 - __main__ - INFO - Train samples: 80
2025-07-18 10:57:54,821 - __main__ - INFO - Test samples: 20
2025-07-18 10:57:54,821 - __main__ - INFO - Train label distribution: {0: 66, 1: 14}
2025-07-18 10:57:54,821 - __main__ - INFO - 
Dataset: path_traversal
2025-07-18 10:57:54,821 - __main__ - INFO - Split type: train_test
2025-07-18 10:57:54,821 - __main__ - INFO - Train samples: 80
2025-07-18 10:57:54,821 - __main__ - INFO - Test samples: 20
2025-07-18 10:57:54,821 - __main__ - INFO - Train label distribution: {0: 44, 1: 36}
2025-07-18 14:10:13,111 - __main__ - INFO - Starting supervised model training pipeline
2025-07-18 14:10:13,111 - __main__ - ERROR - Model training failed: Expecting value: line 5 column 27 (char 115)
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_model_training.py", line 13, in main
    trainer = SupervisedModelTrainer(
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 43, in __init__
    self.config = self._load_config(config_path)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 89, in _load_config
    config = json.load(f)
             ^^^^^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/__init__.py", line 293, in load
    return loads(fp.read(),
           ^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/decoder.py", line 338, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/decoder.py", line 356, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 5 column 27 (char 115)
2025-07-18 14:17:03,775 - __main__ - INFO - Starting supervised model training pipeline
2025-07-18 14:17:03,775 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-18 14:17:03,775 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:17:03,775 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-18 14:17:03,775 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:17:03,783 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error loading data for xss: 'payload'
2025-07-18 14:17:03,783 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error processing dataset xss: 'payload'
2025-07-18 14:17:03,783 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:17:03,783 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-18 14:17:03,783 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:17:03,792 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-18 14:17:03,792 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:17:06,150 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:17:06,161 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:17:06,162 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-18 14:17:06,162 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-18 14:17:06,162 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:17:06,163 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error processing dataset sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:17:06,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:17:06,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-18 14:17:06,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:17:06,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-18 14:17:06,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:17:07,684 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:17:07,693 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:17:07,694 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-18 14:17:07,694 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-18 14:17:07,694 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:17:07,695 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error processing dataset path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:17:07,695 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-18 14:17:07,695 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-18 14:17:07,695 - __main__ - INFO - Model training completed successfully!
2025-07-18 14:30:47,260 - __main__ - INFO - Starting supervised model training pipeline
2025-07-18 14:30:47,260 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-18 14:30:47,261 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:30:47,261 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-18 14:30:47,261 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:30:47,270 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-18 14:30:47,270 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:30:49,613 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:30:49,616 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model random_forest failed on xss: index 1 is out of bounds for axis 1 with size 1
2025-07-18 14:30:49,616 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-18 14:30:49,616 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:30:49,616 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:30:49,616 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-18 14:30:49,616 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:30:49,629 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model logistic_regression failed on xss: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py", line 1301, in fit
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

2025-07-18 14:30:49,629 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-18 14:30:49,629 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:30:49,652 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model svm failed on xss: 
All the 60 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
60 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 207, in fit
    y = self._validate_targets(y)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 751, in _validate_targets
    raise ValueError(
ValueError: The number of classes has to be greater than one; got 1 class

2025-07-18 14:30:49,834 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:30:49,834 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-18 14:30:49,834 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:30:49,844 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-18 14:30:49,844 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:30:51,356 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:30:51,367 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:30:51,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-18 14:30:51,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-18 14:30:51,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:30:51,368 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:30:51,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-18 14:30:51,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:30:51,397 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:30:51,403 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:30:51,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-18 14:30:51,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-18 14:30:51,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:30:51,449 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:30:51,456 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:30:51,456 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-18 14:30:51,550 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-18 14:30:51,615 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-18 14:30:51,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-18 14:30:51,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:30:51,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-18 14:30:51,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:30:51,692 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-18 14:30:51,692 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:30:53,284 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:30:53,294 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:30:53,295 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-18 14:30:53,295 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-18 14:30:53,295 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:30:53,295 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:30:53,295 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-18 14:30:53,295 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:30:53,309 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:30:53,316 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:30:53,316 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-18 14:30:53,316 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-18 14:30:53,316 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:30:53,355 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:30:53,362 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:30:53,363 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-18 14:30:53,420 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-18 14:30:53,513 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-18 14:30:53,568 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-18 14:30:53,569 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-18 14:30:53,569 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-18 14:30:53,569 - __main__ - INFO - Model training completed successfully!
2025-07-18 14:30:53,569 - __main__ - INFO - 
Results for xss:
2025-07-18 14:30:53,569 - __main__ - INFO - 
Results for sql_injection:
2025-07-18 14:30:53,569 - __main__ - INFO - 
random_forest:
2025-07-18 14:30:53,569 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:30:53,569 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-18 14:30:53,569 - __main__ - INFO - 
logistic_regression:
2025-07-18 14:30:53,569 - __main__ - INFO - Best params: {'C': 1, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:30:53,569 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-18 14:30:53,569 - __main__ - INFO - 
svm:
2025-07-18 14:30:53,569 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:30:53,569 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-18 14:30:53,569 - __main__ - INFO - 
Results for path_traversal:
2025-07-18 14:30:53,569 - __main__ - INFO - 
random_forest:
2025-07-18 14:30:53,569 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:30:53,569 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[11, 0], [0, 9]], 'roc_auc': 1.0}
2025-07-18 14:30:53,569 - __main__ - INFO - 
logistic_regression:
2025-07-18 14:30:53,569 - __main__ - INFO - Best params: {'C': 0.1, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:30:53,569 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[11, 0], [0, 9]], 'roc_auc': 1.0}
2025-07-18 14:30:53,569 - __main__ - INFO - 
svm:
2025-07-18 14:30:53,569 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:30:53,569 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[11, 0], [0, 9]], 'roc_auc': 1.0}
2025-07-18 14:45:59,467 - __main__ - INFO - Starting supervised model training pipeline
2025-07-18 14:45:59,468 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-18 14:45:59,468 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:45:59,468 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-18 14:45:59,468 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:45:59,474 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error loading data for xss: Train set for xss has only one class: [0]
2025-07-18 14:45:59,474 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Skipping xss due to: Train set for xss has only one class: [0]
2025-07-18 14:45:59,474 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:45:59,474 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-18 14:45:59,474 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:45:59,485 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-18 14:45:59,485 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:46:01,848 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:46:01,859 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:46:01,860 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-18 14:46:01,860 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-18 14:46:01,860 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:46:01,860 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:46:01,860 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-18 14:46:01,860 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:46:01,887 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:46:01,894 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:46:01,894 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-18 14:46:01,894 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-18 14:46:01,895 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:46:01,933 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:46:01,940 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:46:01,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-18 14:46:02,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-18 14:46:02,211 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error processing dataset sql_injection: 'metrics'
2025-07-18 14:46:02,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:46:02,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-18 14:46:02,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:46:02,229 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-18 14:46:02,229 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:46:03,740 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:46:03,750 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:46:03,750 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-18 14:46:03,751 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-18 14:46:03,751 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:46:03,751 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:46:03,751 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-18 14:46:03,751 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:46:03,777 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:46:03,789 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:46:03,790 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-18 14:46:03,791 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-18 14:46:03,791 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:46:03,830 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:46:03,838 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:46:03,838 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-18 14:46:03,896 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-18 14:46:03,896 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error processing dataset path_traversal: 'metrics'
2025-07-18 14:46:03,896 - __main__ - ERROR - Model training failed: string indices must be integers, not 'str'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_model_training.py", line 18, in main
    results = trainer.train_models()
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 189, in train_models
    self._save_combined_results()
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 301, in _save_combined_results
    "best_params": model_info["best_params"],
                   ~~~~~~~~~~^^^^^^^^^^^^^^^
TypeError: string indices must be integers, not 'str'
2025-07-18 14:49:37,248 - __main__ - INFO - Starting supervised model training pipeline
2025-07-18 14:49:37,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-18 14:49:37,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:49:37,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-18 14:49:37,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:49:37,258 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-18 14:49:37,258 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:49:39,532 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:49:39,535 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model random_forest failed on xss: index 1 is out of bounds for axis 1 with size 1
2025-07-18 14:49:39,535 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-18 14:49:39,535 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:49:39,535 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:49:39,535 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-18 14:49:39,535 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:49:39,548 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model logistic_regression failed on xss: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py", line 1301, in fit
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

2025-07-18 14:49:39,548 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-18 14:49:39,548 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:49:39,572 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model svm failed on xss: 
All the 60 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
60 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 207, in fit
    y = self._validate_targets(y)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 751, in _validate_targets
    raise ValueError(
ValueError: The number of classes has to be greater than one; got 1 class

2025-07-18 14:49:39,749 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:49:39,749 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-18 14:49:39,749 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:49:39,759 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-18 14:49:39,759 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:49:41,252 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:49:41,263 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:49:41,264 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-18 14:49:41,264 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-18 14:49:41,264 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:49:41,264 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:49:41,264 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-18 14:49:41,264 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:49:41,290 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:49:41,297 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:49:41,298 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-18 14:49:41,298 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-18 14:49:41,298 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:49:41,343 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:49:41,350 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:49:41,350 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-18 14:49:41,445 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-18 14:49:41,510 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-18 14:49:41,572 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-18 14:49:41,572 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:49:41,572 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-18 14:49:41,572 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:49:41,588 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-18 14:49:41,588 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:49:43,153 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:49:43,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:49:43,164 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-18 14:49:43,164 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-18 14:49:43,164 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:49:43,164 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:49:43,164 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-18 14:49:43,164 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:49:43,191 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:49:43,201 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:49:43,201 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-18 14:49:43,201 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-18 14:49:43,201 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:49:43,241 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:49:43,249 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:49:43,250 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-18 14:49:43,307 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-18 14:49:43,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-18 14:49:43,464 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-18 14:49:43,464 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-18 14:49:43,464 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-18 14:49:43,464 - __main__ - INFO - Model training completed successfully!
2025-07-18 14:49:43,464 - __main__ - INFO - 
Results for xss:
2025-07-18 14:49:43,464 - __main__ - INFO - 
Results for sql_injection:
2025-07-18 14:49:43,464 - __main__ - INFO - 
random_forest:
2025-07-18 14:49:43,464 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:49:43,464 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-18 14:49:43,464 - __main__ - INFO - 
logistic_regression:
2025-07-18 14:49:43,464 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:49:43,464 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-18 14:49:43,464 - __main__ - INFO - 
svm:
2025-07-18 14:49:43,464 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:49:43,464 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-18 14:49:43,464 - __main__ - INFO - 
Results for path_traversal:
2025-07-18 14:49:43,464 - __main__ - INFO - 
random_forest:
2025-07-18 14:49:43,464 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:49:43,464 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[11, 0], [0, 9]], 'roc_auc': 1.0}
2025-07-18 14:49:43,464 - __main__ - INFO - 
logistic_regression:
2025-07-18 14:49:43,464 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:49:43,464 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[11, 0], [0, 9]], 'roc_auc': 1.0}
2025-07-18 14:49:43,464 - __main__ - INFO - 
svm:
2025-07-18 14:49:43,464 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:49:43,464 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[11, 0], [0, 9]], 'roc_auc': 1.0}
2025-07-18 14:50:42,987 - __main__ - INFO - Starting supervised model training pipeline
2025-07-18 14:50:42,987 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-18 14:50:42,987 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:50:42,987 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-18 14:50:42,988 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:50:42,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-18 14:50:42,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:50:45,277 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:50:45,280 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model random_forest failed on xss: index 1 is out of bounds for axis 1 with size 1
2025-07-18 14:50:45,280 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-18 14:50:45,280 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:50:45,281 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:50:45,281 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-18 14:50:45,281 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:50:45,293 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model logistic_regression failed on xss: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py", line 1301, in fit
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

2025-07-18 14:50:45,293 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-18 14:50:45,293 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:50:45,318 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model svm failed on xss: 
All the 60 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
60 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 207, in fit
    y = self._validate_targets(y)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 751, in _validate_targets
    raise ValueError(
ValueError: The number of classes has to be greater than one; got 1 class

2025-07-18 14:50:45,501 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:50:45,501 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-18 14:50:45,501 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:50:45,511 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-18 14:50:45,512 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:50:47,021 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:50:47,031 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:50:47,032 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-18 14:50:47,032 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-18 14:50:47,033 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:50:47,033 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:50:47,033 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-18 14:50:47,033 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:50:47,059 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:50:47,066 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:50:47,066 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-18 14:50:47,066 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-18 14:50:47,066 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:50:47,104 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:50:47,112 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-18 14:50:47,112 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-18 14:50:47,207 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-18 14:50:47,271 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-18 14:50:47,330 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-18 14:50:47,330 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-18 14:50:47,330 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-18 14:50:47,330 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-18 14:50:47,346 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-18 14:50:47,346 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-18 14:50:48,899 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:50:48,908 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:50:48,909 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-18 14:50:48,909 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-18 14:50:48,909 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-18 14:50:48,910 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-18 14:50:48,910 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-18 14:50:48,910 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-18 14:50:48,934 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:50:48,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:50:48,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-18 14:50:48,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-18 14:50:48,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-18 14:50:48,981 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:50:48,990 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[11, 0], [0, 9]]      1.0
2025-07-18 14:50:48,991 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-18 14:50:49,050 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-18 14:50:49,153 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-18 14:50:49,208 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-18 14:50:49,208 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-18 14:50:49,208 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-18 14:50:49,208 - __main__ - INFO - Model training completed successfully!
2025-07-18 14:50:49,208 - __main__ - INFO - 
Results for xss:
2025-07-18 14:50:49,208 - __main__ - INFO - 
Results for sql_injection:
2025-07-18 14:50:49,208 - __main__ - INFO - 
random_forest:
2025-07-18 14:50:49,208 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:50:49,208 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-18 14:50:49,208 - __main__ - INFO - 
logistic_regression:
2025-07-18 14:50:49,208 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:50:49,208 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-18 14:50:49,209 - __main__ - INFO - 
svm:
2025-07-18 14:50:49,209 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:50:49,209 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-18 14:50:49,209 - __main__ - INFO - 
Results for path_traversal:
2025-07-18 14:50:49,209 - __main__ - INFO - 
random_forest:
2025-07-18 14:50:49,209 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-18 14:50:49,209 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[11, 0], [0, 9]], 'roc_auc': 1.0}
2025-07-18 14:50:49,209 - __main__ - INFO - 
logistic_regression:
2025-07-18 14:50:49,209 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-18 14:50:49,209 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[11, 0], [0, 9]], 'roc_auc': 1.0}
2025-07-18 14:50:49,209 - __main__ - INFO - 
svm:
2025-07-18 14:50:49,209 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-18 14:50:49,209 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[11, 0], [0, 9]], 'roc_auc': 1.0}
2025-07-20 19:51:30,568 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 19:51:30,569 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 19:51:30,585 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 19:51:30,586 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    100
Name: count, dtype: int64
2025-07-20 19:51:30,588 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 19:51:30,588 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 19:51:30,588 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 19:51:30,622 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 19:51:30,623 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    100
Name: count, dtype: int64
2025-07-20 19:51:30,624 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 19:51:30,624 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 19:51:30,624 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 19:51:30,635 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 19:51:30,635 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
0    100
Name: count, dtype: int64
2025-07-20 19:51:30,636 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 19:51:30,637 - __main__ - ERROR - Encoding failed: Object of type int64 is not JSON serializable
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 19, in main
    encoded_data = encoder.encode_all(cleaned_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 59, in encode_all
    self._save_artifacts()
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 223, in _save_artifacts
    save_json({
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/utils/helpers.py", line 29, in save_json
    json.dump(data, f, indent=2)
  File "/opt/miniconda3/lib/python3.12/json/__init__.py", line 179, in dump
    for chunk in iterable:
                 ^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/opt/miniconda3/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/opt/miniconda3/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/opt/miniconda3/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  [Previous line repeated 1 more time]
  File "/opt/miniconda3/lib/python3.12/json/encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type int64 is not JSON serializable
2025-07-20 19:56:17,015 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 19:56:17,016 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 19:56:17,031 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 19:56:17,032 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    100
Name: count, dtype: int64
2025-07-20 19:56:17,033 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 19:56:17,033 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 19:56:17,034 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 19:56:17,067 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 19:56:17,067 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    100
Name: count, dtype: int64
2025-07-20 19:56:17,068 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 19:56:17,069 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 19:56:17,069 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 19:56:17,079 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 19:56:17,080 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
0    100
Name: count, dtype: int64
2025-07-20 19:56:17,081 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 19:56:17,085 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 19:56:17,091 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 19:56:17,106 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 19:56:17,106 - __main__ - INFO - Encoding completed successfully!
2025-07-20 19:56:17,106 - __main__ - INFO - 
Encoding Summary:
2025-07-20 19:56:17,106 - __main__ - INFO - 
Dataset: metadata
2025-07-20 19:56:17,106 - __main__ - INFO - Attack type: None
2025-07-20 19:56:17,106 - __main__ - INFO - Label distribution: None
2025-07-20 19:56:17,106 - __main__ - INFO - Original label column: None
2025-07-20 19:56:17,106 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 19:56:17,106 - __main__ - INFO - Attack type: None
2025-07-20 19:56:17,106 - __main__ - INFO - Label distribution: None
2025-07-20 19:56:17,106 - __main__ - INFO - Original label column: None
2025-07-20 20:04:15,106 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-20 20:04:15,109 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 20:04:15,109 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-20 20:04:15,109 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-20 20:04:15,111 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 20:04:15,111 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-20 20:04:15,111 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-20 20:04:15,112 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 20:04:15,113 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-20 20:04:15,113 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-20 20:04:15,137 - __main__ - INFO - Splitting completed successfully!
2025-07-20 20:04:15,137 - __main__ - INFO - 
Splitting Summary:
2025-07-20 20:04:15,137 - __main__ - INFO - 
Dataset: xss
2025-07-20 20:04:15,137 - __main__ - INFO - Split type: train_test
2025-07-20 20:04:15,137 - __main__ - INFO - Train samples: 80
2025-07-20 20:04:15,137 - __main__ - INFO - Test samples: 20
2025-07-20 20:04:15,137 - __main__ - INFO - Train label distribution: {0: 80}
2025-07-20 20:04:15,137 - __main__ - INFO - 
Dataset: sql_injection
2025-07-20 20:04:15,137 - __main__ - INFO - Split type: train_test
2025-07-20 20:04:15,137 - __main__ - INFO - Train samples: 80
2025-07-20 20:04:15,137 - __main__ - INFO - Test samples: 20
2025-07-20 20:04:15,137 - __main__ - INFO - Train label distribution: {0: 80}
2025-07-20 20:04:15,137 - __main__ - INFO - 
Dataset: path_traversal
2025-07-20 20:04:15,137 - __main__ - INFO - Split type: train_test
2025-07-20 20:04:15,137 - __main__ - INFO - Train samples: 80
2025-07-20 20:04:15,137 - __main__ - INFO - Test samples: 20
2025-07-20 20:04:15,137 - __main__ - INFO - Train label distribution: {0: 80}
2025-07-20 20:05:23,771 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: xss
2025-07-20 20:05:23,772 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to xss
2025-07-20 20:05:23,776 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for xss. Shape: (100, 138)
2025-07-20 20:05:23,776 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to xss
2025-07-20 20:05:23,776 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for xss
2025-07-20 20:05:23,777 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for xss: 70
2025-07-20 20:05:23,777 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-20 20:05:23,777 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-20 20:05:23,777 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-20 20:05:24,983 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-20 20:05:38,405 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-20T20:05:38.405534', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-20 20:05:38,500 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-20 20:05:38,507 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (70, 100)
2025-07-20 20:05:38,530 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: sql_injection
2025-07-20 20:05:38,531 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to sql_injection
2025-07-20 20:05:38,532 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for sql_injection. Shape: (100, 19)
2025-07-20 20:05:38,532 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to sql_injection
2025-07-20 20:05:38,532 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for sql_injection
2025-07-20 20:05:38,533 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for sql_injection: 21
2025-07-20 20:05:38,533 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-20 20:05:38,533 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-20 20:05:38,533 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-20 20:05:38,565 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-20 20:05:51,998 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-20T20:05:51.998119', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-20 20:05:52,090 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-20 20:05:52,097 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (21, 100)
2025-07-20 20:05:52,122 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: path_traversal
2025-07-20 20:05:52,123 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to path_traversal
2025-07-20 20:05:52,124 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for path_traversal. Shape: (100, 60)
2025-07-20 20:05:52,124 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to path_traversal
2025-07-20 20:05:52,124 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for path_traversal
2025-07-20 20:05:52,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for path_traversal: 33
2025-07-20 20:05:52,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-20 20:05:52,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-20 20:05:52,125 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-20 20:05:52,158 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-20 20:06:05,543 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-20T20:06:05.542972', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-20 20:06:05,628 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-20 20:06:05,634 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (33, 100)
2025-07-20 20:06:05,657 - __main__ - INFO - Vectorization completed successfully!
2025-07-20 20:06:05,657 - __main__ - INFO - XSS TF-IDF shape: (100, 138)
2025-07-20 20:06:05,657 - __main__ - INFO - XSS Padded Sequences shape: (100, 100)
2025-07-20 20:06:35,403 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 20:06:35,403 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 20:06:35,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 20:06:35,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 20:06:35,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 20:06:35,414 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 20:06:35,414 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 20:06:38,269 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:06:38,272 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model random_forest failed on xss: index 1 is out of bounds for axis 1 with size 1
2025-07-20 20:06:38,272 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 20:06:38,272 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 20:06:38,272 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 20:06:38,272 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 20:06:38,272 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 20:06:38,285 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model logistic_regression failed on xss: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py", line 1301, in fit
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

2025-07-20 20:06:38,285 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 20:06:38,285 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 20:06:38,311 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model svm failed on xss: 
All the 60 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
60 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 207, in fit
    y = self._validate_targets(y)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 751, in _validate_targets
    raise ValueError(
ValueError: The number of classes has to be greater than one; got 1 class

2025-07-20 20:06:38,512 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 20:06:38,512 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 20:06:38,512 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 20:06:38,523 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 20:06:38,523 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 20:06:40,097 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:06:40,100 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model random_forest failed on sql_injection: index 1 is out of bounds for axis 1 with size 1
2025-07-20 20:06:40,100 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 20:06:40,100 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 20:06:40,100 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 20:06:40,100 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 20:06:40,100 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 20:06:40,113 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model logistic_regression failed on sql_injection: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py", line 1301, in fit
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

2025-07-20 20:06:40,113 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 20:06:40,113 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 20:06:40,139 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model svm failed on sql_injection: 
All the 60 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
60 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 207, in fit
    y = self._validate_targets(y)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 751, in _validate_targets
    raise ValueError(
ValueError: The number of classes has to be greater than one; got 1 class

2025-07-20 20:06:40,139 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 20:06:40,139 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 20:06:40,139 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 20:06:40,154 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 20:06:40,154 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 20:06:41,750 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:06:41,754 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model random_forest failed on path_traversal: index 1 is out of bounds for axis 1 with size 1
2025-07-20 20:06:41,754 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 20:06:41,754 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 20:06:41,754 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 20:06:41,754 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 20:06:41,754 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 20:06:41,766 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model logistic_regression failed on path_traversal: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py", line 1301, in fit
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

2025-07-20 20:06:41,766 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 20:06:41,766 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 20:06:41,801 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model svm failed on path_traversal: 
All the 60 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
60 fits failed with the following error:
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 207, in fit
    y = self._validate_targets(y)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/sklearn/svm/_base.py", line 751, in _validate_targets
    raise ValueError(
ValueError: The number of classes has to be greater than one; got 1 class

2025-07-20 20:06:41,802 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 20:06:41,802 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 20:06:41,802 - __main__ - INFO - Model training completed successfully!
2025-07-20 20:06:41,802 - __main__ - INFO - 
Results for xss:
2025-07-20 20:06:41,802 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 20:06:41,802 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 20:07:48,201 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 20:07:48,201 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 20:07:48,217 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 20:07:48,218 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    100
Name: count, dtype: int64
2025-07-20 20:07:48,219 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 20:07:48,219 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 20:07:48,220 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 20:07:48,253 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 20:07:48,254 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    100
Name: count, dtype: int64
2025-07-20 20:07:48,256 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 20:07:48,256 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 20:07:48,256 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 20:07:48,267 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 20:07:48,268 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
0    100
Name: count, dtype: int64
2025-07-20 20:07:48,269 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 20:07:48,272 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 20:07:48,278 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 20:07:48,291 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 20:07:48,291 - __main__ - INFO - Encoding completed successfully!
2025-07-20 20:07:48,291 - __main__ - INFO - 
Encoding Summary:
2025-07-20 20:07:48,291 - __main__ - INFO - 
Dataset: metadata
2025-07-20 20:07:48,291 - __main__ - INFO - Attack type: None
2025-07-20 20:07:48,291 - __main__ - INFO - Label distribution: None
2025-07-20 20:07:48,291 - __main__ - INFO - Original label column: None
2025-07-20 20:07:48,291 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 20:07:48,291 - __main__ - INFO - Attack type: None
2025-07-20 20:07:48,291 - __main__ - INFO - Label distribution: None
2025-07-20 20:07:48,291 - __main__ - INFO - Original label column: None
2025-07-20 20:18:16,679 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 20:18:16,679 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 20:18:16,695 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 20:18:16,696 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    100
Name: count, dtype: int64
2025-07-20 20:18:16,697 - src.hybrid_threat_detection.features.encoding - WARNING - No malicious samples detected in xss! Using attack type fallback
2025-07-20 20:18:16,701 - src.hybrid_threat_detection.features.encoding - WARNING - WARNING: Only one class ([1]) found in xss labels!
2025-07-20 20:18:16,701 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 20:18:16,701 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 20:18:16,701 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 20:18:16,736 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 20:18:16,737 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    100
Name: count, dtype: int64
2025-07-20 20:18:16,737 - src.hybrid_threat_detection.features.encoding - WARNING - No malicious samples detected in sql_injection! Using attack type fallback
2025-07-20 20:18:16,738 - src.hybrid_threat_detection.features.encoding - WARNING - WARNING: Only one class ([1]) found in sql_injection labels!
2025-07-20 20:18:16,738 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 20:18:16,738 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 20:18:16,739 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 20:18:16,750 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 20:18:16,751 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
0    100
Name: count, dtype: int64
2025-07-20 20:18:16,751 - src.hybrid_threat_detection.features.encoding - WARNING - No malicious samples detected in path_traversal! Using attack type fallback
2025-07-20 20:18:16,752 - src.hybrid_threat_detection.features.encoding - WARNING - WARNING: Only one class ([1]) found in path_traversal labels!
2025-07-20 20:18:16,752 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 20:18:16,755 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 20:18:16,761 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 20:18:16,774 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 20:18:16,774 - __main__ - INFO - Encoding completed successfully!
2025-07-20 20:18:16,774 - __main__ - INFO - 
Encoding Summary:
2025-07-20 20:18:16,774 - __main__ - INFO - 
Dataset: metadata
2025-07-20 20:18:16,774 - __main__ - INFO - Attack type: None
2025-07-20 20:18:16,774 - __main__ - INFO - Label distribution: None
2025-07-20 20:18:16,774 - __main__ - INFO - Original label column: None
2025-07-20 20:18:16,774 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 20:18:16,774 - __main__ - INFO - Attack type: None
2025-07-20 20:18:16,774 - __main__ - INFO - Label distribution: None
2025-07-20 20:18:16,774 - __main__ - INFO - Original label column: None
2025-07-20 20:22:33,456 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 20:22:33,456 - src.hybrid_threat_detection.features.encoding - ERROR - Error encoding xss: 'label'
2025-07-20 20:22:33,456 - __main__ - ERROR - Encoding failed: 'label'
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'label'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 19, in main
    encoded_data = encoder.encode_all(cleaned_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 52, in encode_all
    encoded_df, metadata = self._encode_dataset(name, df)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 90, in _encode_dataset
    if len(df['label'].unique()) == 1:
           ~~^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'label'
2025-07-20 20:23:18,812 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 20:23:18,813 - src.hybrid_threat_detection.features.encoding - ERROR - Error encoding xss: 'label'
2025-07-20 20:23:18,813 - __main__ - ERROR - Encoding failed: 'label'
Traceback (most recent call last):
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'label'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 19, in main
    encoded_data = encoder.encode_all(cleaned_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 52, in encode_all
    encoded_df, metadata = self._encode_dataset(name, df)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 90, in _encode_dataset
    if len(df['label'].unique()) == 1:
           ~~^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'label'
2025-07-20 20:29:22,161 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 20:29:22,161 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 20:29:22,177 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 20:29:22,177 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1     2
Name: count, dtype: int64
2025-07-20 20:29:22,179 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 20:29:22,179 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 20:29:22,179 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 20:29:22,213 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 20:29:22,214 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 20:29:22,215 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 20:29:22,215 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 20:29:22,215 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 20:29:22,226 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 20:29:22,227 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 20:29:22,228 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 20:29:22,231 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 20:29:22,237 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 20:29:22,250 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 20:29:22,250 - __main__ - INFO - Encoding completed successfully!
2025-07-20 20:29:22,250 - __main__ - INFO - 
Encoding Summary:
2025-07-20 20:29:22,250 - __main__ - INFO - 
Dataset: metadata
2025-07-20 20:29:22,250 - __main__ - INFO - Attack type: None
2025-07-20 20:29:22,250 - __main__ - INFO - Label distribution: None
2025-07-20 20:29:22,250 - __main__ - INFO - Original label column: None
2025-07-20 20:29:22,250 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 20:29:22,250 - __main__ - INFO - Attack type: None
2025-07-20 20:29:22,250 - __main__ - INFO - Label distribution: None
2025-07-20 20:29:22,250 - __main__ - INFO - Original label column: None
2025-07-20 20:29:48,995 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-20 20:29:48,997 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 20:29:48,998 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-20 20:29:48,998 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-20 20:29:48,999 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 20:29:48,999 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-20 20:29:48,999 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-20 20:29:49,001 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 20:29:49,001 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-20 20:29:49,001 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-20 20:29:49,024 - __main__ - INFO - Splitting completed successfully!
2025-07-20 20:29:49,024 - __main__ - INFO - 
Splitting Summary:
2025-07-20 20:29:49,024 - __main__ - INFO - 
Dataset: xss
2025-07-20 20:29:49,024 - __main__ - INFO - Split type: train_test
2025-07-20 20:29:49,024 - __main__ - INFO - Train samples: 80
2025-07-20 20:29:49,024 - __main__ - INFO - Test samples: 20
2025-07-20 20:29:49,024 - __main__ - INFO - Train label distribution: {0: 78, 1: 2}
2025-07-20 20:29:49,024 - __main__ - INFO - 
Dataset: sql_injection
2025-07-20 20:29:49,024 - __main__ - INFO - Split type: train_test
2025-07-20 20:29:49,024 - __main__ - INFO - Train samples: 80
2025-07-20 20:29:49,024 - __main__ - INFO - Test samples: 20
2025-07-20 20:29:49,024 - __main__ - INFO - Train label distribution: {0: 66, 1: 14}
2025-07-20 20:29:49,024 - __main__ - INFO - 
Dataset: path_traversal
2025-07-20 20:29:49,024 - __main__ - INFO - Split type: train_test
2025-07-20 20:29:49,024 - __main__ - INFO - Train samples: 80
2025-07-20 20:29:49,024 - __main__ - INFO - Test samples: 20
2025-07-20 20:29:49,024 - __main__ - INFO - Train label distribution: {1: 70, 0: 10}
2025-07-20 20:29:59,638 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 20:29:59,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 20:29:59,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 20:29:59,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 20:29:59,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 20:29:59,648 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 20:29:59,648 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 20:30:02,285 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:30:02,305 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1 confusion_matrix  roc_auc
0       1.0        0.0     0.0  0.0           [[20]]      NaN
2025-07-20 20:30:02,306 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 20:30:02,306 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 20:30:02,306 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 20:30:02,307 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 20:30:02,307 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 20:30:02,307 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 20:30:02,332 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:30:02,339 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       0.8        0.0     0.0  0.0  [[16, 4], [0, 0]]      NaN
2025-07-20 20:30:02,339 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 20:30:02,339 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 20:30:02,339 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 20:30:02,376 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:30:02,383 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1 confusion_matrix  roc_auc
0       1.0        0.0     0.0  0.0           [[20]]      NaN
2025-07-20 20:30:02,383 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 20:30:02,720 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 20:30:02,784 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 20:30:02,849 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 20:30:02,849 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 20:30:02,849 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 20:30:02,849 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 20:30:02,860 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 20:30:02,860 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 20:30:04,626 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:30:04,637 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 20:30:04,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 20:30:04,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 20:30:04,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 20:30:04,638 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 20:30:04,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 20:30:04,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 20:30:04,663 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:30:04,670 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 20:30:04,670 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 20:30:04,670 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 20:30:04,670 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 20:30:04,711 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:30:04,718 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 20:30:04,718 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 20:30:04,782 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 20:30:04,886 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 20:30:04,950 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 20:30:04,950 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 20:30:04,950 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 20:30:04,950 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 20:30:04,967 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 20:30:04,967 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 20:30:06,716 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:30:06,726 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 20:30:06,727 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 20:30:06,727 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 20:30:06,727 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 20:30:06,727 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 20:30:06,727 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 20:30:06,727 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 20:30:06,753 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:30:06,761 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 20:30:06,762 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 20:30:06,762 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 20:30:06,762 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 20:30:06,800 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:30:06,809 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 20:30:06,809 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 20:30:06,874 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 20:30:06,938 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 20:30:07,002 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 20:30:07,002 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 20:30:07,003 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 20:30:07,003 - __main__ - INFO - Model training completed successfully!
2025-07-20 20:30:07,003 - __main__ - INFO - 
Results for xss:
2025-07-20 20:30:07,003 - __main__ - INFO - 
random_forest:
2025-07-20 20:30:07,003 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:30:07,003 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20]], 'roc_auc': nan}
2025-07-20 20:30:07,003 - __main__ - INFO - 
logistic_regression:
2025-07-20 20:30:07,003 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:30:07,003 - __main__ - INFO - Metrics: {'accuracy': 0.8, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[16, 4], [0, 0]], 'roc_auc': nan}
2025-07-20 20:30:07,003 - __main__ - INFO - 
svm:
2025-07-20 20:30:07,003 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:30:07,003 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20]], 'roc_auc': nan}
2025-07-20 20:30:07,003 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 20:30:07,003 - __main__ - INFO - 
random_forest:
2025-07-20 20:30:07,003 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:30:07,003 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 20:30:07,003 - __main__ - INFO - 
logistic_regression:
2025-07-20 20:30:07,003 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:30:07,003 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 20:30:07,003 - __main__ - INFO - 
svm:
2025-07-20 20:30:07,003 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:30:07,003 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 20:30:07,003 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 20:30:07,003 - __main__ - INFO - 
random_forest:
2025-07-20 20:30:07,003 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:30:07,003 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 20:30:07,003 - __main__ - INFO - 
logistic_regression:
2025-07-20 20:30:07,003 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:30:07,003 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 20:30:07,003 - __main__ - INFO - 
svm:
2025-07-20 20:30:07,003 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:30:07,003 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 20:33:41,245 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 20:33:41,246 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 20:33:41,262 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 20:33:41,262 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1     2
Name: count, dtype: int64
2025-07-20 20:33:41,264 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 20:33:41,264 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 20:33:41,264 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 20:33:41,299 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 20:33:41,300 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 20:33:41,301 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 20:33:41,301 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 20:33:41,301 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 20:33:41,312 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 20:33:41,313 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 20:33:41,314 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 20:33:41,317 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 20:33:41,323 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 20:33:41,337 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 20:33:41,337 - __main__ - INFO - Encoding completed successfully!
2025-07-20 20:33:41,337 - __main__ - INFO - 
Encoding Summary:
2025-07-20 20:33:41,337 - __main__ - INFO - 
Dataset: metadata
2025-07-20 20:33:41,337 - __main__ - INFO - Attack type: None
2025-07-20 20:33:41,337 - __main__ - INFO - Label distribution: None
2025-07-20 20:33:41,337 - __main__ - INFO - Original label column: None
2025-07-20 20:33:41,337 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 20:33:41,337 - __main__ - INFO - Attack type: None
2025-07-20 20:33:41,337 - __main__ - INFO - Label distribution: None
2025-07-20 20:33:41,337 - __main__ - INFO - Original label column: None
2025-07-20 20:46:20,032 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 20:46:20,033 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 20:46:20,048 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 20:46:20,049 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1     2
Name: count, dtype: int64
2025-07-20 20:46:20,050 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 20:46:20,050 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 20:46:20,051 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 20:46:20,087 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 20:46:20,088 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 20:46:20,089 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 20:46:20,089 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 20:46:20,089 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 20:46:20,100 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 20:46:20,101 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 20:46:20,102 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 20:46:20,105 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 20:46:20,111 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 20:46:20,125 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 20:46:20,125 - __main__ - INFO - Encoding completed successfully!
2025-07-20 20:46:20,125 - __main__ - INFO - 
Encoding Summary:
2025-07-20 20:46:20,125 - __main__ - INFO - 
Dataset: metadata
2025-07-20 20:46:20,125 - __main__ - INFO - Attack type: None
2025-07-20 20:46:20,126 - __main__ - INFO - Label distribution: None
2025-07-20 20:46:20,126 - __main__ - INFO - Original label column: None
2025-07-20 20:46:20,126 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 20:46:20,126 - __main__ - INFO - Attack type: None
2025-07-20 20:46:20,126 - __main__ - INFO - Label distribution: None
2025-07-20 20:46:20,126 - __main__ - INFO - Original label column: None
2025-07-20 20:46:42,575 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-20 20:46:42,578 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 20:46:42,578 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-20 20:46:42,578 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-20 20:46:42,579 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 20:46:42,579 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-20 20:46:42,579 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-20 20:46:42,581 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 20:46:42,581 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-20 20:46:42,581 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-20 20:46:42,604 - __main__ - INFO - Splitting completed successfully!
2025-07-20 20:46:42,604 - __main__ - INFO - 
Splitting Summary:
2025-07-20 20:46:42,604 - __main__ - INFO - 
Dataset: xss
2025-07-20 20:46:42,604 - __main__ - INFO - Split type: train_test
2025-07-20 20:46:42,604 - __main__ - INFO - Train samples: 80
2025-07-20 20:46:42,604 - __main__ - INFO - Test samples: 20
2025-07-20 20:46:42,604 - __main__ - INFO - Train label distribution: {0: 78, 1: 2}
2025-07-20 20:46:42,604 - __main__ - INFO - 
Dataset: sql_injection
2025-07-20 20:46:42,604 - __main__ - INFO - Split type: train_test
2025-07-20 20:46:42,604 - __main__ - INFO - Train samples: 80
2025-07-20 20:46:42,604 - __main__ - INFO - Test samples: 20
2025-07-20 20:46:42,604 - __main__ - INFO - Train label distribution: {0: 66, 1: 14}
2025-07-20 20:46:42,604 - __main__ - INFO - 
Dataset: path_traversal
2025-07-20 20:46:42,604 - __main__ - INFO - Split type: train_test
2025-07-20 20:46:42,604 - __main__ - INFO - Train samples: 80
2025-07-20 20:46:42,604 - __main__ - INFO - Test samples: 20
2025-07-20 20:46:42,604 - __main__ - INFO - Train label distribution: {1: 70, 0: 10}
2025-07-20 20:47:24,215 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 20:47:24,215 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 20:47:24,215 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 20:47:24,215 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 20:47:24,215 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 20:47:24,225 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 20:47:24,225 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 20:47:25,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:47:25,905 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1 confusion_matrix  roc_auc
0       1.0        0.0     0.0  0.0           [[20]]      NaN
2025-07-20 20:47:25,939 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 20:47:25,939 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 20:47:25,939 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 20:47:25,939 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 20:47:25,939 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 20:47:25,939 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 20:47:25,953 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:47:25,960 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       0.8        0.0     0.0  0.0  [[16, 4], [0, 0]]      NaN
2025-07-20 20:47:25,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 20:47:25,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 20:47:25,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 20:47:25,986 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:47:25,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1 confusion_matrix  roc_auc
0       1.0        0.0     0.0  0.0           [[20]]      NaN
2025-07-20 20:47:25,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 20:47:26,295 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 20:47:26,363 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 20:47:26,427 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 20:47:26,427 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 20:47:26,427 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 20:47:26,427 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 20:47:26,437 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 20:47:26,437 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 20:47:27,203 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:47:27,213 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 20:47:27,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 20:47:27,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 20:47:27,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 20:47:27,214 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 20:47:27,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 20:47:27,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 20:47:27,227 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:47:27,234 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 20:47:27,235 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 20:47:27,235 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 20:47:27,235 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 20:47:27,260 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:47:27,270 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 20:47:27,270 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 20:47:27,333 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 20:47:27,443 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 20:47:27,504 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 20:47:27,504 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 20:47:27,504 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 20:47:27,505 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 20:47:27,528 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 20:47:27,528 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 20:47:28,326 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:47:28,336 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 20:47:28,337 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 20:47:28,337 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 20:47:28,337 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 20:47:28,337 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 20:47:28,337 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 20:47:28,337 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 20:47:28,362 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:47:28,369 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 20:47:28,369 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 20:47:28,369 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 20:47:28,369 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 20:47:28,389 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:47:28,396 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 20:47:28,397 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 20:47:28,461 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 20:47:28,527 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 20:47:28,591 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 20:47:28,591 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 20:47:28,591 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 20:47:28,591 - __main__ - INFO - Model training completed successfully!
2025-07-20 20:47:28,591 - __main__ - INFO - 
Results for xss:
2025-07-20 20:47:28,591 - __main__ - INFO - 
random_forest:
2025-07-20 20:47:28,591 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:47:28,591 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20]], 'roc_auc': nan}
2025-07-20 20:47:28,591 - __main__ - INFO - 
logistic_regression:
2025-07-20 20:47:28,591 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:47:28,591 - __main__ - INFO - Metrics: {'accuracy': 0.8, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[16, 4], [0, 0]], 'roc_auc': nan}
2025-07-20 20:47:28,591 - __main__ - INFO - 
svm:
2025-07-20 20:47:28,591 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:47:28,591 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20]], 'roc_auc': nan}
2025-07-20 20:47:28,591 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 20:47:28,591 - __main__ - INFO - 
random_forest:
2025-07-20 20:47:28,591 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:47:28,591 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 20:47:28,591 - __main__ - INFO - 
logistic_regression:
2025-07-20 20:47:28,591 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:47:28,591 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 20:47:28,591 - __main__ - INFO - 
svm:
2025-07-20 20:47:28,591 - __main__ - INFO - Best params: {'C': 1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:47:28,591 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 20:47:28,591 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 20:47:28,591 - __main__ - INFO - 
random_forest:
2025-07-20 20:47:28,591 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 20:47:28,592 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 20:47:28,592 - __main__ - INFO - 
logistic_regression:
2025-07-20 20:47:28,592 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 20:47:28,592 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 20:47:28,592 - __main__ - INFO - 
svm:
2025-07-20 20:47:28,592 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 20:47:28,592 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 21:05:57,028 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 21:05:57,028 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 21:05:57,044 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 21:05:57,044 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1     2
Name: count, dtype: int64
2025-07-20 21:05:57,046 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 21:05:57,046 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 21:05:57,046 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 21:05:57,080 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 21:05:57,080 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 21:05:57,082 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 21:05:57,082 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 21:05:57,082 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 21:05:57,093 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 21:05:57,093 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 21:05:57,094 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 21:05:57,097 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 21:05:57,103 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 21:05:57,117 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 21:05:57,117 - __main__ - INFO - Encoding completed successfully!
2025-07-20 21:05:57,117 - __main__ - INFO - 
Encoding Summary:
2025-07-20 21:05:57,117 - __main__ - INFO - 
Dataset: metadata
2025-07-20 21:05:57,117 - __main__ - INFO - Attack type: None
2025-07-20 21:05:57,117 - __main__ - INFO - Label distribution: None
2025-07-20 21:05:57,117 - __main__ - INFO - Original label column: None
2025-07-20 21:05:57,117 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 21:05:57,117 - __main__ - INFO - Attack type: None
2025-07-20 21:05:57,117 - __main__ - INFO - Label distribution: None
2025-07-20 21:05:57,117 - __main__ - INFO - Original label column: None
2025-07-20 21:18:42,278 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 21:18:42,278 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 21:18:42,298 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 21:18:42,298 - src.hybrid_threat_detection.features.encoding - WARNING - Only 2 XSS samples found - augmenting with top candidates
2025-07-20 21:18:42,316 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    95
1     5
Name: count, dtype: int64
2025-07-20 21:18:42,318 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 21:18:42,318 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 21:18:42,318 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 21:18:42,352 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 21:18:42,353 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 21:18:42,354 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 21:18:42,354 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 21:18:42,354 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 21:18:42,365 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 21:18:42,366 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 21:18:42,367 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 21:18:42,370 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 21:18:42,375 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 21:18:42,389 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 21:18:42,389 - __main__ - INFO - Encoding completed successfully!
2025-07-20 21:18:42,389 - __main__ - INFO - 
Encoding Summary:
2025-07-20 21:18:42,389 - __main__ - INFO - 
Dataset: metadata
2025-07-20 21:18:42,389 - __main__ - INFO - Attack type: None
2025-07-20 21:18:42,389 - __main__ - INFO - Label distribution: None
2025-07-20 21:18:42,389 - __main__ - INFO - Original label column: None
2025-07-20 21:18:42,389 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 21:18:42,389 - __main__ - INFO - Attack type: None
2025-07-20 21:18:42,389 - __main__ - INFO - Label distribution: None
2025-07-20 21:18:42,389 - __main__ - INFO - Original label column: None
2025-07-20 21:20:12,119 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 21:20:12,120 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 21:20:12,120 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:20:12,120 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 21:20:12,120 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:20:12,130 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 21:20:12,130 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:20:13,814 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:13,826 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1 confusion_matrix  roc_auc
0       1.0        0.0     0.0  0.0           [[20]]      NaN
2025-07-20 21:20:13,857 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 21:20:13,857 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 21:20:13,857 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:20:13,858 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:20:13,858 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 21:20:13,858 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:20:13,872 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:13,879 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       0.8        0.0     0.0  0.0  [[16, 4], [0, 0]]      NaN
2025-07-20 21:20:13,879 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 21:20:13,879 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 21:20:13,879 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:20:13,905 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:13,912 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1 confusion_matrix  roc_auc
0       1.0        0.0     0.0  0.0           [[20]]      NaN
2025-07-20 21:20:13,913 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 21:20:14,199 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 21:20:14,266 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 21:20:14,330 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 21:20:14,330 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:20:14,330 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 21:20:14,330 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:20:14,340 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 21:20:14,340 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:20:15,082 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:15,092 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:20:15,093 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 21:20:15,093 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 21:20:15,093 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:20:15,093 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:20:15,093 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 21:20:15,093 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:20:15,107 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:15,114 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:20:15,114 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 21:20:15,114 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 21:20:15,114 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:20:15,140 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:15,148 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:20:15,148 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 21:20:15,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 21:20:15,322 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 21:20:15,385 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 21:20:15,385 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:20:15,385 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 21:20:15,385 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:20:15,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 21:20:15,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:20:16,178 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:16,188 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 21:20:16,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 21:20:16,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 21:20:16,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:20:16,189 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:20:16,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 21:20:16,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:20:16,202 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:16,209 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 21:20:16,209 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 21:20:16,209 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 21:20:16,210 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:20:16,235 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:16,242 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 21:20:16,242 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 21:20:16,309 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 21:20:16,373 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 21:20:16,436 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 21:20:16,437 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 21:20:16,437 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 21:20:16,437 - __main__ - INFO - Model training completed successfully!
2025-07-20 21:20:16,437 - __main__ - INFO - 
Results for xss:
2025-07-20 21:20:16,437 - __main__ - INFO - 
random_forest:
2025-07-20 21:20:16,437 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:16,437 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20]], 'roc_auc': nan}
2025-07-20 21:20:16,437 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:20:16,437 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:16,437 - __main__ - INFO - Metrics: {'accuracy': 0.8, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[16, 4], [0, 0]], 'roc_auc': nan}
2025-07-20 21:20:16,437 - __main__ - INFO - 
svm:
2025-07-20 21:20:16,437 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:16,437 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20]], 'roc_auc': nan}
2025-07-20 21:20:16,437 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 21:20:16,437 - __main__ - INFO - 
random_forest:
2025-07-20 21:20:16,437 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:16,437 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:20:16,437 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:20:16,437 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:16,437 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:20:16,437 - __main__ - INFO - 
svm:
2025-07-20 21:20:16,437 - __main__ - INFO - Best params: {'C': 1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:16,437 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:20:16,437 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 21:20:16,437 - __main__ - INFO - 
random_forest:
2025-07-20 21:20:16,437 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:16,437 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 21:20:16,437 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:20:16,437 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:16,437 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 21:20:16,437 - __main__ - INFO - 
svm:
2025-07-20 21:20:16,437 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:16,438 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 21:20:37,557 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-20 21:20:37,560 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 21:20:37,560 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-20 21:20:37,560 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-20 21:20:37,561 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 21:20:37,561 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-20 21:20:37,561 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-20 21:20:37,563 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 21:20:37,563 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-20 21:20:37,563 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-20 21:20:37,587 - __main__ - INFO - Splitting completed successfully!
2025-07-20 21:20:37,587 - __main__ - INFO - 
Splitting Summary:
2025-07-20 21:20:37,587 - __main__ - INFO - 
Dataset: xss
2025-07-20 21:20:37,587 - __main__ - INFO - Split type: train_test
2025-07-20 21:20:37,587 - __main__ - INFO - Train samples: 80
2025-07-20 21:20:37,587 - __main__ - INFO - Test samples: 20
2025-07-20 21:20:37,587 - __main__ - INFO - Train label distribution: {0: 76, 1: 4}
2025-07-20 21:20:37,587 - __main__ - INFO - 
Dataset: sql_injection
2025-07-20 21:20:37,587 - __main__ - INFO - Split type: train_test
2025-07-20 21:20:37,587 - __main__ - INFO - Train samples: 80
2025-07-20 21:20:37,587 - __main__ - INFO - Test samples: 20
2025-07-20 21:20:37,587 - __main__ - INFO - Train label distribution: {0: 66, 1: 14}
2025-07-20 21:20:37,587 - __main__ - INFO - 
Dataset: path_traversal
2025-07-20 21:20:37,587 - __main__ - INFO - Split type: train_test
2025-07-20 21:20:37,587 - __main__ - INFO - Train samples: 80
2025-07-20 21:20:37,587 - __main__ - INFO - Test samples: 20
2025-07-20 21:20:37,587 - __main__ - INFO - Train label distribution: {1: 70, 0: 10}
2025-07-20 21:20:51,214 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 21:20:51,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 21:20:51,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:20:51,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 21:20:51,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:20:51,224 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 21:20:51,224 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:20:52,914 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:52,926 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0      0.95        0.0     0.0  0.0  [[19, 0], [1, 0]]  0.263158
2025-07-20 21:20:52,954 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 21:20:52,954 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 21:20:52,954 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:20:52,954 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:20:52,954 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 21:20:52,954 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:20:52,968 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:52,975 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix  roc_auc
0      0.75   0.166667     1.0  0.285714  [[14, 5], [0, 1]]      1.0
2025-07-20 21:20:52,975 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 21:20:52,975 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 21:20:52,976 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:20:53,002 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:53,009 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0      0.95        0.0     0.0  0.0  [[19, 0], [1, 0]]      1.0
2025-07-20 21:20:53,010 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 21:20:53,291 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 21:20:53,358 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 21:20:53,420 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 21:20:53,420 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:20:53,420 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 21:20:53,420 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:20:53,430 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 21:20:53,431 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:20:54,203 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:54,213 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:20:54,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 21:20:54,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 21:20:54,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:20:54,215 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:20:54,215 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 21:20:54,215 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:20:54,228 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:54,235 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:20:54,236 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 21:20:54,236 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 21:20:54,236 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:20:54,261 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:54,268 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:20:54,269 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 21:20:54,333 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 21:20:54,440 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 21:20:54,503 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 21:20:54,503 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:20:54,503 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 21:20:54,503 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:20:54,521 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 21:20:54,521 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:20:55,299 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:55,308 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 21:20:55,309 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 21:20:55,309 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 21:20:55,309 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:20:55,310 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:20:55,310 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 21:20:55,310 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:20:55,336 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:55,342 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 21:20:55,343 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 21:20:55,343 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 21:20:55,343 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:20:55,362 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:55,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 21:20:55,369 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 21:20:55,431 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 21:20:55,496 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 21:20:55,560 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 21:20:55,560 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 21:20:55,560 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 21:20:55,560 - __main__ - INFO - Model training completed successfully!
2025-07-20 21:20:55,560 - __main__ - INFO - 
Results for xss:
2025-07-20 21:20:55,560 - __main__ - INFO - 
random_forest:
2025-07-20 21:20:55,560 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:55,560 - __main__ - INFO - Metrics: {'accuracy': 0.95, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[19, 0], [1, 0]], 'roc_auc': 0.26315789473684215}
2025-07-20 21:20:55,560 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:20:55,560 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:55,560 - __main__ - INFO - Metrics: {'accuracy': 0.75, 'precision': 0.16666666666666666, 'recall': 1.0, 'f1': 0.2857142857142857, 'confusion_matrix': [[14, 5], [0, 1]], 'roc_auc': 1.0}
2025-07-20 21:20:55,560 - __main__ - INFO - 
svm:
2025-07-20 21:20:55,560 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:55,560 - __main__ - INFO - Metrics: {'accuracy': 0.95, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[19, 0], [1, 0]], 'roc_auc': 1.0}
2025-07-20 21:20:55,560 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 21:20:55,560 - __main__ - INFO - 
random_forest:
2025-07-20 21:20:55,560 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:55,560 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:20:55,560 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:20:55,560 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:55,560 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:20:55,560 - __main__ - INFO - 
svm:
2025-07-20 21:20:55,560 - __main__ - INFO - Best params: {'C': 1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:55,560 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:20:55,561 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 21:20:55,561 - __main__ - INFO - 
random_forest:
2025-07-20 21:20:55,561 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:20:55,561 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 21:20:55,561 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:20:55,561 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:20:55,561 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 21:20:55,561 - __main__ - INFO - 
svm:
2025-07-20 21:20:55,561 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:20:55,561 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 21:22:05,162 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 21:22:05,163 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 21:22:05,181 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 21:22:05,181 - src.hybrid_threat_detection.features.encoding - WARNING - Only 2 XSS samples found - augmenting with top candidates
2025-07-20 21:22:05,198 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    95
1     5
Name: count, dtype: int64
2025-07-20 21:22:05,199 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 21:22:05,200 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 21:22:05,200 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 21:22:05,232 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 21:22:05,233 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 21:22:05,234 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 21:22:05,234 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 21:22:05,234 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 21:22:05,245 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 21:22:05,245 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 21:22:05,246 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 21:22:05,249 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 21:22:05,255 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 21:22:05,268 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 21:22:05,268 - __main__ - INFO - Encoding completed successfully!
2025-07-20 21:22:05,268 - __main__ - INFO - 
Encoding Summary:
2025-07-20 21:22:05,268 - __main__ - INFO - 
Dataset: metadata
2025-07-20 21:22:05,268 - __main__ - INFO - Attack type: None
2025-07-20 21:22:05,268 - __main__ - INFO - Label distribution: None
2025-07-20 21:22:05,268 - __main__ - INFO - Original label column: None
2025-07-20 21:22:05,268 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 21:22:05,268 - __main__ - INFO - Attack type: None
2025-07-20 21:22:05,268 - __main__ - INFO - Label distribution: None
2025-07-20 21:22:05,268 - __main__ - INFO - Original label column: None
2025-07-20 21:22:12,696 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-20 21:22:12,698 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 21:22:12,698 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-20 21:22:12,698 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-20 21:22:12,699 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 21:22:12,699 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-20 21:22:12,699 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-20 21:22:12,701 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 21:22:12,701 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-20 21:22:12,701 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-20 21:22:12,724 - __main__ - INFO - Splitting completed successfully!
2025-07-20 21:22:12,725 - __main__ - INFO - 
Splitting Summary:
2025-07-20 21:22:12,725 - __main__ - INFO - 
Dataset: xss
2025-07-20 21:22:12,725 - __main__ - INFO - Split type: train_test
2025-07-20 21:22:12,725 - __main__ - INFO - Train samples: 80
2025-07-20 21:22:12,725 - __main__ - INFO - Test samples: 20
2025-07-20 21:22:12,725 - __main__ - INFO - Train label distribution: {0: 76, 1: 4}
2025-07-20 21:22:12,725 - __main__ - INFO - 
Dataset: sql_injection
2025-07-20 21:22:12,725 - __main__ - INFO - Split type: train_test
2025-07-20 21:22:12,725 - __main__ - INFO - Train samples: 80
2025-07-20 21:22:12,725 - __main__ - INFO - Test samples: 20
2025-07-20 21:22:12,725 - __main__ - INFO - Train label distribution: {0: 66, 1: 14}
2025-07-20 21:22:12,725 - __main__ - INFO - 
Dataset: path_traversal
2025-07-20 21:22:12,725 - __main__ - INFO - Split type: train_test
2025-07-20 21:22:12,725 - __main__ - INFO - Train samples: 80
2025-07-20 21:22:12,725 - __main__ - INFO - Test samples: 20
2025-07-20 21:22:12,725 - __main__ - INFO - Train label distribution: {1: 70, 0: 10}
2025-07-20 21:22:26,883 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 21:22:26,883 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 21:22:26,883 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:22:26,883 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 21:22:26,883 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:22:26,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 21:22:26,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:22:29,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:22:29,617 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0      0.95        0.0     0.0  0.0  [[19, 0], [1, 0]]      1.0
2025-07-20 21:22:29,618 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 21:22:29,618 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 21:22:29,618 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:22:29,619 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:22:29,619 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 21:22:29,619 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:22:29,646 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:22:29,656 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix  roc_auc
0      0.75   0.166667     1.0  0.285714  [[14, 5], [0, 1]]      1.0
2025-07-20 21:22:29,656 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 21:22:29,656 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 21:22:29,656 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:22:29,693 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:22:29,701 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0      0.95        0.0     0.0  0.0  [[19, 0], [1, 0]]      1.0
2025-07-20 21:22:29,701 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 21:22:29,994 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 21:22:30,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 21:22:30,131 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 21:22:30,131 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:22:30,131 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 21:22:30,131 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:22:30,142 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 21:22:30,142 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:22:31,896 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:22:31,906 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:22:31,907 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 21:22:31,907 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 21:22:31,908 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:22:31,908 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:22:31,908 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 21:22:31,908 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:22:31,936 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:22:31,943 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:22:31,943 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 21:22:31,943 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 21:22:31,943 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:22:31,981 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:22:31,988 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:22:31,989 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 21:22:32,054 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 21:22:32,160 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 21:22:32,223 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 21:22:32,224 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:22:32,224 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 21:22:32,224 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:22:32,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 21:22:32,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:22:33,986 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:22:33,996 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 21:22:33,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 21:22:33,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 21:22:33,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:22:33,998 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:22:33,998 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 21:22:33,998 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:22:34,024 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:22:34,035 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 21:22:34,035 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 21:22:34,035 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 21:22:34,036 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:22:34,077 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:22:34,084 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 21:22:34,084 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 21:22:34,153 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 21:22:34,218 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 21:22:34,282 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 21:22:34,282 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 21:22:34,282 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 21:22:34,282 - __main__ - INFO - Model training completed successfully!
2025-07-20 21:22:34,282 - __main__ - INFO - 
Results for xss:
2025-07-20 21:22:34,282 - __main__ - INFO - 
random_forest:
2025-07-20 21:22:34,282 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:22:34,282 - __main__ - INFO - Metrics: {'accuracy': 0.95, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[19, 0], [1, 0]], 'roc_auc': 1.0}
2025-07-20 21:22:34,282 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:22:34,282 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:22:34,282 - __main__ - INFO - Metrics: {'accuracy': 0.75, 'precision': 0.16666666666666666, 'recall': 1.0, 'f1': 0.2857142857142857, 'confusion_matrix': [[14, 5], [0, 1]], 'roc_auc': 1.0}
2025-07-20 21:22:34,282 - __main__ - INFO - 
svm:
2025-07-20 21:22:34,282 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:22:34,282 - __main__ - INFO - Metrics: {'accuracy': 0.95, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[19, 0], [1, 0]], 'roc_auc': 1.0}
2025-07-20 21:22:34,282 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 21:22:34,282 - __main__ - INFO - 
random_forest:
2025-07-20 21:22:34,282 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:22:34,282 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:22:34,282 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:22:34,282 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:22:34,283 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:22:34,283 - __main__ - INFO - 
svm:
2025-07-20 21:22:34,283 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:22:34,283 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:22:34,283 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 21:22:34,283 - __main__ - INFO - 
random_forest:
2025-07-20 21:22:34,283 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 21:22:34,283 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 21:22:34,283 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:22:34,283 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 21:22:34,283 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 21:22:34,283 - __main__ - INFO - 
svm:
2025-07-20 21:22:34,283 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 21:22:34,283 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 21:29:02,463 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 21:29:02,464 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 21:29:02,483 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 21:29:02,483 - src.hybrid_threat_detection.features.encoding - WARNING - Only 2 XSS samples found - augmenting with top 8 candidates
2025-07-20 21:29:02,502 - src.hybrid_threat_detection.features.encoding - INFO - After augmentation: 15 malicious samples
2025-07-20 21:29:02,502 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1    15
Name: count, dtype: int64
2025-07-20 21:29:02,503 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 21:29:02,503 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 21:29:02,504 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 21:29:02,537 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 21:29:02,538 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 21:29:02,539 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 21:29:02,539 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 21:29:02,539 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 21:29:02,550 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 21:29:02,551 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 21:29:02,552 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 21:29:02,555 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 21:29:02,561 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 21:29:02,574 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 21:29:02,574 - __main__ - INFO - Encoding completed successfully!
2025-07-20 21:29:02,574 - __main__ - INFO - 
Encoding Summary:
2025-07-20 21:29:02,574 - __main__ - INFO - 
Dataset: metadata
2025-07-20 21:29:02,574 - __main__ - INFO - Attack type: None
2025-07-20 21:29:02,574 - __main__ - INFO - Label distribution: None
2025-07-20 21:29:02,574 - __main__ - INFO - Original label column: None
2025-07-20 21:29:02,574 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 21:29:02,574 - __main__ - INFO - Attack type: None
2025-07-20 21:29:02,574 - __main__ - INFO - Label distribution: None
2025-07-20 21:29:02,574 - __main__ - INFO - Original label column: None
2025-07-20 21:39:10,090 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 21:39:10,090 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 21:39:10,109 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 21:39:10,109 - src.hybrid_threat_detection.features.encoding - WARNING - Only 2 XSS samples found - augmenting with top 8 candidates
2025-07-20 21:39:10,128 - src.hybrid_threat_detection.features.encoding - INFO - After augmentation: 15 malicious samples
2025-07-20 21:39:10,128 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1    15
Name: count, dtype: int64
2025-07-20 21:39:10,130 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 21:39:10,130 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 21:39:10,130 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 21:39:10,162 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 21:39:10,163 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 21:39:10,164 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 21:39:10,164 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 21:39:10,164 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 21:39:10,175 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 21:39:10,175 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 21:39:10,177 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 21:39:10,180 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 21:39:10,186 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 21:39:10,199 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 21:39:10,199 - __main__ - INFO - Encoding completed successfully!
2025-07-20 21:39:10,199 - __main__ - INFO - 
Encoding Summary:
2025-07-20 21:39:10,199 - __main__ - INFO - 
Dataset: metadata
2025-07-20 21:39:10,199 - __main__ - INFO - Attack type: None
2025-07-20 21:39:10,199 - __main__ - INFO - Label distribution: None
2025-07-20 21:39:10,199 - __main__ - INFO - Original label column: None
2025-07-20 21:39:10,199 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 21:39:10,199 - __main__ - INFO - Attack type: None
2025-07-20 21:39:10,199 - __main__ - INFO - Label distribution: None
2025-07-20 21:39:10,199 - __main__ - INFO - Original label column: None
2025-07-20 21:39:16,285 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-20 21:39:16,287 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 90, Test: 23
2025-07-20 21:39:16,287 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-20 21:39:16,287 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-20 21:39:16,288 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 21:39:16,288 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-20 21:39:16,288 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-20 21:39:16,290 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 21:39:16,290 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-20 21:39:16,290 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-20 21:39:16,313 - __main__ - INFO - Splitting completed successfully!
2025-07-20 21:39:16,313 - __main__ - INFO - 
Splitting Summary:
2025-07-20 21:39:16,313 - __main__ - INFO - 
Dataset: xss
2025-07-20 21:39:16,313 - __main__ - INFO - Split type: train_test
2025-07-20 21:39:16,313 - __main__ - INFO - Train samples: 90
2025-07-20 21:39:16,313 - __main__ - INFO - Test samples: 23
2025-07-20 21:39:16,313 - __main__ - INFO - Train label distribution: {0: 78, 1: 12}
2025-07-20 21:39:16,313 - __main__ - INFO - 
Dataset: sql_injection
2025-07-20 21:39:16,313 - __main__ - INFO - Split type: train_test
2025-07-20 21:39:16,313 - __main__ - INFO - Train samples: 80
2025-07-20 21:39:16,313 - __main__ - INFO - Test samples: 20
2025-07-20 21:39:16,313 - __main__ - INFO - Train label distribution: {0: 66, 1: 14}
2025-07-20 21:39:16,313 - __main__ - INFO - 
Dataset: path_traversal
2025-07-20 21:39:16,313 - __main__ - INFO - Split type: train_test
2025-07-20 21:39:16,313 - __main__ - INFO - Train samples: 80
2025-07-20 21:39:16,313 - __main__ - INFO - Test samples: 20
2025-07-20 21:39:16,313 - __main__ - INFO - Train label distribution: {1: 70, 0: 10}
2025-07-20 21:40:02,653 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 21:40:02,653 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 21:40:02,653 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:40:02,653 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 21:40:02,653 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:40:02,662 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 21:40:02,662 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:40:05,610 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 21:40:05,622 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 21:40:05,624 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 21:40:05,624 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 21:40:05,624 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:40:13,387 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'classifier__learning_rate': 0.01, 'classifier__max_depth': 3, 'classifier__n_estimators': 50}
2025-07-20 21:40:13,401 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:40:13,401 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 21:40:13,402 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:40:13,461 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'classifier__C': 10, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 21:40:13,493 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.956522        1.0  0.666667  0.8  [[20, 0], [1, 2]]  0.866667
2025-07-20 21:40:13,493 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 21:40:13,493 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 21:40:13,494 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:40:13,575 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'classifier__C': 10, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 21:40:13,585 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix  roc_auc
0  0.956522        1.0  0.666667  0.8  [[20, 0], [1, 2]]      0.8
2025-07-20 21:40:13,585 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 21:40:13,920 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 21:40:13,986 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 21:40:14,050 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 21:40:14,051 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:40:14,051 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 21:40:14,051 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:40:14,061 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 21:40:14,061 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:40:15,812 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 21:40:15,822 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:40:15,823 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 21:40:15,823 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 21:40:15,823 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:40:21,071 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'classifier__learning_rate': 0.01, 'classifier__max_depth': 3, 'classifier__n_estimators': 50}
2025-07-20 21:40:21,086 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:40:21,087 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 21:40:21,087 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:40:21,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'classifier__C': 0.1, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 21:40:21,169 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:40:21,170 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 21:40:21,174 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 21:40:21,174 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:40:21,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'classifier__C': 0.1, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 21:40:21,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 21:40:21,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 21:40:21,312 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 21:40:21,376 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 21:40:21,440 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 21:40:21,440 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 21:40:21,440 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 21:40:21,440 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 21:40:21,456 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 21:40:21,456 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 21:40:23,236 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 21:40:23,246 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 21:40:23,247 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 21:40:23,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 21:40:23,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 21:40:28,498 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'classifier__learning_rate': 0.01, 'classifier__max_depth': 3, 'classifier__n_estimators': 50}
2025-07-20 21:40:28,516 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 21:40:28,516 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 21:40:28,516 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 21:40:28,563 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'classifier__C': 0.1, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 21:40:28,590 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 21:40:28,595 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 21:40:28,595 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 21:40:28,595 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 21:40:28,672 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'classifier__C': 0.1, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 21:40:28,679 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.382353
2025-07-20 21:40:28,680 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 21:40:28,747 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 21:40:28,813 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 21:40:28,875 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 21:40:28,876 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 21:40:28,876 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 21:40:28,876 - __main__ - INFO - Model training completed successfully!
2025-07-20 21:40:28,876 - __main__ - INFO - 
Results for xss:
2025-07-20 21:40:28,876 - __main__ - INFO - 
random_forest:
2025-07-20 21:40:28,876 - __main__ - INFO - Best params: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 21:40:28,876 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 21:40:28,876 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:40:28,876 - __main__ - INFO - Best params: {'classifier__C': 10, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 21:40:28,876 - __main__ - INFO - Metrics: {'accuracy': 0.9565217391304348, 'precision': 1.0, 'recall': 0.6666666666666666, 'f1': 0.8, 'confusion_matrix': [[20, 0], [1, 2]], 'roc_auc': 0.8666666666666666}
2025-07-20 21:40:28,876 - __main__ - INFO - 
svm:
2025-07-20 21:40:28,876 - __main__ - INFO - Best params: {'classifier__C': 10, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 21:40:28,876 - __main__ - INFO - Metrics: {'accuracy': 0.9565217391304348, 'precision': 1.0, 'recall': 0.6666666666666666, 'f1': 0.8, 'confusion_matrix': [[20, 0], [1, 2]], 'roc_auc': 0.7999999999999999}
2025-07-20 21:40:28,876 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 21:40:28,876 - __main__ - INFO - 
random_forest:
2025-07-20 21:40:28,876 - __main__ - INFO - Best params: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 21:40:28,876 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:40:28,876 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:40:28,876 - __main__ - INFO - Best params: {'classifier__C': 0.1, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 21:40:28,876 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:40:28,876 - __main__ - INFO - 
svm:
2025-07-20 21:40:28,876 - __main__ - INFO - Best params: {'classifier__C': 0.1, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 21:40:28,876 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 21:40:28,876 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 21:40:28,876 - __main__ - INFO - 
random_forest:
2025-07-20 21:40:28,876 - __main__ - INFO - Best params: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 21:40:28,876 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 21:40:28,876 - __main__ - INFO - 
logistic_regression:
2025-07-20 21:40:28,876 - __main__ - INFO - Best params: {'classifier__C': 0.1, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 21:40:28,876 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 21:40:28,876 - __main__ - INFO - 
svm:
2025-07-20 21:40:28,876 - __main__ - INFO - Best params: {'classifier__C': 0.1, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 21:40:28,876 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.3823529411764706}
2025-07-20 21:43:00,658 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 21:43:00,659 - __main__ - ERROR - Model training failed: name 'make_scorer' is not defined
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_model_training.py", line 13, in main
    trainer = SupervisedModelTrainer(
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 43, in __init__
    self.config = self._load_config(config_path)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 82, in _load_config
    "scoring": make_scorer(f1_score, average='binary', pos_label=1, zero_division=0),
               ^^^^^^^^^^^
NameError: name 'make_scorer' is not defined
2025-07-20 21:58:20,283 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 21:58:20,283 - __main__ - ERROR - Model training failed: name 'make_scorer' is not defined
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_model_training.py", line 13, in main
    trainer = SupervisedModelTrainer(
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 43, in __init__
    self.config = self._load_config(config_path)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 83, in _load_config
    "scoring": make_scorer(f1_score, average='binary', pos_label=1, zero_division=0),
               ^^^^^^^^^^^
NameError: name 'make_scorer' is not defined
2025-07-20 22:03:59,756 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:03:59,756 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:03:59,756 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:03:59,756 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:03:59,756 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:03:59,766 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:03:59,766 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model random_forest failed on xss: name 'SMOTE' is not defined
2025-07-20 22:03:59,766 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:03:59,767 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: name 'SMOTE' is not defined
2025-07-20 22:03:59,767 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:03:59,767 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model logistic_regression failed on xss: name 'SMOTE' is not defined
2025-07-20 22:03:59,767 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:03:59,767 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model svm failed on xss: name 'SMOTE' is not defined
2025-07-20 22:03:59,979 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:03:59,979 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:03:59,979 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:03:59,989 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:03:59,989 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model random_forest failed on sql_injection: name 'SMOTE' is not defined
2025-07-20 22:03:59,989 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:03:59,989 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: name 'SMOTE' is not defined
2025-07-20 22:03:59,990 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:03:59,990 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model logistic_regression failed on sql_injection: name 'SMOTE' is not defined
2025-07-20 22:03:59,990 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:03:59,990 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model svm failed on sql_injection: name 'SMOTE' is not defined
2025-07-20 22:03:59,990 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:03:59,990 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:03:59,990 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model random_forest failed on path_traversal: name 'SMOTE' is not defined
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: name 'SMOTE' is not defined
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model logistic_regression failed on path_traversal: name 'SMOTE' is not defined
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model svm failed on path_traversal: name 'SMOTE' is not defined
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:04:00,004 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:04:00,004 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:04:00,004 - __main__ - INFO - 
Results for xss:
2025-07-20 22:04:00,004 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:04:00,004 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:14:34,039 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 22:14:34,039 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 22:14:34,058 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 22:14:34,059 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1     2
Name: count, dtype: int64
2025-07-20 22:14:34,061 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 22:14:34,061 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 22:14:34,061 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 22:14:34,096 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 22:14:34,096 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 22:14:34,097 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 22:14:34,098 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 22:14:34,098 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 22:14:34,109 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 22:14:34,109 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 22:14:34,111 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 22:14:34,114 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 22:14:34,120 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 22:14:34,133 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 22:14:34,133 - __main__ - INFO - Encoding completed successfully!
2025-07-20 22:14:34,133 - __main__ - INFO - 
Encoding Summary:
2025-07-20 22:14:34,133 - __main__ - INFO - 
Dataset: metadata
2025-07-20 22:14:34,133 - __main__ - INFO - Attack type: None
2025-07-20 22:14:34,133 - __main__ - INFO - Label distribution: None
2025-07-20 22:14:34,133 - __main__ - INFO - Original label column: None
2025-07-20 22:14:34,133 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 22:14:34,133 - __main__ - INFO - Attack type: None
2025-07-20 22:14:34,133 - __main__ - INFO - Label distribution: None
2025-07-20 22:14:34,133 - __main__ - INFO - Original label column: None
2025-07-20 22:18:51,144 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 22:18:51,144 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 22:18:51,163 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 22:18:51,164 - src.hybrid_threat_detection.features.encoding - WARNING - Only 2 XSS samples found - augmenting with top 8 candidates
2025-07-20 22:18:51,182 - src.hybrid_threat_detection.features.encoding - INFO - After augmentation: 15 malicious samples
2025-07-20 22:18:51,184 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 22:18:51,184 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 22:18:51,184 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 22:18:51,218 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 22:18:51,219 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 22:18:51,220 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 22:18:51,220 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 22:18:51,231 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 22:18:51,232 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 22:18:51,235 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 22:18:51,241 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 22:18:51,254 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 22:18:51,254 - __main__ - INFO - Encoding completed successfully!
2025-07-20 22:18:51,254 - __main__ - INFO - 
Encoding Summary:
2025-07-20 22:18:51,254 - __main__ - INFO - 
Dataset: metadata
2025-07-20 22:18:51,254 - __main__ - INFO - Attack type: None
2025-07-20 22:18:51,254 - __main__ - INFO - Label distribution: None
2025-07-20 22:18:51,254 - __main__ - INFO - Original label column: None
2025-07-20 22:18:51,254 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 22:18:51,254 - __main__ - INFO - Attack type: None
2025-07-20 22:18:51,254 - __main__ - INFO - Label distribution: None
2025-07-20 22:18:51,254 - __main__ - INFO - Original label column: None
2025-07-20 22:19:54,097 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 22:19:54,097 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 22:19:54,116 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 22:19:54,116 - src.hybrid_threat_detection.features.encoding - WARNING - Only 2 XSS samples found - augmenting with top 8 candidates
2025-07-20 22:19:54,135 - src.hybrid_threat_detection.features.encoding - INFO - After augmentation: 15 malicious samples
2025-07-20 22:19:54,136 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1    15
Name: count, dtype: int64
2025-07-20 22:19:54,137 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 22:19:54,137 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 22:19:54,138 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 22:19:54,172 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 22:19:54,172 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 22:19:54,173 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 22:19:54,173 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 22:19:54,174 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 22:19:54,185 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 22:19:54,186 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 22:19:54,187 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 22:19:54,190 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 22:19:54,196 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 22:19:54,209 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 22:19:54,209 - __main__ - INFO - Encoding completed successfully!
2025-07-20 22:19:54,209 - __main__ - INFO - 
Encoding Summary:
2025-07-20 22:19:54,209 - __main__ - INFO - 
Dataset: metadata
2025-07-20 22:19:54,209 - __main__ - INFO - Attack type: None
2025-07-20 22:19:54,209 - __main__ - INFO - Label distribution: None
2025-07-20 22:19:54,209 - __main__ - INFO - Original label column: None
2025-07-20 22:19:54,209 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 22:19:54,209 - __main__ - INFO - Attack type: None
2025-07-20 22:19:54,209 - __main__ - INFO - Label distribution: None
2025-07-20 22:19:54,209 - __main__ - INFO - Original label column: None
2025-07-20 22:21:51,605 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-20 22:21:51,606 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-20 22:21:51,624 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-20 22:21:51,625 - src.hybrid_threat_detection.features.encoding - WARNING - Only 2 XSS samples found - augmenting with top 8 candidates
2025-07-20 22:21:51,643 - src.hybrid_threat_detection.features.encoding - INFO - After augmentation: 15 malicious samples
2025-07-20 22:21:51,644 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1    15
Name: count, dtype: int64
2025-07-20 22:21:51,645 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-20 22:21:51,645 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-20 22:21:51,646 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-20 22:21:51,680 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-20 22:21:51,680 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-20 22:21:51,682 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-20 22:21:51,682 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-20 22:21:51,682 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-20 22:21:51,693 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-20 22:21:51,693 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-20 22:21:51,695 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-20 22:21:51,698 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-20 22:21:51,704 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-20 22:21:51,717 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-20 22:21:51,717 - __main__ - INFO - Encoding completed successfully!
2025-07-20 22:21:51,717 - __main__ - INFO - 
Encoding Summary:
2025-07-20 22:21:51,717 - __main__ - INFO - 
Dataset: metadata
2025-07-20 22:21:51,717 - __main__ - INFO - Attack type: None
2025-07-20 22:21:51,717 - __main__ - INFO - Label distribution: None
2025-07-20 22:21:51,717 - __main__ - INFO - Original label column: None
2025-07-20 22:21:51,717 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-20 22:21:51,717 - __main__ - INFO - Attack type: None
2025-07-20 22:21:51,717 - __main__ - INFO - Label distribution: None
2025-07-20 22:21:51,717 - __main__ - INFO - Original label column: None
2025-07-20 22:22:09,115 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-20 22:22:09,117 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 90, Test: 23
2025-07-20 22:22:09,117 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-20 22:22:09,117 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-20 22:22:09,119 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 22:22:09,119 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-20 22:22:09,119 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-20 22:22:09,120 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-20 22:22:09,120 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-20 22:22:09,120 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-20 22:22:09,146 - __main__ - INFO - Splitting completed successfully!
2025-07-20 22:22:09,146 - __main__ - INFO - 
Splitting Summary:
2025-07-20 22:22:09,146 - __main__ - INFO - 
Dataset: xss
2025-07-20 22:22:09,146 - __main__ - INFO - Split type: train_test
2025-07-20 22:22:09,146 - __main__ - INFO - Train samples: 90
2025-07-20 22:22:09,146 - __main__ - INFO - Test samples: 23
2025-07-20 22:22:09,146 - __main__ - INFO - Train label distribution: {0: 78, 1: 12}
2025-07-20 22:22:09,146 - __main__ - INFO - 
Dataset: sql_injection
2025-07-20 22:22:09,146 - __main__ - INFO - Split type: train_test
2025-07-20 22:22:09,146 - __main__ - INFO - Train samples: 80
2025-07-20 22:22:09,146 - __main__ - INFO - Test samples: 20
2025-07-20 22:22:09,146 - __main__ - INFO - Train label distribution: {0: 66, 1: 14}
2025-07-20 22:22:09,146 - __main__ - INFO - 
Dataset: path_traversal
2025-07-20 22:22:09,146 - __main__ - INFO - Split type: train_test
2025-07-20 22:22:09,146 - __main__ - INFO - Train samples: 80
2025-07-20 22:22:09,146 - __main__ - INFO - Test samples: 20
2025-07-20 22:22:09,146 - __main__ - INFO - Train label distribution: {1: 70, 0: 10}
2025-07-20 22:22:54,163 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:22:54,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:22:54,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:22:54,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:22:54,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:22:54,172 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:22:54,172 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:22:57,164 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 22:22:57,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 22:22:57,178 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:22:57,178 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:22:57,178 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:23:04,958 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'classifier__learning_rate': 0.01, 'classifier__max_depth': 3, 'classifier__n_estimators': 50}
2025-07-20 22:23:04,976 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 22:23:04,976 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:23:04,977 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:23:05,036 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'classifier__C': 10, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 22:23:05,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.956522        1.0  0.666667  0.8  [[20, 0], [1, 2]]  0.866667
2025-07-20 22:23:05,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:23:05,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:23:05,068 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:23:05,142 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'classifier__C': 10, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 22:23:05,152 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix  roc_auc
0  0.956522        1.0  0.666667  0.8  [[20, 0], [1, 2]]      0.8
2025-07-20 22:23:05,152 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:23:05,484 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:23:05,552 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:23:05,614 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:23:05,614 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:23:05,614 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:23:05,614 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:23:05,625 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:23:05,625 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:23:07,436 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 22:23:07,447 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:23:07,448 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:23:07,448 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:23:07,448 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:23:12,687 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'classifier__learning_rate': 0.01, 'classifier__max_depth': 3, 'classifier__n_estimators': 50}
2025-07-20 22:23:12,703 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 22:23:12,703 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:23:12,703 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:23:12,741 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'classifier__C': 0.1, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 22:23:12,757 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:23:12,758 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:23:12,759 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:23:12,759 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:23:12,866 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'classifier__C': 0.1, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 22:23:12,874 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:23:12,874 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:23:12,942 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:23:13,008 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:23:13,073 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:23:13,073 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:23:13,073 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:23:13,073 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:23:13,090 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:23:13,090 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:23:14,891 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 22:23:14,901 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 22:23:14,902 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:23:14,902 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:23:14,902 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:23:20,159 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'classifier__learning_rate': 0.01, 'classifier__max_depth': 3, 'classifier__n_estimators': 50}
2025-07-20 22:23:20,173 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 22:23:20,173 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:23:20,174 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:23:20,241 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'classifier__C': 0.1, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 22:23:20,271 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 22:23:20,272 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:23:20,272 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:23:20,272 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:23:20,338 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'classifier__C': 0.1, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 22:23:20,348 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.382353
2025-07-20 22:23:20,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:23:20,415 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:23:20,482 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:23:20,546 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:23:20,547 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:23:20,547 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:23:20,547 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:23:20,547 - __main__ - INFO - 
Results for xss:
2025-07-20 22:23:20,547 - __main__ - INFO - 
random_forest:
2025-07-20 22:23:20,547 - __main__ - INFO - Best params: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 22:23:20,547 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:23:20,547 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:23:20,547 - __main__ - INFO - Best params: {'classifier__C': 10, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 22:23:20,547 - __main__ - INFO - Metrics: {'accuracy': 0.9565217391304348, 'precision': 1.0, 'recall': 0.6666666666666666, 'f1': 0.8, 'confusion_matrix': [[20, 0], [1, 2]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:23:20,547 - __main__ - INFO - 
svm:
2025-07-20 22:23:20,547 - __main__ - INFO - Best params: {'classifier__C': 10, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 22:23:20,547 - __main__ - INFO - Metrics: {'accuracy': 0.9565217391304348, 'precision': 1.0, 'recall': 0.6666666666666666, 'f1': 0.8, 'confusion_matrix': [[20, 0], [1, 2]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:23:20,547 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:23:20,547 - __main__ - INFO - 
random_forest:
2025-07-20 22:23:20,547 - __main__ - INFO - Best params: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 22:23:20,547 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:23:20,547 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:23:20,547 - __main__ - INFO - Best params: {'classifier__C': 0.1, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 22:23:20,547 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:23:20,547 - __main__ - INFO - 
svm:
2025-07-20 22:23:20,547 - __main__ - INFO - Best params: {'classifier__C': 0.1, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 22:23:20,547 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:23:20,547 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:23:20,547 - __main__ - INFO - 
random_forest:
2025-07-20 22:23:20,547 - __main__ - INFO - Best params: {'classifier__max_depth': None, 'classifier__min_samples_split': 2, 'classifier__n_estimators': 50}
2025-07-20 22:23:20,547 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:23:20,547 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:23:20,547 - __main__ - INFO - Best params: {'classifier__C': 0.1, 'classifier__class_weight': 'balanced', 'classifier__max_iter': 1000, 'classifier__penalty': 'l2', 'classifier__solver': 'lbfgs'}
2025-07-20 22:23:20,547 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:23:20,547 - __main__ - INFO - 
svm:
2025-07-20 22:23:20,547 - __main__ - INFO - Best params: {'classifier__C': 0.1, 'classifier__gamma': 'scale', 'classifier__kernel': 'linear'}
2025-07-20 22:23:20,547 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.3823529411764706}
2025-07-20 22:23:44,794 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:23:44,794 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:23:44,794 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:23:44,794 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:23:44,794 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:23:44,804 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:23:44,804 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:23:47,542 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:23:47,554 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 22:23:47,555 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:23:47,555 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:23:47,555 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:23:47,555 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 22:23:47,555 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:23:47,555 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:23:47,584 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:23:47,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 22:23:47,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:23:47,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:23:47,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:23:47,629 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:23:47,638 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 22:23:47,639 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:23:47,949 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:23:48,012 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:23:48,075 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:23:48,075 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:23:48,075 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:23:48,075 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:23:48,086 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:23:48,086 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:23:49,829 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:23:49,839 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:23:49,840 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:23:49,840 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:23:49,840 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:23:49,840 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 22:23:49,840 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:23:49,841 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:23:49,866 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:23:49,873 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:23:49,873 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:23:49,873 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:23:49,873 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:23:49,914 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:23:49,921 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:23:49,921 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:23:49,990 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:23:50,097 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:23:50,158 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:23:50,159 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:23:50,159 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:23:50,159 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:23:50,175 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:23:50,175 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:23:51,926 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:23:51,935 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 22:23:51,936 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:23:51,936 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:23:51,937 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:23:51,937 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 22:23:51,937 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:23:51,937 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:23:51,962 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:23:51,973 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 22:23:51,973 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:23:51,973 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:23:51,973 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:23:52,014 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:23:52,021 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 22:23:52,021 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:23:52,094 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:23:52,169 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:23:52,234 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:23:52,235 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:23:52,235 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:23:52,235 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:23:52,235 - __main__ - INFO - 
Results for xss:
2025-07-20 22:23:52,235 - __main__ - INFO - 
random_forest:
2025-07-20 22:23:52,235 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:23:52,235 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:23:52,235 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:23:52,235 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:23:52,235 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 22:23:52,235 - __main__ - INFO - 
svm:
2025-07-20 22:23:52,235 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:23:52,235 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:23:52,235 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:23:52,235 - __main__ - INFO - 
random_forest:
2025-07-20 22:23:52,235 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:23:52,235 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:23:52,235 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:23:52,235 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:23:52,235 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:23:52,235 - __main__ - INFO - 
svm:
2025-07-20 22:23:52,235 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:23:52,235 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:23:52,235 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:23:52,235 - __main__ - INFO - 
random_forest:
2025-07-20 22:23:52,235 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:23:52,235 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:23:52,235 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:23:52,235 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:23:52,235 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:23:52,235 - __main__ - INFO - 
svm:
2025-07-20 22:23:52,236 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:23:52,236 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 22:28:20,189 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:28:20,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:28:20,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:28:20,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:28:20,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:28:20,199 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:28:20,199 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:28:22,932 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:28:22,943 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 22:28:22,945 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:28:22,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:28:22,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:28:32,040 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: [22:28:31] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x788feaaa6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x788feb3862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x788fead65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x788fea9b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x7890586a6052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x7890586a4925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x7890586a506e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x7890586b6c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x7890586b5c44]


2025-07-20 22:28:32,040 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:28:32,040 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:28:32,076 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:28:32,110 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 22:28:32,110 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:28:32,110 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:28:32,110 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:28:32,672 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:28:32,680 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 22:28:32,680 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:28:32,970 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:28:33,037 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:28:33,100 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:28:33,100 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:28:33,100 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:28:33,100 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:28:33,111 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:28:33,111 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:28:34,870 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:28:34,880 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:28:34,881 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:28:34,882 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:28:34,882 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:28:40,551 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: [22:28:39] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x788feaaa6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x788feb3862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x788fead65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x788fea9b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x7890586a6052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x7890586a4925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x7890586a506e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x7890586b6c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x7890586b5c44]


2025-07-20 22:28:40,551 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:28:40,551 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:28:40,584 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:28:40,599 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:28:40,600 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:28:40,600 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:28:40,600 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:28:41,043 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:28:41,052 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:28:41,053 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:28:41,117 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:28:41,219 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:28:41,282 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:28:41,282 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:28:41,282 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:28:41,282 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:28:41,298 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:28:41,298 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:28:43,055 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:28:43,065 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 22:28:43,066 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:28:43,066 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:28:43,066 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:28:48,348 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: [22:28:47] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x788feaaa6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x788feb3862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x788fead65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x788fea9b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x7890586a6052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x7890586a4925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x7890586a506e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x7890586b6c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x7890586b5c44]


2025-07-20 22:28:48,348 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:28:48,348 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:28:48,384 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:28:48,411 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 22:28:48,416 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:28:48,416 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:28:48,416 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:28:48,936 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:28:48,944 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 22:28:48,944 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:28:49,009 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:28:49,075 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:28:49,138 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:28:49,139 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:28:49,139 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:28:49,139 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:28:49,139 - __main__ - INFO - 
Results for xss:
2025-07-20 22:28:49,139 - __main__ - INFO - 
random_forest:
2025-07-20 22:28:49,139 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:28:49,139 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:28:49,139 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:28:49,139 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:28:49,139 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 22:28:49,139 - __main__ - INFO - 
svm:
2025-07-20 22:28:49,139 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:28:49,139 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:28:49,139 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:28:49,139 - __main__ - INFO - 
random_forest:
2025-07-20 22:28:49,139 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:28:49,139 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:28:49,139 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:28:49,139 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:28:49,139 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:28:49,139 - __main__ - INFO - 
svm:
2025-07-20 22:28:49,139 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:28:49,139 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:28:49,139 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:28:49,139 - __main__ - INFO - 
random_forest:
2025-07-20 22:28:49,139 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:28:49,139 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:28:49,139 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:28:49,139 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:28:49,139 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:28:49,139 - __main__ - INFO - 
svm:
2025-07-20 22:28:49,139 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:28:49,139 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 22:32:45,676 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:32:45,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:32:45,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:32:45,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:32:45,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:32:45,686 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:32:45,687 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:32:48,425 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:32:48,438 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 22:32:48,440 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:32:48,440 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:32:48,440 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:32:56,928 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: [22:32:56] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x76bc3aaa6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x76bc3b3862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x76bc3ad65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x76bc3a9b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x76bca66f9052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x76bca66f7925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x76bca66f806e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x76bca888fc88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x76bca888ec44]


2025-07-20 22:32:56,928 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:32:56,928 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:32:56,963 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:32:56,994 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 22:32:56,999 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:32:56,999 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:32:56,999 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:32:57,561 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:32:57,568 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 22:32:57,569 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:32:57,854 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:32:57,921 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:32:57,985 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:32:57,985 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:32:57,985 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:32:57,985 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:32:57,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:32:57,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:32:59,746 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:32:59,756 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:32:59,757 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:32:59,757 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:32:59,757 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:33:05,718 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: [22:33:04] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x76bc3aaa6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x76bc3b3862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x76bc3ad65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x76bc3a9b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x76bca66f9052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x76bca66f7925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x76bca66f806e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x76bca888fc88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x76bca888ec44]


2025-07-20 22:33:05,718 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:33:05,718 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:33:05,752 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:33:05,779 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:33:05,784 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:33:05,784 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:33:05,784 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:33:06,296 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:33:06,307 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:33:06,307 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:33:06,413 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:33:06,477 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:33:06,544 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:33:06,544 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:33:06,544 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:33:06,544 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:33:06,561 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:33:06,561 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:33:08,316 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:33:08,326 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 22:33:08,327 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:33:08,327 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:33:08,327 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:33:14,040 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: [22:33:13] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x76bc3aaa6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x76bc3b3862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x76bc3ad65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x76bc3a9b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x76bca66f9052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x76bca66f7925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x76bca66f806e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x76bca888fc88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x76bca888ec44]


2025-07-20 22:33:14,040 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:33:14,040 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:33:14,068 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:33:14,080 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 22:33:14,081 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:33:14,081 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:33:14,081 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:33:14,514 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:33:14,522 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 22:33:14,522 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:33:14,589 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:33:14,655 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:33:14,718 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:33:14,719 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:33:14,719 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:33:14,719 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:33:14,719 - __main__ - INFO - 
Results for xss:
2025-07-20 22:33:14,719 - __main__ - INFO - 
random_forest:
2025-07-20 22:33:14,719 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:33:14,719 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:33:14,719 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:33:14,719 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:33:14,719 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 22:33:14,719 - __main__ - INFO - 
svm:
2025-07-20 22:33:14,719 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:33:14,719 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:33:14,719 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:33:14,719 - __main__ - INFO - 
random_forest:
2025-07-20 22:33:14,719 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:33:14,719 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:33:14,719 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:33:14,719 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:33:14,719 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:33:14,719 - __main__ - INFO - 
svm:
2025-07-20 22:33:14,719 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:33:14,719 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:33:14,719 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:33:14,719 - __main__ - INFO - 
random_forest:
2025-07-20 22:33:14,719 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:33:14,719 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:33:14,719 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:33:14,719 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:33:14,719 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:33:14,719 - __main__ - INFO - 
svm:
2025-07-20 22:33:14,719 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:33:14,719 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 22:35:26,592 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:35:26,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:35:26,593 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:35:26,593 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:35:26,593 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:35:26,602 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:35:26,602 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:35:29,303 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:35:29,316 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  ...   confusion_matrix   roc_auc
0  0.869565        0.0  ...  [[20, 0], [3, 0]]  0.866667

[1 rows x 6 columns]
2025-07-20 22:35:29,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:35:29,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:35:29,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:35:38,577 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: [22:35:37] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x7c6f52aa6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x7c6f533862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x7c6f52d65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x7c6f529b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x7c6fc06a6052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x7c6fc06a4925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x7c6fc06a506e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x7c6fc06b6c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x7c6fc06b5c44]


2025-07-20 22:35:38,577 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:35:38,577 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:35:38,626 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:35:38,652 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  ...   confusion_matrix   roc_auc
0  0.217391   0.058824  ...  [[4, 16], [2, 1]]  0.333333

[1 rows x 6 columns]
2025-07-20 22:35:38,653 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:35:38,653 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:35:38,653 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:35:39,180 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:35:39,188 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  ...   confusion_matrix  roc_auc
0  0.869565        0.0  ...  [[20, 0], [3, 0]]      0.8

[1 rows x 6 columns]
2025-07-20 22:35:39,188 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:35:39,475 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:35:39,541 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:35:39,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:35:39,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:35:39,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:35:39,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:35:39,617 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:35:39,617 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:35:41,331 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:35:41,341 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  ...   confusion_matrix  roc_auc
0       1.0        1.0  ...  [[16, 0], [0, 4]]      1.0

[1 rows x 6 columns]
2025-07-20 22:35:41,342 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:35:41,342 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:35:41,342 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:35:46,899 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: [22:35:46] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x7c6f52aa6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x7c6f533862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x7c6f52d65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x7c6f529b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x7c6fc06a6052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x7c6fc06a4925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x7c6fc06a506e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x7c6fc06b6c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x7c6fc06b5c44]


2025-07-20 22:35:46,899 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:35:46,899 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:35:46,937 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:35:46,968 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  ...   confusion_matrix  roc_auc
0       1.0        1.0  ...  [[16, 0], [0, 4]]      1.0

[1 rows x 6 columns]
2025-07-20 22:35:46,968 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:35:46,968 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:35:46,968 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:35:47,502 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:35:47,510 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  ...   confusion_matrix  roc_auc
0       1.0        1.0  ...  [[16, 0], [0, 4]]      1.0

[1 rows x 6 columns]
2025-07-20 22:35:47,510 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:35:47,575 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:35:47,679 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:35:47,742 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:35:47,742 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:35:47,742 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:35:47,742 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:35:47,758 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:35:47,759 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:35:49,518 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:35:49,528 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  ...   confusion_matrix   roc_auc
0      0.85       0.85  ...  [[0, 3], [0, 17]]  0.735294

[1 rows x 6 columns]
2025-07-20 22:35:49,529 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:35:49,529 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:35:49,529 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:35:55,201 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: [22:35:54] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x7c6f52aa6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x7c6f533862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x7c6f52d65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x7c6f529b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x7c6fc06a6052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x7c6fc06a4925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x7c6fc06a506e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x7c6fc06b6c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x7c6fc06b5c44]


2025-07-20 22:35:55,201 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:35:55,201 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:35:55,234 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:35:55,249 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  ...  confusion_matrix   roc_auc
0      0.55        1.0  ...  [[3, 0], [9, 8]]  0.735294

[1 rows x 6 columns]
2025-07-20 22:35:55,250 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:35:55,250 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:35:55,250 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:35:55,794 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:35:55,802 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  ...   confusion_matrix   roc_auc
0      0.85       0.85  ...  [[0, 3], [0, 17]]  0.558824

[1 rows x 6 columns]
2025-07-20 22:35:55,802 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:35:55,867 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:35:55,933 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:35:55,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:35:55,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:35:55,997 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:35:55,997 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:35:55,997 - __main__ - INFO - 
Results for xss:
2025-07-20 22:35:55,997 - __main__ - INFO - 
random_forest:
2025-07-20 22:35:55,997 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:35:55,997 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:35:55,997 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:35:55,998 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:35:55,998 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 22:35:55,998 - __main__ - INFO - 
svm:
2025-07-20 22:35:55,998 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:35:55,998 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:35:55,998 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:35:55,998 - __main__ - INFO - 
random_forest:
2025-07-20 22:35:55,998 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:35:55,998 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:35:55,998 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:35:55,998 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:35:55,998 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:35:55,998 - __main__ - INFO - 
svm:
2025-07-20 22:35:55,998 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:35:55,998 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:35:55,998 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:35:55,998 - __main__ - INFO - 
random_forest:
2025-07-20 22:35:55,998 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:35:55,998 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:35:55,998 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:35:55,998 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:35:55,998 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:35:55,998 - __main__ - INFO - 
svm:
2025-07-20 22:35:55,998 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:35:55,998 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 22:42:16,124 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:42:16,124 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:42:16,125 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:42:16,125 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:42:16,125 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:42:16,135 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:42:16,135 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:42:18,844 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:42:18,856 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 22:42:18,859 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:42:18,859 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:42:18,859 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:42:27,666 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: [22:42:26] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x76ec07ea6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x76ec087862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x76ec08165ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x76ec07db3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x76ec758d9052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x76ec758d7925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x76ec758d806e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x76ec758e9c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x76ec758e8c44]


2025-07-20 22:42:27,666 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:42:27,666 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:42:27,705 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:42:27,736 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 22:42:27,736 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:42:27,736 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:42:27,737 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:42:28,174 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:42:28,181 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 22:42:28,181 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:42:28,464 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:42:28,531 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:42:28,594 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:42:28,594 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:42:28,594 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:42:28,594 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:42:28,604 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:42:28,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:42:30,353 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:42:30,363 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:42:30,364 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:42:30,364 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:42:30,364 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:42:35,931 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: [22:42:35] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x76ec07ea6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x76ec087862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x76ec08165ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x76ec07db3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x76ec758d9052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x76ec758d7925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x76ec758d806e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x76ec758e9c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x76ec758e8c44]


2025-07-20 22:42:35,931 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:42:35,931 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:42:35,965 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:42:35,994 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:42:35,995 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:42:35,995 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:42:35,995 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:42:36,513 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:42:36,521 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:42:36,521 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:42:36,629 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:42:36,692 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:42:36,761 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:42:36,761 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:42:36,762 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:42:36,762 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:42:36,779 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:42:36,779 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:42:38,537 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:42:38,547 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 22:42:38,549 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:42:38,549 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:42:38,549 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:42:43,900 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: [22:42:42] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x76ec07ea6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x76ec087862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x76ec08165ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x76ec07db3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x76ec758d9052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x76ec758d7925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x76ec758d806e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x76ec758e9c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x76ec758e8c44]


2025-07-20 22:42:43,900 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:42:43,900 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:42:43,938 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:42:43,965 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 22:42:43,966 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:42:43,966 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:42:43,966 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:42:44,415 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:42:44,422 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 22:42:44,423 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:42:44,488 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:42:44,552 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:42:44,615 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:42:44,615 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:42:44,615 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:42:44,615 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:42:44,615 - __main__ - INFO - 
Results for xss:
2025-07-20 22:42:44,616 - __main__ - INFO - 
random_forest:
2025-07-20 22:42:44,616 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:42:44,616 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:42:44,616 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:42:44,616 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:42:44,616 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 22:42:44,616 - __main__ - INFO - 
svm:
2025-07-20 22:42:44,616 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:42:44,616 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:42:44,616 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:42:44,616 - __main__ - INFO - 
random_forest:
2025-07-20 22:42:44,616 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:42:44,616 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:42:44,616 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:42:44,616 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:42:44,616 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:42:44,616 - __main__ - INFO - 
svm:
2025-07-20 22:42:44,616 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:42:44,616 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:42:44,616 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:42:44,616 - __main__ - INFO - 
random_forest:
2025-07-20 22:42:44,616 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:42:44,616 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:42:44,616 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:42:44,616 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:42:44,616 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:42:44,616 - __main__ - INFO - 
svm:
2025-07-20 22:42:44,616 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:42:44,616 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 22:45:03,650 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:45:03,650 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:45:03,650 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:45:03,650 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:45:03,650 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:45:03,660 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:45:03,661 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:45:06,397 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:45:06,409 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 22:45:06,437 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:45:06,438 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:45:06,438 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:45:15,436 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: [22:45:14] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x72ef320a6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x72ef329862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x72ef32365ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x72ef31fb3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x72efa0541052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x72efa053f925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x72efa054006e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x72efa0551c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x72efa0550c44]


2025-07-20 22:45:15,436 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:45:15,436 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:45:15,483 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:45:15,513 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 22:45:15,513 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:45:15,514 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:45:15,514 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:45:16,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:45:16,074 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 22:45:16,075 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:45:16,372 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:45:16,439 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:45:16,502 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:45:16,503 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:45:16,503 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:45:16,503 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:45:16,513 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:45:16,513 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:45:18,244 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:45:18,254 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:45:18,255 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:45:18,255 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:45:18,255 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:45:24,423 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: [22:45:23] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x72ef320a6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x72ef329862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x72ef32365ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x72ef31fb3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x72efa0541052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x72efa053f925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x72efa054006e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x72efa0551c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x72efa0550c44]


2025-07-20 22:45:24,423 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:45:24,423 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:45:24,459 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:45:24,487 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:45:24,488 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:45:24,488 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:45:24,488 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:45:25,037 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:45:25,048 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:45:25,048 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:45:25,162 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:45:25,226 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:45:25,289 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:45:25,289 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:45:25,289 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:45:25,289 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:45:25,304 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:45:25,304 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:45:27,096 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:45:27,105 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 22:45:27,107 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:45:27,107 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:45:27,107 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:45:32,768 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: [22:45:31] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x72ef320a6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x72ef329862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x72ef32365ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x72ef31fb3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x72efa0541052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x72efa053f925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x72efa054006e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x72efa0551c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x72efa0550c44]


2025-07-20 22:45:32,768 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:45:32,768 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:45:32,802 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:45:32,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 22:45:32,834 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:45:32,834 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:45:32,834 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:45:33,401 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:45:33,410 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 22:45:33,410 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:45:33,474 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:45:33,539 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:45:33,603 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:45:33,603 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:45:33,603 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:45:33,604 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:45:33,604 - __main__ - INFO - 
Results for xss:
2025-07-20 22:45:33,604 - __main__ - INFO - 
random_forest:
2025-07-20 22:45:33,604 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:45:33,604 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:45:33,604 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:45:33,604 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:45:33,604 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 22:45:33,604 - __main__ - INFO - 
svm:
2025-07-20 22:45:33,604 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:45:33,604 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:45:33,604 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:45:33,604 - __main__ - INFO - 
random_forest:
2025-07-20 22:45:33,604 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:45:33,604 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:45:33,604 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:45:33,604 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:45:33,604 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:45:33,604 - __main__ - INFO - 
svm:
2025-07-20 22:45:33,604 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:45:33,604 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:45:33,604 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:45:33,604 - __main__ - INFO - 
random_forest:
2025-07-20 22:45:33,604 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:45:33,604 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:45:33,604 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:45:33,604 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:45:33,604 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:45:33,604 - __main__ - INFO - 
svm:
2025-07-20 22:45:33,604 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:45:33,604 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 22:47:27,210 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:47:27,210 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:47:27,210 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:47:27,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:47:27,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:47:27,221 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:47:27,221 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:47:29,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:47:29,959 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 22:47:29,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:47:29,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:47:29,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:47:38,543 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: [22:47:37] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x765130ca6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x7651315862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x765130f65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x765130bb3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x76519e8f9052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x76519e8f7925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x76519e8f806e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x76519f0e9c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x76519f0e8c44]


2025-07-20 22:47:38,543 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:47:38,543 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:47:38,584 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:47:38,611 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 22:47:38,616 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:47:38,616 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:47:38,616 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:47:39,169 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:47:39,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 22:47:39,177 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:47:39,463 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:47:39,530 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:47:39,594 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:47:39,595 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:47:39,595 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:47:39,595 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:47:39,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:47:39,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:47:41,327 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:47:41,336 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:47:41,337 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:47:41,338 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:47:41,338 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:47:47,098 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: [22:47:46] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x765130ca6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x7651315862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x765130f65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x765130bb3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x76519e8f9052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x76519e8f7925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x76519e8f806e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x76519f0e9c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x76519f0e8c44]


2025-07-20 22:47:47,098 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:47:47,098 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:47:47,136 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:47:47,166 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:47:47,167 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:47:47,167 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:47:47,167 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:47:47,721 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:47:47,730 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:47:47,730 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:47:47,836 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:47:47,899 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:47:47,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:47:47,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:47:47,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:47:47,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:47:47,976 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:47:47,976 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:47:49,753 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:47:49,764 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 22:47:49,765 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:47:49,765 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:47:49,765 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:48:02,952 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: [22:48:02] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x765130ca6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x7651315862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x765130f65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x765130bb3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x76519e8f9052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x76519e8f7925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x76519e8f806e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x76519f0e9c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x76519f0e8c44]


2025-07-20 22:48:02,953 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:48:02,953 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:48:02,987 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:48:03,020 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 22:48:03,024 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:48:03,025 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:48:03,025 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:48:03,073 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:48:03,080 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 22:48:03,080 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:48:03,146 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:48:03,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:48:03,276 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:48:03,276 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:48:03,276 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:48:03,276 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:48:03,276 - __main__ - INFO - 
Results for xss:
2025-07-20 22:48:03,276 - __main__ - INFO - 
random_forest:
2025-07-20 22:48:03,276 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:48:03,276 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:48:03,276 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:48:03,276 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:48:03,276 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 22:48:03,276 - __main__ - INFO - 
svm:
2025-07-20 22:48:03,276 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:48:03,276 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:48:03,276 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:48:03,277 - __main__ - INFO - 
random_forest:
2025-07-20 22:48:03,277 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:48:03,277 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:48:03,277 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:48:03,277 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:48:03,277 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:48:03,277 - __main__ - INFO - 
svm:
2025-07-20 22:48:03,277 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:48:03,277 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:48:03,277 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:48:03,277 - __main__ - INFO - 
random_forest:
2025-07-20 22:48:03,277 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:48:03,277 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:48:03,277 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:48:03,277 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:48:03,277 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:48:03,277 - __main__ - INFO - 
svm:
2025-07-20 22:48:03,277 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:48:03,277 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 22:53:35,403 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:53:35,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:53:35,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:53:35,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:53:35,404 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:53:35,414 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:53:35,414 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:53:38,177 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:53:38,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 22:53:38,191 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:53:38,191 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:53:38,191 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:53:44,488 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: [22:53:44] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x7a5d8d8a6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x7a5d8e1862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x7a5d8db65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x7a5d8d7b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x7a5dfb495052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x7a5dfb493925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x7a5dfb49406e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x7a5df93e9c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x7a5df93e8c44]


2025-07-20 22:53:44,931 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:53:44,931 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:53:44,976 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:53:45,009 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 22:53:45,010 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:53:45,010 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:53:45,010 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:53:45,060 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:53:45,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 22:53:45,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:53:45,358 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:53:45,425 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:53:45,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:53:45,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:53:45,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:53:45,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:53:45,500 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:53:45,500 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:53:47,237 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:53:47,247 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:53:47,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:53:47,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:53:47,249 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:53:50,866 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: [22:53:50] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x7a5d8d8a6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x7a5d8e1862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x7a5d8db65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x7a5d8d7b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x7a5dfb495052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x7a5dfb493925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x7a5dfb49406e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x7a5df93e9c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x7a5df93e8c44]


2025-07-20 22:53:51,325 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:53:51,325 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:53:51,359 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:53:51,391 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:53:51,391 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:53:51,391 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:53:51,391 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:53:51,453 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:53:51,461 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:53:51,461 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:53:51,526 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:53:51,632 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:53:51,696 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:53:51,696 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:53:51,696 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:53:51,696 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:53:51,712 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:53:51,712 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:53:53,432 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:53:53,442 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 22:53:53,443 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:53:53,443 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:53:53,443 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:53:57,036 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: [22:53:56] /workspace/src/data/array_interface.cu:44: Check failed: err == cudaGetLastError() (0 vs. 2) : 
Stack trace:
  [bt] (0) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x2a6ecc) [0x7a5d8d8a6ecc]
  [bt] (1) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0xb862dc) [0x7a5d8e1862dc]
  [bt] (2) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(+0x565ece) [0x7a5d8db65ece]
  [bt] (3) /home/jupyter5/.local/lib/python3.12/site-packages/xgboost/lib/libxgboost.so(XGDMatrixSetInfoFromInterface+0x10b) [0x7a5d8d7b3e5b]
  [bt] (4) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0xa052) [0x7a5dfb495052]
  [bt] (5) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(+0x8925) [0x7a5dfb493925]
  [bt] (6) /opt/miniconda3/lib/python3.12/lib-dynload/../../libffi.so.8(ffi_call+0xde) [0x7a5dfb49406e]
  [bt] (7) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x9c88) [0x7a5df93e9c88]
  [bt] (8) /opt/miniconda3/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x8c44) [0x7a5df93e8c44]


2025-07-20 22:53:57,501 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:53:57,501 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:53:57,536 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:53:57,563 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 22:53:57,567 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:53:57,568 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:53:57,568 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:53:57,631 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:53:57,639 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 22:53:57,639 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:53:57,704 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:53:57,769 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:53:57,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:53:57,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:53:57,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:53:57,833 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:53:57,833 - __main__ - INFO - 
Results for xss:
2025-07-20 22:53:57,833 - __main__ - INFO - 
random_forest:
2025-07-20 22:53:57,833 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:53:57,833 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:53:57,833 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:53:57,833 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:53:57,833 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 22:53:57,834 - __main__ - INFO - 
svm:
2025-07-20 22:53:57,834 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:53:57,834 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:53:57,834 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:53:57,834 - __main__ - INFO - 
random_forest:
2025-07-20 22:53:57,834 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:53:57,834 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:53:57,834 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:53:57,834 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:53:57,834 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:53:57,834 - __main__ - INFO - 
svm:
2025-07-20 22:53:57,834 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:53:57,834 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:53:57,834 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:53:57,834 - __main__ - INFO - 
random_forest:
2025-07-20 22:53:57,834 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:53:57,834 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:53:57,834 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:53:57,834 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:53:57,834 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:53:57,834 - __main__ - INFO - 
svm:
2025-07-20 22:53:57,834 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:53:57,834 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 22:56:51,202 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:56:51,203 - __main__ - ERROR - Model training failed: Expecting property name enclosed in double quotes: line 14 column 9 (char 409)
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_model_training.py", line 13, in main
    trainer = SupervisedModelTrainer(
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 43, in __init__
    self.config = self._load_config(config_path)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/models/supervised_trainer.py", line 88, in _load_config
    config = json.load(f)
             ^^^^^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/__init__.py", line 293, in load
    return loads(fp.read(),
           ^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/decoder.py", line 338, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/lib/python3.12/json/decoder.py", line 354, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 14 column 9 (char 409)
2025-07-20 22:57:36,965 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 22:57:36,965 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 22:57:36,965 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:57:36,965 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 22:57:36,965 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:57:36,975 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 22:57:36,976 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:57:39,724 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:57:39,736 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 22:57:39,737 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 22:57:39,737 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 22:57:39,737 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:57:39,738 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 22:57:39,738 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 22:57:39,738 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:57:39,767 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:57:39,774 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 22:57:39,774 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 22:57:39,774 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 22:57:39,774 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:57:39,814 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:57:39,821 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 22:57:39,822 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 22:57:40,110 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 22:57:40,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 22:57:40,239 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 22:57:40,239 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:57:40,239 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 22:57:40,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:57:40,250 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 22:57:40,250 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:57:41,975 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:57:41,985 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:57:41,986 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 22:57:41,986 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 22:57:41,986 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:57:41,987 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 22:57:41,987 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 22:57:41,987 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:57:42,012 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:57:42,019 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:57:42,019 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 22:57:42,019 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 22:57:42,019 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:57:42,060 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:57:42,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 22:57:42,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 22:57:42,137 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 22:57:42,238 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 22:57:42,301 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 22:57:42,301 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 22:57:42,301 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 22:57:42,301 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 22:57:42,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 22:57:42,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 22:57:44,067 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:57:44,077 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 22:57:44,078 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 22:57:44,078 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 22:57:44,078 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 22:57:44,078 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 22:57:44,079 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 22:57:44,079 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 22:57:44,104 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:57:44,112 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 22:57:44,112 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 22:57:44,112 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 22:57:44,112 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 22:57:44,150 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:57:44,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 22:57:44,164 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 22:57:44,234 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 22:57:44,298 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 22:57:44,362 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 22:57:44,363 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 22:57:44,363 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 22:57:44,363 - __main__ - INFO - Model training completed successfully!
2025-07-20 22:57:44,363 - __main__ - INFO - 
Results for xss:
2025-07-20 22:57:44,363 - __main__ - INFO - 
random_forest:
2025-07-20 22:57:44,363 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:57:44,363 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 22:57:44,363 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:57:44,363 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:57:44,363 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 22:57:44,363 - __main__ - INFO - 
svm:
2025-07-20 22:57:44,363 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:57:44,363 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 22:57:44,363 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 22:57:44,363 - __main__ - INFO - 
random_forest:
2025-07-20 22:57:44,363 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:57:44,363 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:57:44,363 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:57:44,363 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:57:44,363 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:57:44,363 - __main__ - INFO - 
svm:
2025-07-20 22:57:44,363 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:57:44,363 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 22:57:44,363 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 22:57:44,363 - __main__ - INFO - 
random_forest:
2025-07-20 22:57:44,363 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 22:57:44,363 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:57:44,363 - __main__ - INFO - 
logistic_regression:
2025-07-20 22:57:44,363 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 22:57:44,363 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 22:57:44,363 - __main__ - INFO - 
svm:
2025-07-20 22:57:44,363 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 22:57:44,363 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 23:02:21,364 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 23:02:21,364 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 23:02:21,365 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 23:02:21,365 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 23:02:21,365 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 23:02:21,375 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 23:02:21,375 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 23:02:24,113 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:02:24,124 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 23:02:24,125 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 23:02:24,125 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 23:02:24,125 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 23:02:24,126 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 23:02:24,126 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 23:02:24,126 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 23:02:24,155 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:02:24,162 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 23:02:24,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 23:02:24,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 23:02:24,163 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 23:02:24,200 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:02:24,208 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 23:02:24,208 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 23:02:24,495 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 23:02:24,560 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 23:02:24,623 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 23:02:24,623 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 23:02:24,624 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 23:02:24,624 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 23:02:24,634 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 23:02:24,634 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 23:02:26,373 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:02:26,383 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 23:02:26,384 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 23:02:26,384 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 23:02:26,384 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 23:02:26,384 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 23:02:26,384 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 23:02:26,384 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 23:02:26,399 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:02:26,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 23:02:26,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 23:02:26,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 23:02:26,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 23:02:26,443 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:02:26,451 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 23:02:26,451 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 23:02:26,521 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 23:02:26,628 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 23:02:26,694 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 23:02:26,694 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 23:02:26,694 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 23:02:26,694 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 23:02:26,711 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 23:02:26,711 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 23:02:28,432 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:02:28,442 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 23:02:28,443 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 23:02:28,443 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 23:02:28,443 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 23:02:28,443 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 23:02:28,443 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 23:02:28,444 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 23:02:28,470 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:02:28,480 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 23:02:28,481 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 23:02:28,481 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 23:02:28,481 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 23:02:28,517 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:02:28,524 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 23:02:28,524 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 23:02:28,589 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 23:02:28,652 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 23:02:28,716 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 23:02:28,716 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 23:02:28,716 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 23:02:28,716 - __main__ - INFO - Model training completed successfully!
2025-07-20 23:02:28,716 - __main__ - INFO - 
Results for xss:
2025-07-20 23:02:28,717 - __main__ - INFO - 
random_forest:
2025-07-20 23:02:28,717 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:02:28,717 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 23:02:28,717 - __main__ - INFO - 
logistic_regression:
2025-07-20 23:02:28,717 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:02:28,717 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 23:02:28,717 - __main__ - INFO - 
svm:
2025-07-20 23:02:28,717 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:02:28,717 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 23:02:28,717 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 23:02:28,717 - __main__ - INFO - 
random_forest:
2025-07-20 23:02:28,717 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:02:28,717 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 23:02:28,717 - __main__ - INFO - 
logistic_regression:
2025-07-20 23:02:28,717 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:02:28,717 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 23:02:28,717 - __main__ - INFO - 
svm:
2025-07-20 23:02:28,717 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:02:28,717 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 23:02:28,717 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 23:02:28,717 - __main__ - INFO - 
random_forest:
2025-07-20 23:02:28,717 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:02:28,717 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 23:02:28,717 - __main__ - INFO - 
logistic_regression:
2025-07-20 23:02:28,717 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:02:28,717 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 23:02:28,717 - __main__ - INFO - 
svm:
2025-07-20 23:02:28,717 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:02:28,717 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 23:05:45,318 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 23:05:45,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 23:05:45,320 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 23:05:45,320 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 23:05:45,320 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 23:05:45,331 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 23:05:45,331 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 23:05:48,075 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:05:48,086 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 23:05:48,088 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 23:05:48,088 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 23:05:48,088 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 23:05:48,088 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 23:05:48,088 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 23:05:48,088 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 23:05:48,114 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:05:48,123 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 23:05:48,123 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 23:05:48,123 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 23:05:48,123 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 23:05:48,161 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:05:48,169 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 23:05:48,170 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 23:05:48,456 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 23:05:48,523 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 23:05:48,587 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 23:05:48,587 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 23:05:48,587 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 23:05:48,587 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 23:05:48,598 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 23:05:48,598 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 23:05:50,304 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:05:50,314 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 23:05:50,315 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 23:05:50,315 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 23:05:50,315 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 23:05:50,316 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 23:05:50,316 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 23:05:50,316 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 23:05:50,342 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:05:50,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 23:05:50,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 23:05:50,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 23:05:50,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 23:05:50,385 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:05:50,395 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 23:05:50,395 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 23:05:50,460 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 23:05:50,567 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 23:05:50,629 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 23:05:50,629 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 23:05:50,629 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 23:05:50,629 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 23:05:50,646 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 23:05:50,646 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 23:05:52,394 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:05:52,405 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 23:05:52,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 23:05:52,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 23:05:52,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 23:05:52,406 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 23:05:52,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 23:05:52,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 23:05:52,434 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:05:52,442 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 23:05:52,442 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 23:05:52,442 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 23:05:52,442 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 23:05:52,479 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:05:52,487 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 23:05:52,487 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 23:05:52,560 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 23:05:52,623 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 23:05:52,686 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 23:05:52,687 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 23:05:52,687 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 23:05:52,687 - __main__ - INFO - Model training completed successfully!
2025-07-20 23:05:52,687 - __main__ - INFO - 
Results for xss:
2025-07-20 23:05:52,687 - __main__ - INFO - 
random_forest:
2025-07-20 23:05:52,687 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:05:52,687 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 23:05:52,687 - __main__ - INFO - 
logistic_regression:
2025-07-20 23:05:52,687 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:05:52,687 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 23:05:52,687 - __main__ - INFO - 
svm:
2025-07-20 23:05:52,687 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:05:52,687 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 23:05:52,687 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 23:05:52,687 - __main__ - INFO - 
random_forest:
2025-07-20 23:05:52,687 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:05:52,687 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 23:05:52,687 - __main__ - INFO - 
logistic_regression:
2025-07-20 23:05:52,687 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:05:52,687 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 23:05:52,687 - __main__ - INFO - 
svm:
2025-07-20 23:05:52,687 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:05:52,687 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 23:05:52,687 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 23:05:52,687 - __main__ - INFO - 
random_forest:
2025-07-20 23:05:52,687 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:05:52,687 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 23:05:52,687 - __main__ - INFO - 
logistic_regression:
2025-07-20 23:05:52,687 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:05:52,687 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 23:05:52,687 - __main__ - INFO - 
svm:
2025-07-20 23:05:52,687 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:05:52,687 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-20 23:12:20,788 - __main__ - INFO - Starting supervised model training pipeline
2025-07-20 23:12:20,788 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-20 23:12:20,788 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 23:12:20,789 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-20 23:12:20,789 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 23:12:20,799 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-20 23:12:20,799 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 23:12:23,527 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:12:23,539 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-20 23:12:23,540 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-20 23:12:23,540 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-20 23:12:23,540 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 23:12:23,541 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 23:12:23,541 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-20 23:12:23,541 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 23:12:23,569 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:12:23,576 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-20 23:12:23,576 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-20 23:12:23,576 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-20 23:12:23,576 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 23:12:23,614 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:12:23,621 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-20 23:12:23,621 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-20 23:12:23,901 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-20 23:12:23,966 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-20 23:12:24,031 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-20 23:12:24,031 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 23:12:24,031 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-20 23:12:24,031 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 23:12:24,041 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-20 23:12:24,041 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 23:12:25,787 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:12:25,796 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 23:12:25,797 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-20 23:12:25,797 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-20 23:12:25,797 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 23:12:25,798 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 23:12:25,798 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-20 23:12:25,798 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 23:12:25,825 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:12:25,832 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 23:12:25,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-20 23:12:25,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-20 23:12:25,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 23:12:25,870 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:12:25,877 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-20 23:12:25,878 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-20 23:12:25,990 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-20 23:12:26,058 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-20 23:12:26,122 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-20 23:12:26,122 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-20 23:12:26,122 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-20 23:12:26,122 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-20 23:12:26,139 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-20 23:12:26,139 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-20 23:12:27,882 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:12:27,892 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-20 23:12:27,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-20 23:12:27,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-20 23:12:27,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-20 23:12:27,894 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-20 23:12:27,894 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-20 23:12:27,894 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-20 23:12:27,919 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:12:27,928 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-20 23:12:27,928 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-20 23:12:27,928 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-20 23:12:27,928 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-20 23:12:27,966 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:12:27,973 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-20 23:12:27,974 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-20 23:12:28,038 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-20 23:12:28,103 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-20 23:12:28,166 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-20 23:12:28,167 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-20 23:12:28,167 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-20 23:12:28,167 - __main__ - INFO - Model training completed successfully!
2025-07-20 23:12:28,167 - __main__ - INFO - 
Results for xss:
2025-07-20 23:12:28,167 - __main__ - INFO - 
random_forest:
2025-07-20 23:12:28,167 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:12:28,167 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-20 23:12:28,167 - __main__ - INFO - 
logistic_regression:
2025-07-20 23:12:28,167 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:12:28,167 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-20 23:12:28,167 - __main__ - INFO - 
svm:
2025-07-20 23:12:28,167 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:12:28,167 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-20 23:12:28,167 - __main__ - INFO - 
Results for sql_injection:
2025-07-20 23:12:28,167 - __main__ - INFO - 
random_forest:
2025-07-20 23:12:28,167 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:12:28,167 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 23:12:28,167 - __main__ - INFO - 
logistic_regression:
2025-07-20 23:12:28,167 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:12:28,167 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 23:12:28,167 - __main__ - INFO - 
svm:
2025-07-20 23:12:28,167 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:12:28,167 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-20 23:12:28,167 - __main__ - INFO - 
Results for path_traversal:
2025-07-20 23:12:28,167 - __main__ - INFO - 
random_forest:
2025-07-20 23:12:28,167 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-20 23:12:28,167 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-20 23:12:28,167 - __main__ - INFO - 
logistic_regression:
2025-07-20 23:12:28,167 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-20 23:12:28,167 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-20 23:12:28,167 - __main__ - INFO - 
svm:
2025-07-20 23:12:28,167 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-20 23:12:28,167 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 08:40:13,590 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 08:40:13,591 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 08:40:13,591 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:40:13,591 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 08:40:13,591 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:40:13,601 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 08:40:13,601 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:40:16,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:40:16,330 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 08:40:16,331 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 08:40:16,331 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 08:40:16,331 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:40:16,332 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:40:16,332 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 08:40:16,332 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:40:16,360 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:40:16,367 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 08:40:16,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 08:40:16,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 08:40:16,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:40:16,414 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:40:16,422 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 08:40:16,423 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 08:40:16,703 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 08:40:16,769 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 08:40:16,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 08:40:16,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:40:16,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 08:40:16,833 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:40:16,843 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 08:40:16,843 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:40:18,558 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:40:18,570 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:40:18,571 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 08:40:18,571 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 08:40:18,571 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:40:18,571 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:40:18,571 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 08:40:18,571 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:40:18,596 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:40:18,604 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:40:18,604 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 08:40:18,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 08:40:18,605 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:40:18,645 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:40:18,654 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:40:18,655 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 08:40:18,765 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 08:40:18,841 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 08:40:18,906 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 08:40:18,907 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:40:18,907 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 08:40:18,907 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:40:18,923 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 08:40:18,923 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:40:20,680 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:40:20,690 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 08:40:20,691 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 08:40:20,691 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 08:40:20,691 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:40:20,691 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:40:20,691 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 08:40:20,691 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:40:20,717 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:40:20,726 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 08:40:20,726 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 08:40:20,726 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 08:40:20,726 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:40:20,765 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:40:20,775 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 08:40:20,776 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 08:40:20,841 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 08:40:20,905 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 08:40:20,968 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 08:40:20,968 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 08:40:20,968 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 08:40:20,968 - __main__ - INFO - Model training completed successfully!
2025-07-21 08:40:20,968 - __main__ - INFO - 
Results for xss:
2025-07-21 08:40:20,968 - __main__ - INFO - 
random_forest:
2025-07-21 08:40:20,968 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:40:20,968 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 08:40:20,968 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:40:20,968 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:40:20,968 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 08:40:20,968 - __main__ - INFO - 
svm:
2025-07-21 08:40:20,968 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:40:20,968 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 08:40:20,968 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 08:40:20,968 - __main__ - INFO - 
random_forest:
2025-07-21 08:40:20,968 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:40:20,968 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:40:20,968 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:40:20,968 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:40:20,969 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:40:20,969 - __main__ - INFO - 
svm:
2025-07-21 08:40:20,969 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:40:20,969 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:40:20,969 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 08:40:20,969 - __main__ - INFO - 
random_forest:
2025-07-21 08:40:20,969 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:40:20,969 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:40:20,969 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:40:20,969 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:40:20,969 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:40:20,969 - __main__ - INFO - 
svm:
2025-07-21 08:40:20,969 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:40:20,969 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 08:41:57,458 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 08:41:57,458 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 08:41:57,458 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:41:57,458 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 08:41:57,458 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:41:57,468 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 08:41:57,468 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:42:00,190 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:42:00,202 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 08:42:00,203 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 08:42:00,203 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 08:42:00,203 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:42:00,204 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:42:00,204 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 08:42:00,204 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:42:00,230 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:42:00,237 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 08:42:00,238 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 08:42:00,238 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 08:42:00,238 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:42:00,275 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:42:00,283 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 08:42:00,283 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 08:42:00,563 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 08:42:00,627 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 08:42:00,690 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 08:42:00,691 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:42:00,691 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 08:42:00,691 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:42:00,701 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 08:42:00,701 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:42:02,435 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:42:02,445 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:42:02,446 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 08:42:02,446 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 08:42:02,446 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:42:02,446 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:42:02,446 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 08:42:02,446 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:42:02,471 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:42:02,478 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:42:02,478 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 08:42:02,478 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 08:42:02,478 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:42:02,516 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:42:02,524 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:42:02,524 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 08:42:02,636 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 08:42:02,699 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 08:42:02,761 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 08:42:02,761 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:42:02,761 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 08:42:02,761 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:42:02,777 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 08:42:02,777 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:42:04,527 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:42:04,537 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 08:42:04,538 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 08:42:04,538 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 08:42:04,538 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:42:04,538 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:42:04,538 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 08:42:04,539 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:42:04,565 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:42:04,576 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 08:42:04,576 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 08:42:04,576 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 08:42:04,576 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:42:04,621 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:42:04,628 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 08:42:04,628 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 08:42:04,692 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 08:42:04,756 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 08:42:04,818 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 08:42:04,819 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 08:42:04,819 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 08:42:04,819 - __main__ - INFO - Model training completed successfully!
2025-07-21 08:42:04,819 - __main__ - INFO - 
Results for xss:
2025-07-21 08:42:04,819 - __main__ - INFO - 
random_forest:
2025-07-21 08:42:04,819 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:42:04,819 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 08:42:04,819 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:42:04,819 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:42:04,819 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 08:42:04,819 - __main__ - INFO - 
svm:
2025-07-21 08:42:04,819 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:42:04,819 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 08:42:04,819 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 08:42:04,819 - __main__ - INFO - 
random_forest:
2025-07-21 08:42:04,819 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:42:04,819 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:42:04,819 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:42:04,819 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:42:04,819 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:42:04,819 - __main__ - INFO - 
svm:
2025-07-21 08:42:04,819 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:42:04,819 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:42:04,819 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 08:42:04,819 - __main__ - INFO - 
random_forest:
2025-07-21 08:42:04,819 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:42:04,819 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:42:04,819 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:42:04,819 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:42:04,819 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:42:04,819 - __main__ - INFO - 
svm:
2025-07-21 08:42:04,819 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:42:04,819 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 08:45:17,524 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 08:45:17,525 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 08:45:17,525 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:45:17,525 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 08:45:17,525 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:45:17,534 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 08:45:17,535 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:45:20,292 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:45:20,304 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 08:45:20,305 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 08:45:20,305 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 08:45:20,305 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:45:20,305 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:45:20,305 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 08:45:20,305 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:45:20,331 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:45:20,338 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 08:45:20,339 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 08:45:20,339 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 08:45:20,339 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:45:20,376 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:45:20,384 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 08:45:20,384 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 08:45:20,665 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 08:45:20,730 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 08:45:20,794 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 08:45:20,794 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:45:20,794 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 08:45:20,794 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:45:20,805 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 08:45:20,805 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:45:22,556 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:45:22,566 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:45:22,567 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 08:45:22,567 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 08:45:22,567 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:45:22,567 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:45:22,567 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 08:45:22,568 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:45:22,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:45:22,601 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:45:22,601 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 08:45:22,601 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 08:45:22,602 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:45:22,640 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:45:22,647 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:45:22,648 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 08:45:22,765 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 08:45:22,829 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 08:45:22,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 08:45:22,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:45:22,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 08:45:22,893 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:45:22,909 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 08:45:22,909 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:45:24,655 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:45:24,665 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 08:45:24,666 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 08:45:24,666 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 08:45:24,666 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:45:24,667 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:45:24,667 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 08:45:24,667 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:45:24,694 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:45:24,701 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 08:45:24,702 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 08:45:24,702 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 08:45:24,702 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:45:24,741 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:45:24,750 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 08:45:24,750 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 08:45:24,814 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 08:45:24,879 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 08:45:24,942 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 08:45:24,942 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 08:45:24,942 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 08:45:24,942 - __main__ - INFO - Model training completed successfully!
2025-07-21 08:45:24,942 - __main__ - INFO - 
Results for xss:
2025-07-21 08:45:24,942 - __main__ - INFO - 
random_forest:
2025-07-21 08:45:24,942 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:45:24,942 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 08:45:24,942 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:45:24,942 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:45:24,942 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 08:45:24,942 - __main__ - INFO - 
svm:
2025-07-21 08:45:24,942 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:45:24,942 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 08:45:24,942 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 08:45:24,943 - __main__ - INFO - 
random_forest:
2025-07-21 08:45:24,943 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:45:24,943 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:45:24,943 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:45:24,943 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:45:24,943 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:45:24,943 - __main__ - INFO - 
svm:
2025-07-21 08:45:24,943 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:45:24,943 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:45:24,943 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 08:45:24,943 - __main__ - INFO - 
random_forest:
2025-07-21 08:45:24,943 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:45:24,943 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:45:24,943 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:45:24,943 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:45:24,943 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:45:24,943 - __main__ - INFO - 
svm:
2025-07-21 08:45:24,943 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:45:24,943 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 08:48:01,394 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 08:48:01,395 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 08:48:01,395 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:48:01,395 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 08:48:01,395 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:48:01,407 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 08:48:01,407 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:48:04,136 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:48:04,148 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 08:48:04,149 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 08:48:04,149 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 08:48:04,149 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:48:04,150 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:48:04,150 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 08:48:04,150 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:48:04,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:48:04,183 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 08:48:04,183 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 08:48:04,183 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 08:48:04,183 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:48:04,221 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:48:04,229 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 08:48:04,229 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 08:48:04,534 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 08:48:04,602 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 08:48:04,665 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 08:48:04,665 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:48:04,666 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 08:48:04,666 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:48:04,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 08:48:04,676 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:48:06,396 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:48:06,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:48:06,407 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 08:48:06,407 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 08:48:06,407 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:48:06,407 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:48:06,407 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 08:48:06,407 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:48:06,432 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:48:06,441 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:48:06,441 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 08:48:06,441 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 08:48:06,441 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:48:06,479 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:48:06,487 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:48:06,487 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 08:48:06,556 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 08:48:06,664 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 08:48:06,727 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 08:48:06,727 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:48:06,727 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 08:48:06,727 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:48:06,744 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 08:48:06,744 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:48:08,474 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:48:08,487 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 08:48:08,488 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 08:48:08,488 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 08:48:08,488 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:48:08,489 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:48:08,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 08:48:08,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:48:08,514 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:48:08,524 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 08:48:08,524 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 08:48:08,524 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 08:48:08,524 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:48:08,565 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:48:08,572 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 08:48:08,573 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 08:48:08,643 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 08:48:08,710 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 08:48:08,773 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 08:48:08,774 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 08:48:08,774 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 08:48:08,774 - __main__ - INFO - Model training completed successfully!
2025-07-21 08:48:08,774 - __main__ - INFO - 
Results for xss:
2025-07-21 08:48:08,774 - __main__ - INFO - 
random_forest:
2025-07-21 08:48:08,774 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:48:08,774 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 08:48:08,774 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:48:08,774 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:48:08,774 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 08:48:08,774 - __main__ - INFO - 
svm:
2025-07-21 08:48:08,774 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:48:08,774 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 08:48:08,774 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 08:48:08,774 - __main__ - INFO - 
random_forest:
2025-07-21 08:48:08,774 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:48:08,774 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:48:08,774 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:48:08,774 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:48:08,774 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:48:08,774 - __main__ - INFO - 
svm:
2025-07-21 08:48:08,774 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:48:08,774 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:48:08,774 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 08:48:08,774 - __main__ - INFO - 
random_forest:
2025-07-21 08:48:08,774 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:48:08,774 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:48:08,774 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:48:08,774 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:48:08,774 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:48:08,774 - __main__ - INFO - 
svm:
2025-07-21 08:48:08,774 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:48:08,774 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 08:55:31,348 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 08:55:31,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 08:55:31,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:55:31,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 08:55:31,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:55:31,360 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error loading data for xss: idf vector is not fitted
2025-07-21 08:55:31,360 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error processing dataset xss: idf vector is not fitted
2025-07-21 08:55:31,360 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:55:31,360 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 08:55:31,360 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:55:31,369 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error loading data for sql_injection: idf vector is not fitted
2025-07-21 08:55:31,369 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error processing dataset sql_injection: idf vector is not fitted
2025-07-21 08:55:31,369 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:55:31,369 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 08:55:31,369 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:55:31,385 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error loading data for path_traversal: idf vector is not fitted
2025-07-21 08:55:31,385 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Error processing dataset path_traversal: idf vector is not fitted
2025-07-21 08:55:31,385 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 08:55:31,385 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 08:55:31,385 - __main__ - INFO - Model training completed successfully!
2025-07-21 08:56:27,941 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 08:56:27,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 08:56:27,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:56:27,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 08:56:27,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:56:27,951 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 08:56:27,951 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:56:30,687 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:56:30,699 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 08:56:30,700 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 08:56:30,700 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 08:56:30,700 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:56:30,700 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:56:30,700 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 08:56:30,700 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:56:30,728 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:56:30,735 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 08:56:30,736 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 08:56:30,736 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 08:56:30,736 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:56:30,779 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:56:30,786 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 08:56:30,787 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 08:56:31,110 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 08:56:31,177 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 08:56:31,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 08:56:31,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:56:31,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 08:56:31,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:56:31,251 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 08:56:31,251 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:56:32,981 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:56:32,991 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:56:32,992 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 08:56:32,992 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 08:56:32,992 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:56:32,993 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:56:32,993 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 08:56:32,993 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:56:33,007 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:56:33,014 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:56:33,014 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 08:56:33,014 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 08:56:33,014 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:56:33,051 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:56:33,058 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 08:56:33,059 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 08:56:33,123 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 08:56:33,229 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 08:56:33,294 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 08:56:33,294 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 08:56:33,294 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 08:56:33,294 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 08:56:33,310 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 08:56:33,311 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 08:56:35,066 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:56:35,076 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 08:56:35,077 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 08:56:35,077 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 08:56:35,077 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 08:56:35,078 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 08:56:35,078 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 08:56:35,078 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 08:56:35,103 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:56:35,111 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 08:56:35,112 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 08:56:35,112 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 08:56:35,112 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 08:56:35,150 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:56:35,157 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 08:56:35,157 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 08:56:35,222 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 08:56:35,286 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 08:56:35,348 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 08:56:35,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 08:56:35,349 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 08:56:35,349 - __main__ - INFO - Model training completed successfully!
2025-07-21 08:56:35,349 - __main__ - INFO - 
Results for xss:
2025-07-21 08:56:35,349 - __main__ - INFO - 
random_forest:
2025-07-21 08:56:35,349 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:56:35,349 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 08:56:35,349 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:56:35,349 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:56:35,349 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 08:56:35,349 - __main__ - INFO - 
svm:
2025-07-21 08:56:35,349 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:56:35,349 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 08:56:35,349 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 08:56:35,349 - __main__ - INFO - 
random_forest:
2025-07-21 08:56:35,349 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:56:35,349 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:56:35,349 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:56:35,349 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:56:35,349 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:56:35,349 - __main__ - INFO - 
svm:
2025-07-21 08:56:35,349 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:56:35,349 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 08:56:35,349 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 08:56:35,349 - __main__ - INFO - 
random_forest:
2025-07-21 08:56:35,349 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 08:56:35,349 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:56:35,349 - __main__ - INFO - 
logistic_regression:
2025-07-21 08:56:35,349 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 08:56:35,349 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 08:56:35,349 - __main__ - INFO - 
svm:
2025-07-21 08:56:35,349 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 08:56:35,349 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 09:03:10,174 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 09:03:10,174 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 09:03:10,174 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:03:10,175 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 09:03:10,175 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:03:10,184 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 09:03:10,185 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:03:12,933 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:03:12,944 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 09:03:12,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 09:03:12,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 09:03:12,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:03:12,946 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 09:03:12,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 09:03:12,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:03:12,975 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:03:12,982 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 09:03:12,982 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 09:03:12,982 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 09:03:12,982 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:03:13,023 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:03:13,032 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 09:03:13,033 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 09:03:13,321 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 09:03:13,386 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 09:03:13,448 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 09:03:13,448 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:03:13,448 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 09:03:13,448 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:03:13,459 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 09:03:13,459 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:03:15,178 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:03:15,188 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:03:15,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 09:03:15,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 09:03:15,189 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:03:15,190 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 09:03:15,190 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 09:03:15,190 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:03:15,204 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:03:15,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:03:15,212 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 09:03:15,212 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 09:03:15,212 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:03:15,248 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:03:15,258 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:03:15,259 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 09:03:15,322 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 09:03:15,426 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 09:03:15,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 09:03:15,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:03:15,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 09:03:15,489 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:03:15,506 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 09:03:15,506 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:03:17,230 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:03:17,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 09:03:17,241 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 09:03:17,241 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 09:03:17,241 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:03:17,242 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 09:03:17,242 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 09:03:17,242 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:03:17,268 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:03:17,279 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 09:03:17,280 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 09:03:17,280 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 09:03:17,280 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:03:17,322 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:03:17,329 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 09:03:17,329 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 09:03:17,395 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 09:03:17,459 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 09:03:17,526 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 09:03:17,527 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 09:03:17,527 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 09:03:17,527 - __main__ - INFO - Model training completed successfully!
2025-07-21 09:03:17,527 - __main__ - INFO - 
Results for xss:
2025-07-21 09:03:17,527 - __main__ - INFO - 
random_forest:
2025-07-21 09:03:17,527 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:03:17,527 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 09:03:17,527 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:03:17,527 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:03:17,527 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 09:03:17,527 - __main__ - INFO - 
svm:
2025-07-21 09:03:17,527 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:03:17,527 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 09:03:17,527 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 09:03:17,527 - __main__ - INFO - 
random_forest:
2025-07-21 09:03:17,527 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:03:17,527 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:03:17,527 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:03:17,527 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:03:17,527 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:03:17,527 - __main__ - INFO - 
svm:
2025-07-21 09:03:17,527 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:03:17,527 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:03:17,527 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 09:03:17,527 - __main__ - INFO - 
random_forest:
2025-07-21 09:03:17,528 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:03:17,528 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:03:17,528 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:03:17,528 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:03:17,528 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:03:17,528 - __main__ - INFO - 
svm:
2025-07-21 09:03:17,528 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:03:17,528 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 09:05:12,134 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 09:05:12,134 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 09:05:12,134 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:05:12,134 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 09:05:12,134 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:05:12,144 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 09:05:12,144 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:05:14,900 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:05:14,912 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 09:05:14,913 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 09:05:14,913 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 09:05:14,913 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:05:14,913 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on xss: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 09:05:14,913 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 09:05:14,913 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:05:14,939 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:05:14,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 09:05:14,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 09:05:14,947 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 09:05:14,947 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:05:14,983 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:05:14,990 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 09:05:14,991 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 09:05:15,281 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 09:05:15,348 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 09:05:15,411 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 09:05:15,411 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:05:15,411 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 09:05:15,411 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:05:15,422 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 09:05:15,422 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:05:17,132 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:05:17,142 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:05:17,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 09:05:17,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 09:05:17,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:05:17,143 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on sql_injection: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 09:05:17,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 09:05:17,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:05:17,169 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:05:17,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:05:17,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 09:05:17,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 09:05:17,176 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:05:17,214 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:05:17,221 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:05:17,221 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 09:05:17,285 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 09:05:17,390 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 09:05:17,457 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 09:05:17,457 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:05:17,457 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 09:05:17,457 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:05:17,474 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 09:05:17,474 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:05:19,200 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:05:19,210 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 09:05:19,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 09:05:19,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 09:05:19,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:05:19,212 - src.hybrid_threat_detection.models.supervised_trainer - ERROR - Model xgboost failed on path_traversal: 'super' object has no attribute '__sklearn_tags__'
2025-07-21 09:05:19,212 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 09:05:19,212 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:05:19,240 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:05:19,251 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 09:05:19,251 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 09:05:19,251 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 09:05:19,252 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:05:19,293 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:05:19,301 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 09:05:19,302 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 09:05:19,368 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 09:05:19,432 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 09:05:19,496 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 09:05:19,496 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 09:05:19,496 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 09:05:19,496 - __main__ - INFO - Model training completed successfully!
2025-07-21 09:05:19,496 - __main__ - INFO - 
Results for xss:
2025-07-21 09:05:19,496 - __main__ - INFO - 
random_forest:
2025-07-21 09:05:19,496 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:05:19,496 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 09:05:19,496 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:05:19,496 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:05:19,496 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 09:05:19,496 - __main__ - INFO - 
svm:
2025-07-21 09:05:19,496 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:05:19,496 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 09:05:19,496 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 09:05:19,496 - __main__ - INFO - 
random_forest:
2025-07-21 09:05:19,497 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:05:19,497 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:05:19,497 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:05:19,497 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:05:19,497 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:05:19,497 - __main__ - INFO - 
svm:
2025-07-21 09:05:19,497 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:05:19,497 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:05:19,497 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 09:05:19,497 - __main__ - INFO - 
random_forest:
2025-07-21 09:05:19,497 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:05:19,497 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:05:19,497 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:05:19,497 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:05:19,497 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:05:19,497 - __main__ - INFO - 
svm:
2025-07-21 09:05:19,497 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:05:19,497 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 09:06:33,643 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 09:06:33,643 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 09:06:33,643 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:06:33,643 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 09:06:33,643 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:06:33,653 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 09:06:33,653 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:06:35,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:06:35,956 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 09:06:35,957 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 09:06:35,957 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 09:06:35,957 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:06:41,498 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 09:06:41,535 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.266667
2025-07-21 09:06:41,539 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/xgboost.pkl
2025-07-21 09:06:41,539 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 09:06:41,539 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:06:41,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:06:41,616 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 09:06:41,621 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 09:06:41,621 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 09:06:41,621 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:06:41,694 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:06:41,700 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 09:06:41,701 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 09:06:41,988 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 09:06:42,055 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/xgboost_confusion_matrix.png
2025-07-21 09:06:42,118 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 09:06:42,183 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 09:06:42,183 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:06:42,183 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 09:06:42,183 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:06:42,193 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 09:06:42,193 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:06:43,710 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:06:43,718 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:06:43,719 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 09:06:43,719 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 09:06:43,719 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:06:53,745 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100}
2025-07-21 09:06:53,783 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:06:53,790 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/xgboost.pkl
2025-07-21 09:06:53,790 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 09:06:53,790 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:06:53,838 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:06:53,867 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:06:53,871 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 09:06:53,871 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 09:06:53,871 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:06:53,912 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:06:53,919 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:06:53,919 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 09:06:54,028 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 09:06:54,092 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/xgboost_confusion_matrix.png
2025-07-21 09:06:54,155 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 09:06:54,217 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 09:06:54,218 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:06:54,218 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 09:06:54,218 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:06:54,235 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 09:06:54,235 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:06:55,749 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:06:55,758 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 09:06:55,759 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 09:06:55,759 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 09:06:55,759 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:07:01,108 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 09:07:01,144 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 09:07:01,148 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/xgboost.pkl
2025-07-21 09:07:01,148 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 09:07:01,149 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:07:01,185 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:07:01,211 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 09:07:01,215 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 09:07:01,216 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 09:07:01,216 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:07:01,265 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:07:01,274 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 09:07:01,274 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 09:07:01,340 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 09:07:01,405 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/xgboost_confusion_matrix.png
2025-07-21 09:07:01,470 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 09:07:01,533 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 09:07:01,533 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 09:07:01,533 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 09:07:01,534 - __main__ - INFO - Model training completed successfully!
2025-07-21 09:07:01,534 - __main__ - INFO - 
Results for xss:
2025-07-21 09:07:01,534 - __main__ - INFO - 
random_forest:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 09:07:01,534 - __main__ - INFO - 
xgboost:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.2666666666666666}
2025-07-21 09:07:01,534 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 09:07:01,534 - __main__ - INFO - 
svm:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 09:07:01,534 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 09:07:01,534 - __main__ - INFO - 
random_forest:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:07:01,534 - __main__ - INFO - 
xgboost:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:07:01,534 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:07:01,534 - __main__ - INFO - 
svm:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:07:01,534 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 09:07:01,534 - __main__ - INFO - 
random_forest:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:07:01,534 - __main__ - INFO - 
xgboost:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:07:01,534 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:07:01,534 - __main__ - INFO - 
svm:
2025-07-21 09:07:01,534 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:07:01,534 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 09:09:12,392 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: xss
2025-07-21 09:09:12,392 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to xss
2025-07-21 09:09:12,394 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for xss. Shape: (100, 138)
2025-07-21 09:09:12,395 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to xss
2025-07-21 09:09:12,395 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for xss
2025-07-21 09:09:12,396 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for xss: 70
2025-07-21 09:09:12,396 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-21 09:09:12,396 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-21 09:09:12,396 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-21 09:09:12,881 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-21 09:09:26,431 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-21T09:09:26.431704', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-21 09:09:26,522 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-21 09:09:26,529 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (70, 100)
2025-07-21 09:09:26,548 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: sql_injection
2025-07-21 09:09:26,549 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to sql_injection
2025-07-21 09:09:26,550 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for sql_injection. Shape: (100, 19)
2025-07-21 09:09:26,550 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to sql_injection
2025-07-21 09:09:26,550 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for sql_injection
2025-07-21 09:09:26,551 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for sql_injection: 21
2025-07-21 09:09:26,551 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-21 09:09:26,551 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-21 09:09:26,551 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-21 09:09:26,584 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-21 09:09:40,162 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-21T09:09:40.162239', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-21 09:09:40,244 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-21 09:09:40,250 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (21, 100)
2025-07-21 09:09:40,270 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: path_traversal
2025-07-21 09:09:40,271 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to path_traversal
2025-07-21 09:09:40,272 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for path_traversal. Shape: (100, 60)
2025-07-21 09:09:40,272 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to path_traversal
2025-07-21 09:09:40,272 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for path_traversal
2025-07-21 09:09:40,273 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for path_traversal: 33
2025-07-21 09:09:40,273 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-21 09:09:40,273 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-21 09:09:40,273 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-21 09:09:40,310 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-21 09:09:53,866 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-21T09:09:53.866944', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-21 09:09:53,960 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-21 09:09:53,967 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (33, 100)
2025-07-21 09:09:53,989 - __main__ - INFO - Vectorization completed successfully!
2025-07-21 09:09:53,989 - __main__ - INFO - XSS TF-IDF shape: (100, 138)
2025-07-21 09:09:53,989 - __main__ - INFO - XSS Padded Sequences shape: (100, 100)
2025-07-21 09:10:16,449 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-21 09:10:16,449 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-21 09:10:16,468 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-21 09:10:16,468 - src.hybrid_threat_detection.features.encoding - WARNING - Only 2 XSS samples found - augmenting with top 8 candidates
2025-07-21 09:10:16,487 - src.hybrid_threat_detection.features.encoding - INFO - After augmentation: 15 malicious samples
2025-07-21 09:10:16,487 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1    15
Name: count, dtype: int64
2025-07-21 09:10:16,489 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-21 09:10:16,489 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-21 09:10:16,489 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-21 09:10:16,523 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-21 09:10:16,524 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-21 09:10:16,525 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-21 09:10:16,525 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-21 09:10:16,525 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-21 09:10:16,536 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-21 09:10:16,537 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-21 09:10:16,538 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-21 09:10:16,541 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-21 09:10:16,547 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-21 09:10:16,560 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-21 09:10:16,560 - __main__ - INFO - Encoding completed successfully!
2025-07-21 09:10:16,560 - __main__ - INFO - 
Encoding Summary:
2025-07-21 09:10:16,560 - __main__ - INFO - 
Dataset: metadata
2025-07-21 09:10:16,560 - __main__ - INFO - Attack type: None
2025-07-21 09:10:16,560 - __main__ - INFO - Label distribution: None
2025-07-21 09:10:16,560 - __main__ - INFO - Original label column: None
2025-07-21 09:10:16,560 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-21 09:10:16,560 - __main__ - INFO - Attack type: None
2025-07-21 09:10:16,560 - __main__ - INFO - Label distribution: None
2025-07-21 09:10:16,560 - __main__ - INFO - Original label column: None
2025-07-21 09:10:34,567 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-21 09:10:34,569 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 90, Test: 23
2025-07-21 09:10:34,569 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-21 09:10:34,569 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-21 09:10:34,571 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-21 09:10:34,571 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-21 09:10:34,571 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-21 09:10:34,572 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-21 09:10:34,572 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-21 09:10:34,572 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-21 09:10:34,596 - __main__ - INFO - Splitting completed successfully!
2025-07-21 09:10:34,596 - __main__ - INFO - 
Splitting Summary:
2025-07-21 09:10:34,596 - __main__ - INFO - 
Dataset: xss
2025-07-21 09:10:34,596 - __main__ - INFO - Split type: train_test
2025-07-21 09:10:34,596 - __main__ - INFO - Train samples: 90
2025-07-21 09:10:34,596 - __main__ - INFO - Test samples: 23
2025-07-21 09:10:34,596 - __main__ - INFO - Train label distribution: {0: 78, 1: 12}
2025-07-21 09:10:34,596 - __main__ - INFO - 
Dataset: sql_injection
2025-07-21 09:10:34,596 - __main__ - INFO - Split type: train_test
2025-07-21 09:10:34,596 - __main__ - INFO - Train samples: 80
2025-07-21 09:10:34,596 - __main__ - INFO - Test samples: 20
2025-07-21 09:10:34,596 - __main__ - INFO - Train label distribution: {0: 66, 1: 14}
2025-07-21 09:10:34,596 - __main__ - INFO - 
Dataset: path_traversal
2025-07-21 09:10:34,596 - __main__ - INFO - Split type: train_test
2025-07-21 09:10:34,596 - __main__ - INFO - Train samples: 80
2025-07-21 09:10:34,596 - __main__ - INFO - Test samples: 20
2025-07-21 09:10:34,596 - __main__ - INFO - Train label distribution: {1: 70, 0: 10}
2025-07-21 09:11:24,562 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 09:11:24,562 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 09:11:24,562 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:11:24,562 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 09:11:24,562 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:11:24,572 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 09:11:24,572 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:11:26,857 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:11:26,868 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 09:11:26,869 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 09:11:26,869 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 09:11:26,869 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:11:32,450 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 09:11:32,486 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.266667
2025-07-21 09:11:32,493 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/xgboost.pkl
2025-07-21 09:11:32,493 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 09:11:32,493 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:11:32,529 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:11:32,553 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 09:11:32,554 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 09:11:32,554 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 09:11:32,554 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:11:32,642 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:11:32,648 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.2
2025-07-21 09:11:32,649 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 09:11:32,945 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 09:11:33,017 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/xgboost_confusion_matrix.png
2025-07-21 09:11:33,079 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 09:11:33,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 09:11:33,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:11:33,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 09:11:33,143 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:11:33,153 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 09:11:33,154 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:11:34,674 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:11:34,683 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:11:34,684 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 09:11:34,684 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 09:11:34,684 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:11:37,185 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100}
2025-07-21 09:11:37,198 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:11:37,203 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/xgboost.pkl
2025-07-21 09:11:37,203 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 09:11:37,203 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:11:37,242 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:11:37,269 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:11:37,273 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 09:11:37,273 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 09:11:37,274 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:11:37,319 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:11:37,326 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 09:11:37,326 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 09:11:37,432 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 09:11:37,495 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/xgboost_confusion_matrix.png
2025-07-21 09:11:37,557 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 09:11:37,619 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 09:11:37,619 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 09:11:37,619 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 09:11:37,619 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 09:11:37,636 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 09:11:37,636 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 09:11:39,151 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:11:39,159 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 09:11:39,160 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 09:11:39,160 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 09:11:39,160 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 09:11:44,441 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 09:11:44,475 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 09:11:44,479 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/xgboost.pkl
2025-07-21 09:11:44,480 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 09:11:44,480 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 09:11:44,525 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:11:44,554 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 09:11:44,555 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 09:11:44,555 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 09:11:44,555 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 09:11:44,603 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:11:44,609 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 09:11:44,610 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 09:11:44,677 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 09:11:44,741 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/xgboost_confusion_matrix.png
2025-07-21 09:11:44,807 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 09:11:44,872 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 09:11:44,873 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 09:11:44,873 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 09:11:44,873 - __main__ - INFO - Model training completed successfully!
2025-07-21 09:11:44,873 - __main__ - INFO - 
Results for xss:
2025-07-21 09:11:44,873 - __main__ - INFO - 
random_forest:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 09:11:44,873 - __main__ - INFO - 
xgboost:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.2666666666666666}
2025-07-21 09:11:44,873 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 09:11:44,873 - __main__ - INFO - 
svm:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.19999999999999998}
2025-07-21 09:11:44,873 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 09:11:44,873 - __main__ - INFO - 
random_forest:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:11:44,873 - __main__ - INFO - 
xgboost:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:11:44,873 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:11:44,873 - __main__ - INFO - 
svm:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 09:11:44,873 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 09:11:44,873 - __main__ - INFO - 
random_forest:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:11:44,873 - __main__ - INFO - 
xgboost:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:11:44,873 - __main__ - INFO - 
logistic_regression:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 09:11:44,873 - __main__ - INFO - 
svm:
2025-07-21 09:11:44,873 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 09:11:44,873 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 10:29:34,592 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 10:29:34,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 10:29:34,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 10:29:34,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 10:29:34,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 10:29:34,602 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 10:29:34,602 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 10:29:36,936 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 10:29:36,946 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.866667
2025-07-21 10:29:36,947 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 10:29:36,947 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 10:29:36,947 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 10:29:42,508 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 10:29:42,545 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.266667
2025-07-21 10:29:42,549 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/xgboost.pkl
2025-07-21 10:29:42,549 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 10:29:42,550 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 10:29:42,592 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 10:29:42,617 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 10:29:42,622 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 10:29:42,622 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 10:29:42,622 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 10:29:42,708 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 10:29:42,715 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 10:29:42,716 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 10:29:43,002 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 10:29:43,069 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/xgboost_confusion_matrix.png
2025-07-21 10:29:43,131 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 10:29:43,195 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 10:29:43,195 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 10:29:43,195 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 10:29:43,195 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 10:29:43,205 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 10:29:43,206 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 10:29:44,818 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 10:29:44,827 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 10:29:44,828 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 10:29:44,828 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 10:29:44,828 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 10:29:54,863 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100}
2025-07-21 10:29:54,899 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 10:29:54,904 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/xgboost.pkl
2025-07-21 10:29:54,904 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 10:29:54,904 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 10:29:54,941 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 10:29:54,972 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 10:29:54,972 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 10:29:54,973 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 10:29:54,973 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 10:29:55,022 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 10:29:55,029 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 10:29:55,029 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 10:29:55,135 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 10:29:55,201 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/xgboost_confusion_matrix.png
2025-07-21 10:29:55,264 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 10:29:55,326 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 10:29:55,326 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 10:29:55,326 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 10:29:55,326 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 10:29:55,343 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 10:29:55,343 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 10:29:56,898 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 10:29:56,907 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 10:29:56,908 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 10:29:56,908 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 10:29:56,908 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 10:30:02,182 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 10:30:02,219 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 10:30:02,223 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/xgboost.pkl
2025-07-21 10:30:02,224 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 10:30:02,224 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 10:30:02,267 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 10:30:02,295 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 10:30:02,296 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 10:30:02,296 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 10:30:02,296 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 10:30:02,348 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 10:30:02,355 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 10:30:02,355 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 10:30:02,420 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 10:30:02,483 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/xgboost_confusion_matrix.png
2025-07-21 10:30:02,551 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 10:30:02,614 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 10:30:02,615 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 10:30:02,615 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 10:30:02,615 - __main__ - INFO - Model training completed successfully!
2025-07-21 10:30:02,615 - __main__ - INFO - 
Results for xss:
2025-07-21 10:30:02,615 - __main__ - INFO - 
random_forest:
2025-07-21 10:30:02,615 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 10:30:02,615 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.8666666666666666}
2025-07-21 10:30:02,615 - __main__ - INFO - 
xgboost:
2025-07-21 10:30:02,615 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 10:30:02,615 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.2666666666666666}
2025-07-21 10:30:02,615 - __main__ - INFO - 
logistic_regression:
2025-07-21 10:30:02,615 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 10:30:02,615 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 10:30:02,615 - __main__ - INFO - 
svm:
2025-07-21 10:30:02,615 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 10:30:02,615 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 10:30:02,615 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 10:30:02,615 - __main__ - INFO - 
random_forest:
2025-07-21 10:30:02,615 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 10:30:02,615 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 10:30:02,615 - __main__ - INFO - 
xgboost:
2025-07-21 10:30:02,615 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100}
2025-07-21 10:30:02,615 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 10:30:02,615 - __main__ - INFO - 
logistic_regression:
2025-07-21 10:30:02,615 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 10:30:02,615 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 10:30:02,615 - __main__ - INFO - 
svm:
2025-07-21 10:30:02,616 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 10:30:02,616 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 10:30:02,616 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 10:30:02,616 - __main__ - INFO - 
random_forest:
2025-07-21 10:30:02,616 - __main__ - INFO - Best params: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 10:30:02,616 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 10:30:02,616 - __main__ - INFO - 
xgboost:
2025-07-21 10:30:02,616 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 10:30:02,616 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 10:30:02,616 - __main__ - INFO - 
logistic_regression:
2025-07-21 10:30:02,616 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 10:30:02,616 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 10:30:02,616 - __main__ - INFO - 
svm:
2025-07-21 10:30:02,616 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 10:30:02,616 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 11:11:07,979 - __main__ - INFO - Loading datasets from configured files...
2025-07-21 11:11:07,985 - __main__ - INFO - Loaded xss with shape (167, 33)
2025-07-21 11:11:08,428 - __main__ - INFO - Loaded sql_injection with shape (11740, 41)
2025-07-21 11:11:09,440 - __main__ - INFO - Loaded path_traversal with shape (42340, 38)
2025-07-21 11:11:09,440 - __main__ - INFO - Starting cleaning for xss
2025-07-21 11:11:09,442 - __main__ - INFO - Null counts before cleaning in xss:
post_data     113
event_type     57
dtype: int64
2025-07-21 11:11:09,442 - __main__ - INFO - Removed 167 rows with null values in xss
2025-07-21 11:11:09,443 - __main__ - INFO - Found 0 duplicates in xss
2025-07-21 11:11:09,443 - __main__ - INFO - Removed 0 duplicates from xss
2025-07-21 11:11:09,443 - __main__ - INFO - Normalizing payloads in xss...
2025-07-21 11:11:09,444 - __main__ - INFO - Payload normalization completed for xss
2025-07-21 11:11:09,444 - __main__ - ERROR - Error cleaning xss: 'DataCleaner' object has no attribute '_convert_to_binary_labels'
2025-07-21 11:20:47,115 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-21 11:20:47,116 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-21 11:20:47,140 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-21 11:20:47,140 - src.hybrid_threat_detection.features.encoding - ERROR - Error encoding xss: 'DataEncoder' object has no attribute '_identify_label_column'
2025-07-21 11:20:47,140 - __main__ - ERROR - Encoding failed: 'DataEncoder' object has no attribute '_identify_label_column'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 19, in main
    encoded_data = encoder.encode_all(cleaned_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 58, in encode_all
    encoded_df, metadata = self._encode_dataset(name, df)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 80, in _encode_dataset
    df_encoded = self._encode_labels(name, df_encoded, metadata)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 152, in _encode_labels
    label_col = self._identify_label_column(name, df)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataEncoder' object has no attribute '_identify_label_column'. Did you mean: '_identify_text_columns'?
2025-07-21 11:34:13,149 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-21 11:34:13,150 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-21 11:34:13,169 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-21 11:34:13,169 - src.hybrid_threat_detection.features.encoding - ERROR - Error encoding xss: 'DataEncoder' object has no attribute '_identify_label_column'
2025-07-21 11:34:13,169 - __main__ - ERROR - Encoding failed: 'DataEncoder' object has no attribute '_identify_label_column'
Traceback (most recent call last):
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/run_encoding.py", line 19, in main
    encoded_data = encoder.encode_all(cleaned_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 58, in encode_all
    encoded_df, metadata = self._encode_dataset(name, df)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 80, in _encode_dataset
    df_encoded = self._encode_labels(name, df_encoded, metadata)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/features/encoding.py", line 142, in _encode_labels
    label_col = self._identify_label_column(name, df)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataEncoder' object has no attribute '_identify_label_column'. Did you mean: '_identify_text_columns'?
2025-07-21 11:34:40,813 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for xss
2025-07-21 11:34:40,813 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'XSS' to xss
2025-07-21 11:34:40,832 - src.hybrid_threat_detection.features.encoding - INFO - Detected 2 malicious samples in xss
2025-07-21 11:34:40,832 - src.hybrid_threat_detection.features.encoding - WARNING - Only 2 XSS samples found - augmenting with top 8 candidates
2025-07-21 11:34:40,851 - src.hybrid_threat_detection.features.encoding - INFO - After augmentation: 15 malicious samples
2025-07-21 11:34:40,852 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for xss:
label
0    98
1    15
Name: count, dtype: int64
2025-07-21 11:34:40,853 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for xss
2025-07-21 11:34:40,853 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for sql_injection
2025-07-21 11:34:40,853 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'SQLI' to sql_injection
2025-07-21 11:34:40,888 - src.hybrid_threat_detection.features.encoding - INFO - Detected 18 malicious samples in sql_injection
2025-07-21 11:34:40,888 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for sql_injection:
label
0    82
1    18
Name: count, dtype: int64
2025-07-21 11:34:40,889 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for sql_injection
2025-07-21 11:34:40,890 - src.hybrid_threat_detection.features.encoding - INFO - Starting encoding for path_traversal
2025-07-21 11:34:40,890 - src.hybrid_threat_detection.features.encoding - INFO - Added attack type 'PathTraversal' to path_traversal
2025-07-21 11:34:40,901 - src.hybrid_threat_detection.features.encoding - INFO - Detected 87 malicious samples in path_traversal
2025-07-21 11:34:40,901 - src.hybrid_threat_detection.features.encoding - INFO - Final labels for path_traversal:
label
1    87
0    13
Name: count, dtype: int64
2025-07-21 11:34:40,902 - src.hybrid_threat_detection.features.encoding - INFO - Completed encoding for path_traversal
2025-07-21 11:34:40,905 - __main__ - INFO - Saved encoded xss data to src/hybrid_threat_detection/results/phase2/encoding/xss_encoded.csv
2025-07-21 11:34:40,911 - __main__ - INFO - Saved encoded sql_injection data to src/hybrid_threat_detection/results/phase2/encoding/sql_injection_encoded.csv
2025-07-21 11:34:40,925 - __main__ - INFO - Saved encoded path_traversal data to src/hybrid_threat_detection/results/phase2/encoding/path_traversal_encoded.csv
2025-07-21 11:34:40,925 - __main__ - INFO - Encoding completed successfully!
2025-07-21 11:34:40,925 - __main__ - INFO - 
Encoding Summary:
2025-07-21 11:34:40,925 - __main__ - INFO - 
Dataset: metadata
2025-07-21 11:34:40,925 - __main__ - INFO - Attack type: None
2025-07-21 11:34:40,925 - __main__ - INFO - Label distribution: None
2025-07-21 11:34:40,925 - __main__ - INFO - Original label column: None
2025-07-21 11:34:40,925 - __main__ - INFO - 
Dataset: detection_patterns
2025-07-21 11:34:40,925 - __main__ - INFO - Attack type: None
2025-07-21 11:34:40,925 - __main__ - INFO - Label distribution: None
2025-07-21 11:34:40,925 - __main__ - INFO - Original label column: None
2025-07-21 11:34:55,118 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: xss
2025-07-21 11:34:55,121 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 90, Test: 23
2025-07-21 11:34:55,121 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for xss
2025-07-21 11:34:55,121 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: sql_injection
2025-07-21 11:34:55,122 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-21 11:34:55,123 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for sql_injection
2025-07-21 11:34:55,123 - src.hybrid_threat_detection.features.splitting - INFO - Splitting dataset: path_traversal
2025-07-21 11:34:55,124 - src.hybrid_threat_detection.features.splitting - INFO - Train-test split completed. Train: 80, Test: 20
2025-07-21 11:34:55,124 - src.hybrid_threat_detection.features.splitting - INFO - Completed splitting for path_traversal
2025-07-21 11:34:55,124 - src.hybrid_threat_detection.features.splitting - INFO - Saved splitting metadata to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/splits/split_metadata.json
2025-07-21 11:34:55,151 - __main__ - INFO - Splitting completed successfully!
2025-07-21 11:34:55,151 - __main__ - INFO - 
Splitting Summary:
2025-07-21 11:34:55,151 - __main__ - INFO - 
Dataset: xss
2025-07-21 11:34:55,151 - __main__ - INFO - Split type: train_test
2025-07-21 11:34:55,151 - __main__ - INFO - Train samples: 90
2025-07-21 11:34:55,151 - __main__ - INFO - Test samples: 23
2025-07-21 11:34:55,151 - __main__ - INFO - Train label distribution: {0: 78, 1: 12}
2025-07-21 11:34:55,151 - __main__ - INFO - 
Dataset: sql_injection
2025-07-21 11:34:55,151 - __main__ - INFO - Split type: train_test
2025-07-21 11:34:55,151 - __main__ - INFO - Train samples: 80
2025-07-21 11:34:55,151 - __main__ - INFO - Test samples: 20
2025-07-21 11:34:55,151 - __main__ - INFO - Train label distribution: {0: 66, 1: 14}
2025-07-21 11:34:55,151 - __main__ - INFO - 
Dataset: path_traversal
2025-07-21 11:34:55,151 - __main__ - INFO - Split type: train_test
2025-07-21 11:34:55,151 - __main__ - INFO - Train samples: 80
2025-07-21 11:34:55,151 - __main__ - INFO - Test samples: 20
2025-07-21 11:34:55,151 - __main__ - INFO - Train label distribution: {1: 70, 0: 10}
2025-07-21 11:35:09,105 - __main__ - INFO - Starting supervised model training pipeline
2025-07-21 11:35:09,105 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Loaded model config from src/hybrid_threat_detection/config/model_config.json
2025-07-21 11:35:09,106 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 11:35:09,106 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on xss dataset
2025-07-21 11:35:09,106 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 11:35:09,116 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on xss
2025-07-21 11:35:09,116 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 11:35:11,427 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'class_weight': 'balanced', 'max_depth': None, 'min_samples_split': 5, 'n_estimators': 100}
2025-07-21 11:35:11,438 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.333333
2025-07-21 11:35:11,441 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/random_forest.pkl
2025-07-21 11:35:11,441 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on xss
2025-07-21 11:35:11,441 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 11:35:17,079 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 11:35:17,116 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix   roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]  0.266667
2025-07-21 11:35:17,120 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/xgboost.pkl
2025-07-21 11:35:17,120 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on xss
2025-07-21 11:35:17,121 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 11:35:17,167 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 11:35:17,196 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall   f1   confusion_matrix   roc_auc
0  0.217391   0.058824  0.333333  0.1  [[4, 16], [2, 1]]  0.333333
2025-07-21 11:35:17,197 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/logistic_regression.pkl
2025-07-21 11:35:17,197 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on xss
2025-07-21 11:35:17,197 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 11:35:17,253 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 11:35:17,260 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0  0.869565        0.0     0.0  0.0  [[20, 0], [3, 0]]      0.8
2025-07-21 11:35:17,260 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/xss/svm.pkl
2025-07-21 11:35:17,552 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/random_forest_confusion_matrix.png
2025-07-21 11:35:17,622 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/xgboost_confusion_matrix.png
2025-07-21 11:35:17,688 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/logistic_regression_confusion_matrix.png
2025-07-21 11:35:17,752 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/xss/svm_confusion_matrix.png
2025-07-21 11:35:17,752 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 11:35:17,752 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on sql_injection dataset
2025-07-21 11:35:17,752 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 11:35:17,763 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on sql_injection
2025-07-21 11:35:17,763 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 11:35:19,306 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'class_weight': 'balanced', 'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 11:35:19,317 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 11:35:19,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/random_forest.pkl
2025-07-21 11:35:19,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on sql_injection
2025-07-21 11:35:19,318 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 11:35:29,446 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100}
2025-07-21 11:35:29,478 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 11:35:29,486 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/xgboost.pkl
2025-07-21 11:35:29,486 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on sql_injection
2025-07-21 11:35:29,486 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 11:35:29,520 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 11:35:29,546 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 11:35:29,551 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/logistic_regression.pkl
2025-07-21 11:35:29,551 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on sql_injection
2025-07-21 11:35:29,551 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 11:35:29,611 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 11:35:29,618 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   confusion_matrix  roc_auc
0       1.0        1.0     1.0  1.0  [[16, 0], [0, 4]]      1.0
2025-07-21 11:35:29,618 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/sql_injection/svm.pkl
2025-07-21 11:35:29,681 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/random_forest_confusion_matrix.png
2025-07-21 11:35:29,745 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/xgboost_confusion_matrix.png
2025-07-21 11:35:29,810 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/logistic_regression_confusion_matrix.png
2025-07-21 11:35:29,871 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/sql_injection/svm_confusion_matrix.png
2025-07-21 11:35:29,871 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
==================================================
2025-07-21 11:35:29,871 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Training models on path_traversal dataset
2025-07-21 11:35:29,871 - src.hybrid_threat_detection.models.supervised_trainer - INFO - ==================================================
2025-07-21 11:35:29,888 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training random_forest on path_traversal
2025-07-21 11:35:29,888 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for random_forest
2025-07-21 11:35:31,397 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for random_forest: {'class_weight': 'balanced', 'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 11:35:31,405 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 11:35:31,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved random_forest model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/random_forest.pkl
2025-07-21 11:35:31,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training xgboost on path_traversal
2025-07-21 11:35:31,406 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for xgboost
2025-07-21 11:35:34,758 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for xgboost: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 11:35:34,766 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.735294
2025-07-21 11:35:34,769 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved xgboost model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/xgboost.pkl
2025-07-21 11:35:34,770 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training logistic_regression on path_traversal
2025-07-21 11:35:34,770 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for logistic_regression
2025-07-21 11:35:34,816 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for logistic_regression: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 11:35:34,838 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision    recall    f1  confusion_matrix   roc_auc
0      0.55        1.0  0.470588  0.64  [[3, 0], [9, 8]]  0.735294
2025-07-21 11:35:34,843 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved logistic_regression model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/logistic_regression.pkl
2025-07-21 11:35:34,843 - src.hybrid_threat_detection.models.supervised_trainer - INFO - 
Training svm on path_traversal
2025-07-21 11:35:34,843 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Starting GridSearchCV for svm
2025-07-21 11:35:34,888 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Best parameters for svm: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 11:35:34,897 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   confusion_matrix   roc_auc
0      0.85       0.85     1.0  0.918919  [[0, 3], [0, 17]]  0.558824
2025-07-21 11:35:34,897 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved svm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/models/path_traversal/svm.pkl
2025-07-21 11:35:34,961 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/random_forest_confusion_matrix.png
2025-07-21 11:35:35,024 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/xgboost_confusion_matrix.png
2025-07-21 11:35:35,089 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/logistic_regression_confusion_matrix.png
2025-07-21 11:35:35,152 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/path_traversal/svm_confusion_matrix.png
2025-07-21 11:35:35,152 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/combined_results.json
2025-07-21 11:35:35,152 - src.hybrid_threat_detection.models.supervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/results/summary_report.json
2025-07-21 11:35:35,153 - __main__ - INFO - Model training completed successfully!
2025-07-21 11:35:35,153 - __main__ - INFO - 
Results for xss:
2025-07-21 11:35:35,153 - __main__ - INFO - 
random_forest:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'class_weight': 'balanced', 'max_depth': None, 'min_samples_split': 5, 'n_estimators': 100}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.33333333333333326}
2025-07-21 11:35:35,153 - __main__ - INFO - 
xgboost:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.2666666666666666}
2025-07-21 11:35:35,153 - __main__ - INFO - 
logistic_regression:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'C': 1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 0.21739130434782608, 'precision': 0.058823529411764705, 'recall': 0.3333333333333333, 'f1': 0.1, 'confusion_matrix': [[4, 16], [2, 1]], 'roc_auc': 0.33333333333333326}
2025-07-21 11:35:35,153 - __main__ - INFO - 
svm:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'C': 10, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'confusion_matrix': [[20, 0], [3, 0]], 'roc_auc': 0.7999999999999999}
2025-07-21 11:35:35,153 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 11:35:35,153 - __main__ - INFO - 
random_forest:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'class_weight': 'balanced', 'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 11:35:35,153 - __main__ - INFO - 
xgboost:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 11:35:35,153 - __main__ - INFO - 
logistic_regression:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 11:35:35,153 - __main__ - INFO - 
svm:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1': 1.0, 'confusion_matrix': [[16, 0], [0, 4]], 'roc_auc': 1.0}
2025-07-21 11:35:35,153 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 11:35:35,153 - __main__ - INFO - 
random_forest:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'class_weight': 'balanced', 'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 11:35:35,153 - __main__ - INFO - 
xgboost:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.7352941176470589}
2025-07-21 11:35:35,153 - __main__ - INFO - 
logistic_regression:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'C': 0.1, 'class_weight': 'balanced', 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 0.55, 'precision': 1.0, 'recall': 0.47058823529411764, 'f1': 0.64, 'confusion_matrix': [[3, 0], [9, 8]], 'roc_auc': 0.7352941176470589}
2025-07-21 11:35:35,153 - __main__ - INFO - 
svm:
2025-07-21 11:35:35,153 - __main__ - INFO - Best params: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear'}
2025-07-21 11:35:35,153 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'confusion_matrix': [[0, 3], [0, 17]], 'roc_auc': 0.5588235294117647}
2025-07-21 11:52:32,676 - __main__ - INFO - Starting deep learning model training pipeline
2025-07-21 11:52:32,676 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Loaded DL config from src/hybrid_threat_detection/config/dl_config.json
2025-07-21 11:52:32,676 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
==================================================
2025-07-21 11:52:32,677 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Training DL models on xss dataset
2025-07-21 11:52:32,677 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - ==================================================
2025-07-21 11:52:32,684 - src.hybrid_threat_detection.models.deep_learning_trainer - ERROR - Error loading data for xss: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase2/vectorizers/xss_sequences.npy'
2025-07-21 11:52:32,684 - src.hybrid_threat_detection.models.deep_learning_trainer - ERROR - Error processing dataset xss: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase2/vectorizers/xss_sequences.npy'
2025-07-21 11:52:32,684 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
==================================================
2025-07-21 11:52:32,684 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Training DL models on sql_injection dataset
2025-07-21 11:52:32,684 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - ==================================================
2025-07-21 11:52:32,692 - src.hybrid_threat_detection.models.deep_learning_trainer - ERROR - Error loading data for sql_injection: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase2/vectorizers/sql_injection_sequences.npy'
2025-07-21 11:52:32,692 - src.hybrid_threat_detection.models.deep_learning_trainer - ERROR - Error processing dataset sql_injection: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase2/vectorizers/sql_injection_sequences.npy'
2025-07-21 11:52:32,692 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
==================================================
2025-07-21 11:52:32,692 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Training DL models on path_traversal dataset
2025-07-21 11:52:32,693 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - ==================================================
2025-07-21 11:52:32,709 - src.hybrid_threat_detection.models.deep_learning_trainer - ERROR - Error loading data for path_traversal: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase2/vectorizers/path_traversal_sequences.npy'
2025-07-21 11:52:32,709 - src.hybrid_threat_detection.models.deep_learning_trainer - ERROR - Error processing dataset path_traversal: [Errno 2] No such file or directory: 'src/hybrid_threat_detection/results/phase2/vectorizers/path_traversal_sequences.npy'
2025-07-21 11:52:32,709 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/combined_results.json
2025-07-21 11:52:32,710 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/summary_report.json
2025-07-21 11:52:32,710 - __main__ - INFO - Deep learning model training completed successfully!
2025-07-21 11:58:01,745 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: xss
2025-07-21 11:58:01,746 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to xss
2025-07-21 11:58:01,748 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for xss. Shape: (100, 138)
2025-07-21 11:58:01,748 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to xss
2025-07-21 11:58:01,748 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for xss
2025-07-21 11:58:01,749 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for xss: 70
2025-07-21 11:58:01,749 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-21 11:58:01,749 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Saved padded sequences to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/vectorizers/xss_sequences.npy
2025-07-21 11:58:01,749 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-21 11:58:01,749 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-21 11:58:02,246 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-21 11:58:15,738 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-21T11:58:15.738205', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-21 11:58:15,825 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-21 11:58:15,832 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (70, 100)
2025-07-21 11:58:15,850 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: sql_injection
2025-07-21 11:58:15,851 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to sql_injection
2025-07-21 11:58:15,852 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for sql_injection. Shape: (100, 19)
2025-07-21 11:58:15,852 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to sql_injection
2025-07-21 11:58:15,852 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for sql_injection
2025-07-21 11:58:15,853 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for sql_injection: 21
2025-07-21 11:58:15,853 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-21 11:58:15,853 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Saved padded sequences to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/vectorizers/sql_injection_sequences.npy
2025-07-21 11:58:15,853 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-21 11:58:15,853 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-21 11:58:15,893 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-21 11:58:29,373 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-21T11:58:29.373097', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-21 11:58:29,459 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-21 11:58:29,466 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (21, 100)
2025-07-21 11:58:29,486 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vectorizing dataset: path_traversal
2025-07-21 11:58:29,487 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying TF-IDF to path_traversal
2025-07-21 11:58:29,488 - src.hybrid_threat_detection.features.text_vectorizer - INFO - TF-IDF completed for path_traversal. Shape: (100, 60)
2025-07-21 11:58:29,488 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Applying DL vectorization to path_traversal
2025-07-21 11:58:29,488 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Tokenizing texts for path_traversal
2025-07-21 11:58:29,489 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Vocab size for path_traversal: 33
2025-07-21 11:58:29,490 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Padded sequences to length 100. Shape: (100, 100)
2025-07-21 11:58:29,490 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Saved padded sequences to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase2/vectorizers/path_traversal_sequences.npy
2025-07-21 11:58:29,490 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loading glove embeddings with dim 100
2025-07-21 11:58:29,490 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Downloading glove-wiki-gigaword-100 embeddings...
2025-07-21 11:58:29,526 - gensim.models.keyedvectors - INFO - loading projection weights from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz
2025-07-21 11:58:43,083 - gensim.utils - INFO - KeyedVectors lifecycle event {'msg': 'loaded (400000, 100) matrix of type float32 from /home/jupyter5/gensim-data/glove-wiki-gigaword-100/glove-wiki-gigaword-100.gz', 'binary': False, 'encoding': 'utf8', 'datetime': '2025-07-21T11:58:43.083846', 'gensim': '4.3.3', 'python': '3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]', 'platform': 'Linux-6.8.0-60-generic-x86_64-with-glibc2.39', 'event': 'load_word2vec_format'}
2025-07-21 11:58:43,174 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Loaded 400000 word vectors from glove-wiki-gigaword-100
2025-07-21 11:58:43,181 - src.hybrid_threat_detection.features.text_vectorizer - INFO - Created embedding matrix with shape (33, 100)
2025-07-21 11:58:43,204 - __main__ - INFO - Vectorization completed successfully!
2025-07-21 11:58:43,204 - __main__ - INFO - XSS TF-IDF shape: (100, 138)
2025-07-21 11:58:43,204 - __main__ - INFO - XSS Padded Sequences shape: (100, 100)
2025-07-21 11:59:50,563 - __main__ - INFO - Starting deep learning model training pipeline
2025-07-21 11:59:50,563 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Loaded DL config from src/hybrid_threat_detection/config/dl_config.json
2025-07-21 11:59:50,563 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
==================================================
2025-07-21 11:59:50,563 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Training DL models on xss dataset
2025-07-21 11:59:50,563 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - ==================================================
2025-07-21 11:59:50,569 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
Training cnn on xss
2025-07-21 11:59:50,642 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ embedding (Embedding)                │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv1d (Conv1D)                      │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization                  │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling1d (MaxPooling1D)         │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv1d_1 (Conv1D)                    │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_1                │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling1d_1 (MaxPooling1D)       │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv1d_2 (Conv1D)                    │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_2                │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling1d_2 (MaxPooling1D)       │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ flatten (Flatten)                    │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense (Dense)                        │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_3                │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_1 (Dense)                      │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_4                │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_2 (Dense)                      │ ?                           │     0 (unbuilt) │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 0 (0.00 B)
 Trainable params: 0 (0.00 B)
 Non-trainable params: 0 (0.00 B)

2025-07-21 11:59:52,984 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:53,101 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:53,215 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:53,326 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:53,440 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:53,554 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:53,661 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:53,782 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:53,891 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:53,996 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:54,107 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:54,217 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:54,327 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:54,433 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:54,538 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:54,720 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1  roc_auc   confusion_matrix
0  0.869565        0.0     0.0  0.0    0.475  [[20, 0], [3, 0]]
2025-07-21 11:59:54,720 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:54,750 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved cnn model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_models/xss/cnn.h5
2025-07-21 11:59:54,750 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
Training lstm on xss
2025-07-21 11:59:54,762 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Model: "sequential_1"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ embedding_1 (Embedding)              │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_5                │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_6                │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_3 (Dense)                      │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_7                │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_4 (Dense)                      │ ?                           │     0 (unbuilt) │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 0 (0.00 B)
 Trainable params: 0 (0.00 B)
 Non-trainable params: 0 (0.00 B)

2025-07-21 11:59:58,754 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:58,995 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:59,251 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:59,500 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:59,748 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 11:59:59,997 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:00,244 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:00,493 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:00,743 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:00,985 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:01,231 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:01,478 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:01,726 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:01,970 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:02,217 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:02,466 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:02,712 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:02,966 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:03,214 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:03,470 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:03,717 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:03,973 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:04,222 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:04,468 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:04,724 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:04,979 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:05,226 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:05,482 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:05,726 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:05,980 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:06,234 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:06,484 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:06,731 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:06,987 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:07,228 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:07,471 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:07,715 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:07,961 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:08,204 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:08,448 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:08,696 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:08,947 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:09,186 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:09,431 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:09,808 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1  roc_auc   confusion_matrix
0  0.869565        0.0     0.0  0.0    0.525  [[20, 0], [3, 0]]
2025-07-21 12:00:09,808 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:09,826 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved lstm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_models/xss/lstm.h5
2025-07-21 12:00:09,983 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved training history to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/xss/cnn_training_history.png
2025-07-21 12:00:10,121 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved training history to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/xss/lstm_training_history.png
2025-07-21 12:00:10,208 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/xss/cnn_confusion_matrix.png
2025-07-21 12:00:10,273 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/xss/lstm_confusion_matrix.png
2025-07-21 12:00:10,273 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
==================================================
2025-07-21 12:00:10,273 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Training DL models on sql_injection dataset
2025-07-21 12:00:10,273 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - ==================================================
2025-07-21 12:00:10,283 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
Training cnn on sql_injection
2025-07-21 12:00:10,298 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Model: "sequential_2"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ embedding_2 (Embedding)              │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv1d_3 (Conv1D)                    │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_8                │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling1d_3 (MaxPooling1D)       │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv1d_4 (Conv1D)                    │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_9                │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling1d_4 (MaxPooling1D)       │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv1d_5 (Conv1D)                    │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_10               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling1d_5 (MaxPooling1D)       │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ flatten_1 (Flatten)                  │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_5 (Dense)                      │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_11               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_3 (Dropout)                  │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_6 (Dense)                      │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_12               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_4 (Dropout)                  │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_7 (Dense)                      │ ?                           │     0 (unbuilt) │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 0 (0.00 B)
 Trainable params: 0 (0.00 B)
 Non-trainable params: 0 (0.00 B)

2025-07-21 12:00:12,486 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:12,586 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:12,687 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:12,797 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:12,903 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,009 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,111 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,213 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,314 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,413 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,516 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,622 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,724 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,830 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:13,934 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,035 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,138 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,239 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,345 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,447 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,549 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,649 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,751 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,850 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:14,960 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:15,062 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:15,169 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:15,268 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:15,370 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:15,471 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:15,566 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:15,662 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:15,759 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:15,857 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:16,033 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   roc_auc   confusion_matrix
0       0.8        0.0     0.0  0.0  0.492188  [[16, 0], [4, 0]]
2025-07-21 12:00:16,033 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:16,065 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved cnn model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_models/sql_injection/cnn.h5
2025-07-21 12:00:16,065 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
Training lstm on sql_injection
2025-07-21 12:00:16,077 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Model: "sequential_3"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ embedding_3 (Embedding)              │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_13               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_14               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_8 (Dense)                      │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_15               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_5 (Dropout)                  │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_9 (Dense)                      │ ?                           │     0 (unbuilt) │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 0 (0.00 B)
 Trainable params: 0 (0.00 B)
 Non-trainable params: 0 (0.00 B)

2025-07-21 12:00:19,251 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:19,428 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:19,597 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:19,773 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:19,954 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:20,129 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:20,305 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:20,482 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:20,649 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:20,824 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:21,002 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:21,171 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:21,354 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:21,529 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:21,705 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:21,877 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:22,056 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:22,231 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:22,408 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:22,584 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:22,757 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:22,937 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:23,120 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:23,302 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:23,485 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:23,663 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:23,847 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:24,025 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:24,213 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:24,394 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:24,574 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:24,760 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:24,943 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:25,119 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:25,297 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:25,475 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:25,653 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:25,835 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:26,011 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:26,190 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:26,366 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:26,550 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:26,726 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:26,904 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:27,088 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:27,268 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:27,444 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:27,623 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:27,802 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:27,980 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:28,154 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:28,321 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:28,489 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:28,680 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:28,855 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:29,026 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:29,201 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:29,375 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:29,553 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:29,726 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:29,901 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:30,075 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:30,255 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:30,432 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:30,602 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:30,783 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:30,963 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:31,144 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:31,320 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:31,495 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:31,674 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:31,857 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:32,034 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:32,207 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:32,384 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:32,556 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:32,737 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:32,916 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:33,092 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:33,263 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:33,437 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:33,613 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:33,792 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:33,968 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:34,147 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:34,322 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:34,502 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:34,684 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:35,061 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall   f1   roc_auc   confusion_matrix
0       0.8        0.0     0.0  0.0  0.554688  [[16, 0], [4, 0]]
2025-07-21 12:00:35,062 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:35,086 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved lstm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_models/sql_injection/lstm.h5
2025-07-21 12:00:35,243 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved training history to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/sql_injection/cnn_training_history.png
2025-07-21 12:00:35,399 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved training history to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/sql_injection/lstm_training_history.png
2025-07-21 12:00:35,464 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/sql_injection/cnn_confusion_matrix.png
2025-07-21 12:00:35,529 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/sql_injection/lstm_confusion_matrix.png
2025-07-21 12:00:35,530 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
==================================================
2025-07-21 12:00:35,530 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Training DL models on path_traversal dataset
2025-07-21 12:00:35,530 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - ==================================================
2025-07-21 12:00:35,545 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
Training cnn on path_traversal
2025-07-21 12:00:35,566 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Model: "sequential_4"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ embedding_4 (Embedding)              │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv1d_6 (Conv1D)                    │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_16               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling1d_6 (MaxPooling1D)       │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv1d_7 (Conv1D)                    │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_17               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling1d_7 (MaxPooling1D)       │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv1d_8 (Conv1D)                    │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_18               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling1d_8 (MaxPooling1D)       │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ flatten_2 (Flatten)                  │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_10 (Dense)                     │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_19               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_6 (Dropout)                  │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_11 (Dense)                     │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_20               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_7 (Dropout)                  │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_12 (Dense)                     │ ?                           │     0 (unbuilt) │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 0 (0.00 B)
 Trainable params: 0 (0.00 B)
 Non-trainable params: 0 (0.00 B)

2025-07-21 12:00:37,835 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:37,933 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,038 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,136 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,237 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,339 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,442 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,545 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,647 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,746 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,846 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:38,944 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,051 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,155 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,257 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,358 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,456 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,558 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,657 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,755 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,856 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:39,957 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,058 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,158 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,257 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,355 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,452 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,551 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,650 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,748 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,847 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:40,945 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:41,045 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:41,145 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:41,244 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:41,339 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:41,439 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:41,597 - tensorflow - WARNING - 5 out of the last 5 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x7ddbad6bc900> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2025-07-21 12:00:41,617 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1   roc_auc   confusion_matrix
0      0.85       0.85     1.0  0.918919  0.676471  [[0, 3], [0, 17]]
2025-07-21 12:00:41,617 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:41,647 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved cnn model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_models/path_traversal/cnn.h5
2025-07-21 12:00:41,647 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - 
Training lstm on path_traversal
2025-07-21 12:00:41,659 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Model: "sequential_5"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ embedding_5 (Embedding)              │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_4 (LSTM)                        │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_21               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_5 (LSTM)                        │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_22               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_13 (Dense)                     │ ?                           │     0 (unbuilt) │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_23               │ ?                           │     0 (unbuilt) │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_8 (Dropout)                  │ ?                           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_14 (Dense)                     │ ?                           │     0 (unbuilt) │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 0 (0.00 B)
 Trainable params: 0 (0.00 B)
 Non-trainable params: 0 (0.00 B)

2025-07-21 12:00:44,822 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:45,007 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:45,193 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:45,365 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:45,542 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:45,720 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:45,902 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:46,114 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:46,300 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:46,481 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:46,662 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:46,836 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:47,010 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:47,188 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:47,370 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:47,543 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:47,715 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:47,890 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:48,070 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:48,250 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:48,434 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:48,780 - tensorflow - WARNING - 6 out of the last 6 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x7ddb2864d1c0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2025-07-21 12:00:48,799 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Evaluation metrics:
   accuracy  precision  recall        f1  roc_auc   confusion_matrix
0      0.85       0.85     1.0  0.918919      0.5  [[0, 3], [0, 17]]
2025-07-21 12:00:48,800 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:00:48,818 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved lstm model to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_models/path_traversal/lstm.h5
2025-07-21 12:00:48,972 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved training history to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/path_traversal/cnn_training_history.png
2025-07-21 12:00:49,129 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved training history to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/path_traversal/lstm_training_history.png
2025-07-21 12:00:49,193 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/path_traversal/cnn_confusion_matrix.png
2025-07-21 12:00:49,576 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved confusion matrix to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/path_traversal/lstm_confusion_matrix.png
2025-07-21 12:00:49,578 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/combined_results.json
2025-07-21 12:00:49,578 - src.hybrid_threat_detection.models.deep_learning_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/dl_results/summary_report.json
2025-07-21 12:00:49,578 - __main__ - INFO - Deep learning model training completed successfully!
2025-07-21 12:00:49,578 - __main__ - INFO - 
Results for xss:
2025-07-21 12:00:49,578 - __main__ - INFO - 
cnn:
2025-07-21 12:00:49,578 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'roc_auc': 0.475, 'confusion_matrix': [[20, 0], [3, 0]]}
2025-07-21 12:00:49,578 - __main__ - INFO - 
lstm:
2025-07-21 12:00:49,578 - __main__ - INFO - Metrics: {'accuracy': 0.8695652173913043, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'roc_auc': 0.525, 'confusion_matrix': [[20, 0], [3, 0]]}
2025-07-21 12:00:49,578 - __main__ - INFO - 
Results for sql_injection:
2025-07-21 12:00:49,578 - __main__ - INFO - 
cnn:
2025-07-21 12:00:49,578 - __main__ - INFO - Metrics: {'accuracy': 0.8, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'roc_auc': 0.4921875, 'confusion_matrix': [[16, 0], [4, 0]]}
2025-07-21 12:00:49,578 - __main__ - INFO - 
lstm:
2025-07-21 12:00:49,578 - __main__ - INFO - Metrics: {'accuracy': 0.8, 'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'roc_auc': 0.5546875, 'confusion_matrix': [[16, 0], [4, 0]]}
2025-07-21 12:00:49,578 - __main__ - INFO - 
Results for path_traversal:
2025-07-21 12:00:49,578 - __main__ - INFO - 
cnn:
2025-07-21 12:00:49,578 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'roc_auc': 0.6764705882352942, 'confusion_matrix': [[0, 3], [0, 17]]}
2025-07-21 12:00:49,579 - __main__ - INFO - 
lstm:
2025-07-21 12:00:49,579 - __main__ - INFO - Metrics: {'accuracy': 0.85, 'precision': 0.85, 'recall': 1.0, 'f1': 0.918918918918919, 'roc_auc': 0.5, 'confusion_matrix': [[0, 3], [0, 17]]}
2025-07-21 12:54:45,399 - __main__ - INFO - Starting unsupervised model training pipeline
2025-07-21 12:54:45,399 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - Loaded unsupervised config from src/hybrid_threat_detection/config/unsupervised_config.json
2025-07-21 12:54:45,399 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
==================================================
2025-07-21 12:54:45,399 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - Training unsupervised models on xss dataset
2025-07-21 12:54:45,399 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - ==================================================
2025-07-21 12:54:45,406 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
Training KMeans model
2025-07-21 12:54:45,485 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - KMeans metrics: {'adjusted_rand_score': 0.03180345021181034, 'homogeneity_score': 0.005745366995059024, 'silhouette_score': 0.8264628106570721, 'confusion_matrix': [[24, 74], [5, 10]]}
2025-07-21 12:54:45,485 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
Training DBSCAN model
2025-07-21 12:54:45,508 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - DBSCAN metrics: {'adjusted_rand_score': 0.02905707907765598, 'homogeneity_score': 0.029460640534350557, 'silhouette_score': 0.736979082759772, 'n_clusters': 2, 'noise_points': 24, 'confusion_matrix': [[0, 0, 0], [19, 5, 74], [5, 0, 10]]}
2025-07-21 12:54:45,510 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
Training Autoencoder model
2025-07-21 12:54:47,185 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,268 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,343 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,417 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,495 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,570 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,642 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,715 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,790 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,860 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:47,937 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,010 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,082 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,155 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,241 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,318 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,393 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,469 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,544 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,624 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,699 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,773 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,851 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,924 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:48,996 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,069 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,143 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,216 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,294 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,371 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,443 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,525 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,604 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,683 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,755 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,827 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,898 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:49,971 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,042 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,118 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,191 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,263 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,337 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,411 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,486 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,565 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,643 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,718 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,791 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,869 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:50,945 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,018 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,097 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,173 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,246 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,318 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,390 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,463 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,537 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,608 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,681 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,755 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,826 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,898 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:51,974 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,049 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,123 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,197 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,274 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,351 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,422 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,497 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,572 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,647 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,720 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,796 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,872 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:52,948 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:53,023 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:53,154 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:53,232 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:53,303 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:53,379 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:53,451 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:53,732 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:54,445 - src.hybrid_threat_detection.models.unsupervised_trainer - ERROR - Error processing dataset xss: name 'accuracy_score' is not defined
2025-07-21 12:54:54,445 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
==================================================
2025-07-21 12:54:54,445 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - Training unsupervised models on sql_injection dataset
2025-07-21 12:54:54,445 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - ==================================================
2025-07-21 12:54:54,453 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
Training KMeans model
2025-07-21 12:54:54,458 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - KMeans metrics: {'adjusted_rand_score': 1.0, 'homogeneity_score': 1.0, 'silhouette_score': 0.8199999999999997, 'confusion_matrix': [[0, 82], [18, 0]]}
2025-07-21 12:54:54,458 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
Training DBSCAN model
2025-07-21 12:54:54,459 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - DBSCAN metrics: {}
2025-07-21 12:54:54,459 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
Training Autoencoder model
2025-07-21 12:54:55,852 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:55,923 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:55,997 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,068 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,140 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,212 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,281 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,351 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,423 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,497 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,574 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,650 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,728 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:56,799 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,027 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,105 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,180 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,348 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,470 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,541 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,614 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,740 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,923 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:57,998 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:58,073 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:58,144 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:58,217 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:58,287 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:58,357 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:58,427 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:54:59,126 - src.hybrid_threat_detection.models.unsupervised_trainer - ERROR - Error processing dataset sql_injection: name 'accuracy_score' is not defined
2025-07-21 12:54:59,126 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
==================================================
2025-07-21 12:54:59,126 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - Training unsupervised models on path_traversal dataset
2025-07-21 12:54:59,126 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - ==================================================
2025-07-21 12:54:59,143 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
Training KMeans model
2025-07-21 12:54:59,148 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - KMeans metrics: {'adjusted_rand_score': 0.0044444444444444444, 'homogeneity_score': 0.1291546004267906, 'silhouette_score': 0.5728899757621376, 'confusion_matrix': [[1, 12], [44, 43]]}
2025-07-21 12:54:59,148 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
Training DBSCAN model
2025-07-21 12:54:59,149 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - DBSCAN metrics: {}
2025-07-21 12:54:59,149 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - 
Training Autoencoder model
2025-07-21 12:55:00,730 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:55:00,808 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:55:00,882 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:55:00,957 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:55:01,030 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:55:01,103 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:55:01,179 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-07-21 12:55:01,803 - tensorflow - WARNING - 5 out of the last 9 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x72c3046bbe20> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2025-07-21 12:55:01,849 - tensorflow - WARNING - 6 out of the last 12 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x72c3046bbe20> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2025-07-21 12:55:01,864 - src.hybrid_threat_detection.models.unsupervised_trainer - ERROR - Error processing dataset path_traversal: name 'accuracy_score' is not defined
2025-07-21 12:55:01,864 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - Saved combined results to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/unsupervised_results/combined_results.json
2025-07-21 12:55:01,864 - src.hybrid_threat_detection.models.unsupervised_trainer - INFO - Saved summary report to /home/jupyter5/notebooks/INTERN_PROJECT_KMUTNB/src/hybrid_threat_detection/results/phase3/unsupervised_results/summary_report.json
2025-07-21 12:55:01,864 - __main__ - INFO - Unsupervised model training completed successfully!
